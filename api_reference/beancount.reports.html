<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://xuhcc.github.io/beancount-docs/api_reference/beancount.reports.html" rel="canonical"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>beancount.reports - Beancount Documentation</title>
<link href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet">
<link href="../css/theme.css" rel="stylesheet">
<link href="../css/theme_extra.css" rel="stylesheet"/>
<link href="../css/custom.css" rel="stylesheet"/>
<script>
    // Current page data
    var mkdocs_page_name = "beancount.reports";
    var mkdocs_page_input_path = "api_reference/beancount.reports.md";
    var mkdocs_page_url = "/beancount-docs/api_reference/beancount.reports.html";
  </script>
<script defer="" src="../js/jquery-2.1.1.min.js"></script>
<script defer="" src="../js/modernizr-2.8.3.min.js"></script>
</link></link></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href=".."> Beancount Documentation</a>
</div>
<div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Index</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Outline</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Users</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../01_command_line_accounting_in_context.html">Command Line Accounting in Context</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../02_the_double_entry_counting_method.html">The Double Entry Counting Method</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../03_installing_beancount.html">Installing Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../04_running_beancount_and_generating_reports.html">Running Beancount and Generating Reports</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../05_getting_started_with_beancount.html">Getting Started with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../06_beancount_language_syntax.html">Beancount Language Syntax</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../07_beancount_options_reference.html">Beancount Options Reference</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../08_precision_tolerances.html">Precision Tolerances</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../09_beancount_query_language.html">Beancount Query Language</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../10_beancount_cheat_sheet.html">Beancount Cheat Sheet</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../11_how_inventories_work.html">How Inventories Work</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../12_exporting_your_portfolio.html">Exporting Your Portfolio</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../13_tutorial_example.html">Tutorial &amp; Example</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../14_beancount_history_and_credits.html">Beancount History and Credits</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../15_a_comparison_of_beancount_and_ledger_hledger.html">A Comparison of Beancount and Ledger Hledger</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../16_fetching_prices_in_beancount.html">Fetching Prices in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../17_importing_external_data.html">Importing External Data</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Cookbooks &amp; Examples</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../18_command_line_accounting_cookbook.html">Command Line Accounting Cookbook</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../19_trading_with_beancount.html">Trading with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../20_stock_vesting_in_beancount.html">Stock Vesting in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../21_sharing_expenses_with_beancount.html">Sharing Expenses with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../22_how_we_share_expenses.html">How We Share Expenses</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Developers</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../23_beancount_scripting_plugins.html">Beancount Scripting Plugins</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../24_beancount_design_doc.html">Beancount Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../25_ledgerhub_design_doc.html">Ledgerhub Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../26_external_contributions.html">External Contributions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Enhancement Proposals &amp; Discussions</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../27_a_proposal_for_an_improvement_on_inventory_booking.html">A Proposal for an Improvement on Inventory Booking</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../28_settlement_dates_in_beancount.html">Settlement Dates in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../29_balance_assertions_in_beancount.html">Balance Assertions in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../30_fund_accounting_with_beancount.html">Fund Accounting with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../31_rounding_precision_in_beancount.html">Rounding Precision in Beancount</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">beancount</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.core.html">beancount.core</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ingest.html">beancount.ingest</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ops.html">beancount.ops</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.parser.html">beancount.parser</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.plugins.html">beancount.plugins</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.query.html">beancount.query</a>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="beancount.reports.html">beancount.reports</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports">beancount.reports</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.balance_reports">balance_reports</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.balance_reports.BalanceSheetReport">BalanceSheetReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.balance_reports.BalanceSheetReport.render_real_html">render_real_html()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.balance_reports.BalancesReport">BalancesReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.balance_reports.BalancesReport.add_args">add_args()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.balance_reports.BalancesReport.render_real_html">render_real_html()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.balance_reports.IncomeStatementReport">IncomeStatementReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.balance_reports.IncomeStatementReport.render_real_html">render_real_html()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.base">base</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base.HTMLReport">HTMLReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base.RealizationMeta">RealizationMeta</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base.RealizationMeta.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base.RealizationMeta.render_real_html">render_real_html()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base.Report">Report</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base.Report.__call__">__call__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base.Report.add_args">add_args()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base.Report.from_args">from_args()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base.Report.get_supported_formats">get_supported_formats()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base.Report.render">render()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base.ReportError">ReportError</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base.TableReport">TableReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base.TableReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base.get_html_template">get_html_template()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.base_test">base_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base_test.ExampleReport">ExampleReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base_test.ExampleReport.add_args">add_args()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base_test.ExampleTableReport">ExampleTableReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base_test.ExampleTableReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base_test.TestReport">TestReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base_test.TestReport.ReportClass">ReportClass</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base_test.TestReport.setUp">setUp()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base_test.TestTableReport">TestTableReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base_test.TestTableReport.ReportClass">ReportClass</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.base_test.TestTableReport.setUp">setUp()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.base_test.iter_reports">iter_reports()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.context">context</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.context.render_entry_context">render_entry_context()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.context.render_file_context">render_file_context()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.convert_reports">convert_reports</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports.HLedgerPrinter">HLedgerPrinter</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports.HLedgerReport">HLedgerReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports.LedgerPrinter">LedgerPrinter</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports.LedgerReport">LedgerReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports.postings_by_type">postings_by_type()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports.quote">quote()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports.quote_currency">quote_currency()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports.split_currency_conversions">split_currency_conversions()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.convert_reports_test">convert_reports_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports_test.TestLedgerConversion">TestLedgerConversion</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.convert_reports_test.TestLedgerConversion.check_parses_ledger">check_parses_ledger()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports_test.TestLedgerUtilityFunctionsOnPostings">TestLedgerUtilityFunctionsOnPostings</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.convert_reports_test.TestLedgerUtilityFunctionsOnPostings.setUp">setUp()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.convert_reports_test.get_ledger_version">get_ledger_version()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.export_reports">export_reports</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.export_reports.ExportEntry">ExportEntry</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.export_reports.ExportEntry.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.export_reports.ExportEntry.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.export_reports.ExportEntry.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.export_reports.ExportPortfolioReport">ExportPortfolioReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.export_reports.ExportPortfolioReport.add_args">add_args()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.export_reports.classify_holdings_for_export">classify_holdings_for_export()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.export_reports.export_holdings">export_holdings()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.export_reports.get_money_instruments">get_money_instruments()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.export_reports.get_symbol">get_symbol()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.export_reports.is_mutual_fund">is_mutual_fund()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.export_reports.render_ofx_date">render_ofx_date()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.export_reports_test">export_reports_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.export_reports_test.TestHoldingsReports">TestHoldingsReports</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.export_reports_test.TestHoldingsReports.setUp">setUp()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.gviz">gviz</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.gviz.gviz_timeline">gviz_timeline()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.holdings_reports">holdings_reports</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.holdings_reports.CashReport">CashReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.holdings_reports.CashReport.add_args">add_args()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.holdings_reports.CashReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.holdings_reports.HoldingsReport">HoldingsReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.holdings_reports.HoldingsReport.add_args">add_args()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.holdings_reports.HoldingsReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.holdings_reports.NetWorthReport">NetWorthReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.holdings_reports.NetWorthReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.holdings_reports.get_assets_holdings">get_assets_holdings()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.holdings_reports.get_holdings_entries">get_holdings_entries()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.holdings_reports.load_from_csv">load_from_csv()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.holdings_reports.report_holdings">report_holdings()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.holdings_reports_test">holdings_reports_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.holdings_reports_test.TestHoldingsReports">TestHoldingsReports</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.holdings_reports_test.TestHoldingsReports.setUp">setUp()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.html_formatter">html_formatter</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter">HTMLFormatter</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_account">render_account()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_amount">render_amount()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_commodity">render_commodity()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_context">render_context()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_doc">render_doc()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_event_type">render_event_type()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_inventory">render_inventory()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_link">render_link()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_number">render_number()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.html_formatter.HTMLFormatter.render_source">render_source()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.journal_html">journal_html</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_html.Row">Row</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_html.Row.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_html.Row.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_html.Row.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_html.html_entries_table">html_entries_table()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_html.html_entries_table_with_balance">html_entries_table_with_balance()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_html.iterate_html_postings">iterate_html_postings()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_html.render_links">render_links()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.journal_html_test">journal_html_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_html_test.TestJournalRender">TestJournalRender</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_html_test.TestJournalRender.setUp">setUp()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.journal_reports">journal_reports</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_reports.ConversionsReport">ConversionsReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_reports.DocumentsReport">DocumentsReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_reports.JournalReport">JournalReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_reports.JournalReport.add_args">add_args()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_reports.JournalReport.get_postings">get_postings()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_reports.JournalReport.render_real_html">render_real_html()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.journal_text">journal_text</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_text.AmountColumnSizer">AmountColumnSizer</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_text.AmountColumnSizer.get_format">get_format()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_text.AmountColumnSizer.get_generic_format">get_generic_format()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_text.AmountColumnSizer.get_number_width">get_number_width()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_text.AmountColumnSizer.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_text.get_entry_text_description">get_entry_text_description()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_text.render_posting">render_posting()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_text.size_and_render_amounts">size_and_render_amounts()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_text.text_entries_table">text_entries_table()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.journal_text_test">journal_text_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.journal_text_test.TestJournalTextRender">TestJournalTextRender</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.journal_text_test.TestJournalTextRender.setUp">setUp()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.misc_reports">misc_reports</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.misc_reports.AccountsReport">AccountsReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.misc_reports.ActivityReport">ActivityReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.misc_reports.ActivityReport.add_args">add_args()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.misc_reports.ActivityReport.render_real_html">render_real_html()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.misc_reports.CurrentEventsReport">CurrentEventsReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.misc_reports.CurrentEventsReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.misc_reports.ErrorReport">ErrorReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.misc_reports.EventsReport">EventsReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.misc_reports.EventsReport.add_args">add_args()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.misc_reports.EventsReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.misc_reports.NoopReport">NoopReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.misc_reports.PrintReport">PrintReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.misc_reports.StatsDirectivesReport">StatsDirectivesReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.misc_reports.StatsDirectivesReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.misc_reports.StatsPostingsReport">StatsPostingsReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.misc_reports.StatsPostingsReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.price_reports">price_reports</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.price_reports.CommoditiesReport">CommoditiesReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.price_reports.CommoditiesReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.price_reports.CommodityLifetimes">CommodityLifetimes</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.price_reports.CommodityLifetimes.add_args">add_args()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.price_reports.CommodityPricesReport">CommodityPricesReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.price_reports.CommodityPricesReport.add_args">add_args()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.price_reports.CommodityPricesReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.price_reports.PriceDBReport">PriceDBReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.price_reports.PricesReport">PricesReport</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.price_reports.TickerReport">TickerReport</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.price_reports.TickerReport.generate_table">generate_table()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.report">report</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.report.ListFormatsAction">ListFormatsAction</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.report.ListReportsAction">ListReportsAction</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.report.get_all_reports">get_all_reports()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.report.get_list_report_string">get_list_report_string()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.table">table</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.table.Table">Table</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.table.Table.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.table.Table.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.table.Table.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.table.attribute_to_title">attribute_to_title()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.table.compute_table_widths">compute_table_widths()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.table.create_table">create_table()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.table.render_table">render_table()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.table.table_to_csv">table_to_csv()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.table.table_to_html">table_to_html()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.table.table_to_text">table_to_text()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.tree_table">tree_table</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.tree_table.is_account_active">is_account_active()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.tree_table.table_of_balances">table_of_balances()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.tree_table.tree_table">tree_table()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.reports.tree_table_test">tree_table_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.reports.tree_table_test.TestTables">TestTables</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.reports.tree_table_test.TestTables.setUp">setUp()</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.scripts.html">beancount.scripts</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.utils.html">beancount.utils</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="top navigation" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="..">Beancount Documentation</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a href="..">Docs</a> »</li>
<li>API reference »</li>
<li>beancount.reports</li>
<li class="wy-breadcrumbs-aside">
<a class="icon icon-github" href="https://github.com/xuhcc/beancount-docs/edit/master/docs/api_reference/beancount.reports.md"> Edit on GitHub</a>
</li>
</ul>
<hr/>
</div>
<div role="main">
<div class="section">
<h1 id="beancountreports">beancount.reports<a class="headerlink" href="#beancountreports" title="Permanent link"></a></h1>
<div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#beancount.reports" id="beancount.reports" style="visibility: hidden; width: 0; height: 0;">
<a class="headerlink" href="#beancount.reports" title="Permanent link"></a></h2>
<div class="doc doc-contents first">
<p>Routines to produce various reports, either to HTML or to text.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.balance_reports">
<code>balance_reports</code>
<a class="headerlink" href="#beancount.reports.balance_reports" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Report classes for all reports that display ending balances of accounts.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.balance_reports.BalanceSheetReport">
<code>BalanceSheetReport</code>
<a class="headerlink" href="#beancount.reports.balance_reports.BalanceSheetReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out a balance sheet.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.balance_reports.BalanceSheetReport.render_real_html">
<code class="highlight language-python">
render_real_html<span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.balance_reports.BalanceSheetReport.render_real_html" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Wrap an htmldiv into our standard HTML template.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price database.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_date</code></td>
<td><code></code></td>
<td>
<p>A date for evaluating prices.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict, options as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>A file object to write the output to.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/balance_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>237
238
239
240
241
242
243
244
245
246
247
248
249
250
251</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_real_html</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">"""Wrap an htmldiv into our standard HTML template.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_root: An instance of RealAccount.</span>
<span class="sd">      price_map: A price database.</span>
<span class="sd">      price_date: A date for evaluating prices.</span>
<span class="sd">      options_map: A dict, options as produced by the parser.</span>
<span class="sd">      file: A file object to write the output to.</span>
<span class="sd">    """</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">get_html_template</span><span class="p">()</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">render_real_htmldiv</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">oss</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span>
                               <span class="n">title</span><span class="o">=</span><span class="s1">''</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.balance_reports.BalancesReport">
<code>BalancesReport</code>
<a class="headerlink" href="#beancount.reports.balance_reports.BalancesReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out the trial balance of accounts matching an expression.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.balance_reports.BalancesReport.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.balance_reports.BalancesReport.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/balance_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>27
28
29
30
31
32
33
34</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-e'</span><span class="p">,</span> <span class="s1">'--filter-expression'</span><span class="p">,</span> <span class="s1">'--expression'</span><span class="p">,</span> <span class="s1">'--regexp'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Filter expression for which account balances to display."</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-c'</span><span class="p">,</span> <span class="s1">'--at-cost'</span><span class="p">,</span> <span class="s1">'--cost'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Render values at cost, convert the units to cost value"</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.balance_reports.BalancesReport.render_real_html">
<code class="highlight language-python">
render_real_html<span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.balance_reports.BalancesReport.render_real_html" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Wrap an htmldiv into our standard HTML template.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price database.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_date</code></td>
<td><code></code></td>
<td>
<p>A date for evaluating prices.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict, options as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>A file object to write the output to.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/balance_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>237
238
239
240
241
242
243
244
245
246
247
248
249
250
251</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_real_html</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">"""Wrap an htmldiv into our standard HTML template.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_root: An instance of RealAccount.</span>
<span class="sd">      price_map: A price database.</span>
<span class="sd">      price_date: A date for evaluating prices.</span>
<span class="sd">      options_map: A dict, options as produced by the parser.</span>
<span class="sd">      file: A file object to write the output to.</span>
<span class="sd">    """</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">get_html_template</span><span class="p">()</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">render_real_htmldiv</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">oss</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span>
                               <span class="n">title</span><span class="o">=</span><span class="s1">''</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.balance_reports.IncomeStatementReport">
<code>IncomeStatementReport</code>
<a class="headerlink" href="#beancount.reports.balance_reports.IncomeStatementReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out an income statement.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.balance_reports.IncomeStatementReport.render_real_html">
<code class="highlight language-python">
render_real_html<span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.balance_reports.IncomeStatementReport.render_real_html" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Wrap an htmldiv into our standard HTML template.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price database.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_date</code></td>
<td><code></code></td>
<td>
<p>A date for evaluating prices.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict, options as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>A file object to write the output to.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/balance_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>237
238
239
240
241
242
243
244
245
246
247
248
249
250
251</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_real_html</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">"""Wrap an htmldiv into our standard HTML template.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_root: An instance of RealAccount.</span>
<span class="sd">      price_map: A price database.</span>
<span class="sd">      price_date: A date for evaluating prices.</span>
<span class="sd">      options_map: A dict, options as produced by the parser.</span>
<span class="sd">      file: A file object to write the output to.</span>
<span class="sd">    """</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">get_html_template</span><span class="p">()</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">render_real_htmldiv</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">oss</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span>
                               <span class="n">title</span><span class="o">=</span><span class="s1">''</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.base">
<code>base</code>
<a class="headerlink" href="#beancount.reports.base" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Base class for all reports classes.</p>
<p>Each report class should be able to render a filtered list of entries to a
variety of formats. Each report has a name, some command-line options, and
supports some subset of formats.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.base.HTMLReport">
<code>HTMLReport</code>
<a class="headerlink" href="#beancount.reports.base.HTMLReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A mixin for reports that support forwarding html to htmldiv implementation.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.base.RealizationMeta">
<code>RealizationMeta</code>
<a class="headerlink" href="#beancount.reports.base.RealizationMeta" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A metaclass for reports that render a realization.</p>
<pre><code>The main use of this metaclass is to allow us to create report classes with
render_real_*() methods that accept a RealAccount instance as the basis for
producing a report.

RealAccount can be expensive to build, and may be pre-computed and kept
around to generate the various reports related to a particular filter of a
subset of transactions, and it would be inconvenient to have to recalculate
it every time we need to produce a report. In particular, this is the case
for the web interface: the user selects a particular subset of transactions
to view, and can then click to the various reports related to this subset of
transactions. This is why this is useful.

The classes generated with this metaclass respond to the same interface as
the regular report classes, so that if invoked from the command-line, it
will automatically build the realization from the given set of entries. This
metaclass looks at the class' existing render_real_*() methods and generate
the corresponding render_*() methods automatically.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base.RealizationMeta.__new__">
<code class="highlight language-python">
__new__<span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.base.RealizationMeta.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create and return a new object.  See help(type) for accurate signature.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/base.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">):</span>
    <span class="n">new_type</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">RealizationMeta</span><span class="p">,</span> <span class="n">mcs</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>

    <span class="c1"># Go through the methods of the new type and look for render_real() methods.</span>
    <span class="n">new_methods</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_type</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'render_real_(.*)'</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Make sure that if an explicit version of render_*() has already</span>
        <span class="c1"># been declared, that we don't override it.</span>
        <span class="n">render_function_name</span> <span class="o">=</span> <span class="s1">'render_</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">render_function_name</span> <span class="ow">in</span> <span class="n">new_type</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Define a render_*() method on the class.</span>
        <span class="k">def</span> <span class="nf">forward_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">fwdfunc</span><span class="o">=</span><span class="n">value</span><span class="p">):</span>
            <span class="n">account_types</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get_account_types</span><span class="p">(</span><span class="n">options_map</span><span class="p">)</span>
            <span class="n">real_root</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">realize</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">account_types</span><span class="p">)</span>
            <span class="n">price_map</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">build_price_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
            <span class="c1"># Note: When we forward, use the latest date (None).</span>
            <span class="k">return</span> <span class="n">fwdfunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="n">forward_method</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">render_function_name</span>
        <span class="n">new_methods</span><span class="p">[</span><span class="n">render_function_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">forward_method</span>

    <span class="c1"># Update the type with the newly defined methods..</span>
    <span class="k">for</span> <span class="n">mname</span><span class="p">,</span> <span class="n">mvalue</span> <span class="ow">in</span> <span class="n">new_methods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">new_type</span><span class="p">,</span> <span class="n">mname</span><span class="p">,</span> <span class="n">mvalue</span><span class="p">)</span>

    <span class="c1"># Auto-generate other methods if necessary.</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">new_type</span><span class="p">,</span> <span class="s1">'render_real_htmldiv'</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">new_type</span><span class="p">,</span> <span class="s1">'render_real_html'</span><span class="p">,</span> <span class="n">mcs</span><span class="o">.</span><span class="n">render_real_html</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_type</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base.RealizationMeta.render_real_html">
<code class="highlight language-python">
render_real_html<span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.base.RealizationMeta.render_real_html" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Wrap an htmldiv into our standard HTML template.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price database.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_date</code></td>
<td><code></code></td>
<td>
<p>A date for evaluating prices.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict, options as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>A file object to write the output to.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>237
238
239
240
241
242
243
244
245
246
247
248
249
250
251</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_real_html</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">"""Wrap an htmldiv into our standard HTML template.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_root: An instance of RealAccount.</span>
<span class="sd">      price_map: A price database.</span>
<span class="sd">      price_date: A date for evaluating prices.</span>
<span class="sd">      options_map: A dict, options as produced by the parser.</span>
<span class="sd">      file: A file object to write the output to.</span>
<span class="sd">    """</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">get_html_template</span><span class="p">()</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">render_real_htmldiv</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">oss</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span>
                               <span class="n">title</span><span class="o">=</span><span class="s1">''</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.base.Report">
<code>Report</code>
<a class="headerlink" href="#beancount.reports.base.Report" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Base class for all reports.</p>
<pre><code>Attributes:
  names: A list of strings, the various names of this report. The first name
    is taken to be the authoritative name of the report; the rest are
    considered aliases.
  parser: The parser for the command's arguments. This is used to raise errors.
  args: An object that contains the values of this command's parsed arguments.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base.Report.__call__">
<code class="highlight language-python">
__call__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.reports.base.Report.__call__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render a report of filtered entries to any format.</p>
<p>This function dispatches to a specific method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>output_format</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the format. I fnot specified, use
the default format.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>The file to write the output to.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>If no 'file' is provided, return the contents of the report as a
string.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ReportError</code></td>
<td>
<p>If the requested format is not supported.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Render a report of filtered entries to any format.</span>

<span class="sd">    This function dispatches to a specific method.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives to render.</span>
<span class="sd">      errors: A list of errors that occurred during processing.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      output_format: A string, the name of the format. I fnot specified, use</span>
<span class="sd">        the default format.</span>
<span class="sd">      file: The file to write the output to.</span>
<span class="sd">    Returns:</span>
<span class="sd">      If no 'file' is provided, return the contents of the report as a</span>
<span class="sd">      string.</span>
<span class="sd">    Raises:</span>
<span class="sd">      ReportError: If the requested format is not supported.</span>
<span class="sd">    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">render_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">'render_</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_format</span> <span class="ow">or</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">default_format</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ReportError</span><span class="p">(</span><span class="s2">"Unsupported format: '</span><span class="si">{}</span><span class="s2">'"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_format</span><span class="p">))</span>

    <span class="n">outfile</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">file</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">render_method</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"Render method must write to file."</span>
    <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">outfile</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base.Report.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.base.Report.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>67
68
69
70
71
72
73</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="sd">"""Add arguments to parse for this report.</span>

<span class="sd">    Args:</span>
<span class="sd">      parser: An instance of argparse.ArgumentParser.</span>
<span class="sd">    """</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base.Report.from_args">
<code class="highlight language-python">
from_args<span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.base.Report.from_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>A convenience method used to create an instance from arguments.</p>
<p>This creates an instance of the report with default arguments. This is a
convenience that may be used for tests. Our actual script uses subparsers
and invokes add_args() and creates an appropriate instance directly.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>argv</code></td>
<td><code></code></td>
<td>
<p>A list of strings, command-line arguments to use to construct tbe report.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>kwds</code></td>
<td><code></code></td>
<td>
<p>A dict of other keyword arguments to pass to the report's constructor.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instace of the report.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">argv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
    <span class="sd">"""A convenience method used to create an instance from arguments.</span>

<span class="sd">    This creates an instance of the report with default arguments. This is a</span>
<span class="sd">    convenience that may be used for tests. Our actual script uses subparsers</span>
<span class="sd">    and invokes add_args() and creates an appropriate instance directly.</span>

<span class="sd">    Args:</span>
<span class="sd">      argv: A list of strings, command-line arguments to use to construct tbe report.</span>
<span class="sd">      kwds: A dict of other keyword arguments to pass to the report's constructor.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instace of the report.</span>
<span class="sd">    """</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">add_args</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">argv</span> <span class="ow">or</span> <span class="p">[]),</span> <span class="n">parser</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base.Report.get_supported_formats">
<code class="highlight language-python">
get_supported_formats<span class="p">()</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.base.Report.get_supported_formats" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Enumerates the list of supported formats, by inspecting methods of this object.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of strings, such as ['html', 'text'].</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>76
77
78
79
80
81
82
83
84
85
86
87
88</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_supported_formats</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">"""Enumerates the list of supported formats, by inspecting methods of this object.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A list of strings, such as ['html', 'text'].</span>
<span class="sd">    """</span>
    <span class="n">formats</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'render_([a-z0-9]+)$'</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">formats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">formats</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base.Report.render">
<code class="highlight language-python">
render<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.base.Report.render" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render a report of filtered entries to any format.</p>
<p>This function dispatches to a specific method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>output_format</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the format. I fnot specified, use
the default format.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>The file to write the output to.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>If no 'file' is provided, return the contents of the report as a
string.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ReportError</code></td>
<td>
<p>If the requested format is not supported.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Render a report of filtered entries to any format.</span>

<span class="sd">    This function dispatches to a specific method.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives to render.</span>
<span class="sd">      errors: A list of errors that occurred during processing.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      output_format: A string, the name of the format. I fnot specified, use</span>
<span class="sd">        the default format.</span>
<span class="sd">      file: The file to write the output to.</span>
<span class="sd">    Returns:</span>
<span class="sd">      If no 'file' is provided, return the contents of the report as a</span>
<span class="sd">      string.</span>
<span class="sd">    Raises:</span>
<span class="sd">      ReportError: If the requested format is not supported.</span>
<span class="sd">    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">render_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">'render_</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_format</span> <span class="ow">or</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">default_format</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ReportError</span><span class="p">(</span><span class="s2">"Unsupported format: '</span><span class="si">{}</span><span class="s2">'"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_format</span><span class="p">))</span>

    <span class="n">outfile</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">file</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">render_method</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"Render method must write to file."</span>
    <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">outfile</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.base.ReportError">
<code>ReportError</code>
<a class="headerlink" href="#beancount.reports.base.ReportError" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Error that occurred during report generation.</p>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.base.TableReport">
<code>TableReport</code>
<a class="headerlink" href="#beancount.reports.base.TableReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A base class for reports that supports automatic conversions from Table.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base.TableReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.base.TableReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>151
152
153
154
155
156
157
158
159
160
161</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="sd">"""Render the report to a Table instance.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives to render.</span>
<span class="sd">      errors: A list of errors that occurred during processing.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Table, that will get converted to another format.</span>
<span class="sd">    """</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.base.get_html_template">
<code class="highlight language-python">
get_html_template<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.reports.base.get_html_template" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Returns our vanilla HTML template for embedding an HTML div.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A string, with a formatting style placeholders</code></td>
<td>
<p>{title}: for the title of the page.
  {body}: for the body, where the div goes.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>254
255
256
257
258
259
260
261
262</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_html_template</span><span class="p">():</span>
    <span class="sd">"""Returns our vanilla HTML template for embedding an HTML div.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A string, with a formatting style placeholders:</span>
<span class="sd">        {title}: for the title of the page.</span>
<span class="sd">        {body}: for the body, where the div goes.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">'template.html'</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.base_test">
<code>base_test</code>
<a class="headerlink" href="#beancount.reports.base_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.base_test.ExampleReport">
<code>ExampleReport</code>
<a class="headerlink" href="#beancount.reports.base_test.ExampleReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base_test.ExampleReport.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.base_test.ExampleReport.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>40
41
42</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'--currency'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">'CAD'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">"Currency."</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.base_test.ExampleTableReport">
<code>ExampleTableReport</code>
<a class="headerlink" href="#beancount.reports.base_test.ExampleTableReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base_test.ExampleTableReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.base_test.ExampleTableReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 99
100
101
102</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">ABC</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s1">'ABC'</span><span class="p">,</span> <span class="s1">'account balance'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">([</span><span class="n">ABC</span><span class="p">(</span><span class="s1">'account1'</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">2000</span><span class="p">)),</span>
                               <span class="n">ABC</span><span class="p">(</span><span class="s1">'account2'</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">5000</span><span class="p">))])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.base_test.TestReport">
<code>TestReport</code>
<a class="headerlink" href="#beancount.reports.base_test.TestReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="beancount.reports.base_test.TestReport.ReportClass">
<code>ReportClass</code>
<a class="headerlink" href="#beancount.reports.base_test.TestReport.ReportClass" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="beancount.reports.base_test.TestReport.ReportClass.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.base_test.TestReport.ReportClass.add_args" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>40
41
42</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'--currency'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">'CAD'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">"Currency."</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base_test.TestReport.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.base_test.TestReport.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/base_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>55
56
57
58
59
60
61
62</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@loader</span><span class="o">.</span><span class="n">load_doc</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    2014-07-27 open Assets:Example</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">options_map</span> <span class="o">=</span> <span class="n">options_map</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.base_test.TestTableReport">
<code>TestTableReport</code>
<a class="headerlink" href="#beancount.reports.base_test.TestTableReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="beancount.reports.base_test.TestTableReport.ReportClass">
<code>ReportClass</code>
<a class="headerlink" href="#beancount.reports.base_test.TestTableReport.ReportClass" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="beancount.reports.base_test.TestTableReport.ReportClass.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.base_test.TestTableReport.ReportClass.generate_table" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/base_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 99
100
101
102</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">ABC</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s1">'ABC'</span><span class="p">,</span> <span class="s1">'account balance'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">([</span><span class="n">ABC</span><span class="p">(</span><span class="s1">'account1'</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">2000</span><span class="p">)),</span>
                               <span class="n">ABC</span><span class="p">(</span><span class="s1">'account2'</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="mi">5000</span><span class="p">))])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.base_test.TestTableReport.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.base_test.TestTableReport.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/base_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>108
109
110
111
112
113
114
115
116</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@loader</span><span class="o">.</span><span class="n">load_doc</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    2014-07-27 open Assets:Example</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">options_map</span> <span class="o">=</span> <span class="n">options_map</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReportClass</span><span class="o">.</span><span class="n">from_args</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.base_test.iter_reports">
<code class="highlight language-python">
iter_reports<span class="p">(</span><span class="n">report_classes</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.base_test.iter_reports" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Iterate over and instantiate all report classes.</p>
<p>Yields:
  Pairs of (report instance, supported output format).</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/base_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">iter_reports</span><span class="p">(</span><span class="n">report_classes</span><span class="p">):</span>
    <span class="sd">"""Iterate over and instantiate all report classes.</span>

<span class="sd">    Args:</span>
<span class="sd">      A list of subclasses of base.Base.</span>
<span class="sd">    Yields:</span>
<span class="sd">      Pairs of (report instance, supported output format).</span>
<span class="sd">    """</span>
    <span class="k">for</span> <span class="n">report_class</span> <span class="ow">in</span> <span class="n">report_classes</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">report_class</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">Report</span><span class="p">),</span> <span class="n">report_class</span>
        <span class="n">argv</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">report_class</span><span class="p">,</span> <span class="s1">'test_args'</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">report_</span> <span class="o">=</span> <span class="n">report_class</span><span class="o">.</span><span class="n">from_args</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">format_</span> <span class="ow">in</span> <span class="n">report_class</span><span class="o">.</span><span class="n">get_supported_formats</span><span class="p">():</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">report_</span><span class="p">,</span> <span class="n">format_</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.context">
<code>context</code>
<a class="headerlink" href="#beancount.reports.context" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Produce a rendering of the account balances just before and after a
particular entry is applied.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.context.render_entry_context">
<code class="highlight language-python">
render_entry_context<span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.context.render_entry_context" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the context before and after a particular transaction is applied.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>The entry instance which should be rendered. (Note that this object is
expected to be in the set of entries, not just structurally equal.)</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A multiline string of text, which consists of the context before the
transaction is applied, the transaction itself, and the context after it
is applied. You can just print that, it is in form that is intended to be
consumed by the user.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/context.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_entry_context</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
    <span class="sd">"""Render the context before and after a particular transaction is applied.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      entry: The entry instance which should be rendered. (Note that this object is</span>
<span class="sd">        expected to be in the set of entries, not just structurally equal.)</span>
<span class="sd">    Returns:</span>
<span class="sd">      A multiline string of text, which consists of the context before the</span>
<span class="sd">      transaction is applied, the transaction itself, and the context after it</span>
<span class="sd">      is applied. You can just print that, it is in form that is intended to be</span>
<span class="sd">      consumed by the user.</span>
<span class="sd">    """</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>

    <span class="n">meta</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Hash:</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compare</span><span class="o">.</span><span class="n">hash_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)),</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Location: </span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">meta</span><span class="p">[</span><span class="s2">"filename"</span><span class="p">],</span> <span class="n">meta</span><span class="p">[</span><span class="s2">"lineno"</span><span class="p">]),</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

    <span class="c1"># Get the list of accounts sorted by the order in which they appear in the</span>
    <span class="c1"># closest entry.</span>
    <span class="n">order</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">):</span>
        <span class="n">order</span> <span class="o">=</span> <span class="p">{</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">:</span> <span class="n">index</span>
                 <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">)}</span>
    <span class="n">accounts</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">getters</span><span class="o">.</span><span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">),</span>
                      <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">account</span><span class="p">:</span> <span class="n">order</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="mi">10000</span><span class="p">))</span>

    <span class="c1"># Accumulate the balances of these accounts up to the entry.</span>
    <span class="n">balance_before</span><span class="p">,</span> <span class="n">balance_after</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">compute_entry_context</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span>
                                                                      <span class="n">entry</span><span class="p">)</span>

    <span class="c1"># Create a format line for printing the contents of account balances.</span>
    <span class="n">max_account_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">accounts</span><span class="p">))</span> <span class="k">if</span> <span class="n">accounts</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="n">position_line</span> <span class="o">=</span> <span class="s1">'{{:1}} {{:</span><span class="si">{width}</span><span class="s1">}}  {{:&gt;49}}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">max_account_width</span><span class="p">)</span>

    <span class="c1"># Print the context before.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"------------ Balances before transaction"</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="n">before_hashes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">accounts</span><span class="p">:</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">balance_before</span><span class="p">[</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
            <span class="n">before_hashes</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">account</span><span class="p">,</span> <span class="nb">hash</span><span class="p">(</span><span class="n">position</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">position_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">)),</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">positions</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">position_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="s1">''</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

    <span class="c1"># Print the entry itself.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"------------ Transaction"</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="n">dcontext</span> <span class="o">=</span> <span class="n">options_map</span><span class="p">[</span><span class="s1">'dcontext'</span><span class="p">]</span>
    <span class="n">printer</span><span class="o">.</span><span class="n">print_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">dcontext</span><span class="p">,</span> <span class="n">render_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

        <span class="c1"># Print residuals.</span>
        <span class="n">residual</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">compute_residual</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">residual</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
            <span class="c1"># Note: We render the residual at maximum precision, for debugging.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Residual: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">residual</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

        <span class="c1"># Dump the tolerances used.</span>
        <span class="n">tolerances</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">infer_tolerances</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tolerances</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Tolerances: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1">=</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tolerances</span><span class="o">.</span><span class="n">items</span><span class="p">()))),</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

        <span class="c1"># Compute the total cost basis.</span>
        <span class="n">cost_basis</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="p">(</span>
            <span class="n">pos</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span> <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">convert</span><span class="o">.</span><span class="n">get_cost</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cost_basis</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Basis: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost_basis</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

    <span class="c1"># Print the context after.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"------------ Balances after transaction"</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">accounts</span><span class="p">:</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">balance_after</span><span class="p">[</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="nb">hash</span><span class="p">(</span><span class="n">position</span><span class="p">))</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">before_hashes</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">position_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">'*'</span> <span class="k">if</span> <span class="n">changed</span> <span class="k">else</span> <span class="s1">''</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">)),</span>
                  <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">positions</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">position_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="s1">''</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.context.render_file_context">
<code class="highlight language-python">
render_file_context<span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.context.render_file_context" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the context before and after a particular transaction is applied.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the file from which the transaction was parsed.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>lineno</code></td>
<td><code></code></td>
<td>
<p>An integer, the line number in the file the transaction was parsed from.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A multiline string of text, which consists of the context before the
transaction is applied, the transaction itself, and the context after it
is applied. You can just print that, it is in form that is intended to be
consumed by the user.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/context.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_file_context</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">):</span>
    <span class="sd">"""Render the context before and after a particular transaction is applied.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      filename: A string, the name of the file from which the transaction was parsed.</span>
<span class="sd">      lineno: An integer, the line number in the file the transaction was parsed from.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A multiline string of text, which consists of the context before the</span>
<span class="sd">      transaction is applied, the transaction itself, and the context after it</span>
<span class="sd">      is applied. You can just print that, it is in form that is intended to be</span>
<span class="sd">      consumed by the user.</span>
<span class="sd">    """</span>
    <span class="c1"># Find the closest entry.</span>
    <span class="n">closest_entry</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">find_closest</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">closest_entry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="s2">"No entry could be found before </span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">render_entry_context</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">closest_entry</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.convert_reports">
<code>convert_reports</code>
<a class="headerlink" href="#beancount.reports.convert_reports" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Format converter reports.</p>
<p>This module contains reports that can convert an input file into other formats,
such as Ledger.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports.HLedgerPrinter">
<code>HLedgerPrinter</code>
<a class="headerlink" href="#beancount.reports.convert_reports.HLedgerPrinter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Multi-method for printing directives in HLedger format.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports.HLedgerReport">
<code>HLedgerReport</code>
<a class="headerlink" href="#beancount.reports.convert_reports.HLedgerReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out the entries in a format that can be parsed by HLedger.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports.LedgerPrinter">
<code>LedgerPrinter</code>
<a class="headerlink" href="#beancount.reports.convert_reports.LedgerPrinter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Multi-method for printing directives in Ledger format.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports.LedgerReport">
<code>LedgerReport</code>
<a class="headerlink" href="#beancount.reports.convert_reports.LedgerReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out the entries in a format that can be parsed by Ledger.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports.postings_by_type">
<code class="highlight language-python">
postings_by_type<span class="p">(</span><span class="n">entry</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.convert_reports.postings_by_type" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Split up the postings by simple, at-cost, at-price.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of Transaction.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A tuple of simple postings, postings with price conversions, postings held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/convert_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">postings_by_type</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">"""Split up the postings by simple, at-cost, at-price.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of Transaction.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A tuple of simple postings, postings with price conversions, postings held at cost.</span>
<span class="sd">    """</span>
    <span class="n">postings_at_cost</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">postings_at_price</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">postings_simple</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">cost</span><span class="p">:</span>
            <span class="n">accumlator</span> <span class="o">=</span> <span class="n">postings_at_cost</span>
        <span class="k">elif</span> <span class="n">posting</span><span class="o">.</span><span class="n">price</span><span class="p">:</span>
            <span class="n">accumlator</span> <span class="o">=</span> <span class="n">postings_at_price</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">accumlator</span> <span class="o">=</span> <span class="n">postings_simple</span>
        <span class="n">accumlator</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">postings_simple</span><span class="p">,</span> <span class="n">postings_at_price</span><span class="p">,</span> <span class="n">postings_at_cost</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports.quote">
<code class="highlight language-python">
quote<span class="p">(</span><span class="n">match</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.convert_reports.quote" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Add quotes around a re.MatchObject.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>match</code></td>
<td><code></code></td>
<td>
<p>A MatchObject from the re module.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A quoted string of the match contents.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/convert_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>25
26
27
28
29
30
31
32
33
34</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">quote</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
    <span class="sd">"""Add quotes around a re.MatchObject.</span>

<span class="sd">    Args:</span>
<span class="sd">      match: A MatchObject from the re module.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A quoted string of the match contents.</span>
<span class="sd">    """</span>
    <span class="n">currency</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">'"</span><span class="si">{}</span><span class="s1">"'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currency</span><span class="p">)</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[0-9\.]'</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span> <span class="k">else</span> <span class="n">currency</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports.quote_currency">
<code class="highlight language-python">
quote_currency<span class="p">(</span><span class="n">string</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.convert_reports.quote_currency" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Quote all the currencies with numbers from the given string.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A string of text.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of text, with the commodity expressions surrounded with quotes.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/convert_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>37
38
39
40
41
42
43
44
45</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">quote_currency</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="sd">"""Quote all the currencies with numbers from the given string.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: A string of text.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of text, with the commodity expressions surrounded with quotes.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'\b(</span><span class="si">{}</span><span class="s1">)\b'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">CURRENCY_RE</span><span class="p">),</span> <span class="n">quote</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports.split_currency_conversions">
<code class="highlight language-python">
split_currency_conversions<span class="p">(</span><span class="n">entry</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.convert_reports.split_currency_conversions" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>If the transcation has a mix of conversion at cost and a
currency conversion, split the transction into two transactions: one
that applies the currency conversion in the same account, and one
that uses the other currency without conversion.</p>
<p>This is required because Ledger does not appear to be able to grok a
transaction like this one:</p>
<p>2014-11-02 * "Buy some stock with foreign currency funds"
    Assets:CA:Investment:HOOL          5 HOOL {520.0 USD}
    Expenses:Commissions            9.95 USD
    Assets:CA:Investment:Cash   -2939.46 CAD @ 0.8879 USD</p>
<p>HISTORICAL NOTE: Adding a price directive on the first posting above makes
Ledger accept the transaction. So we will not split the transaction here
now. However, since Ledger's treatment of this type of conflict is subject
to revision (See http://bugs.ledger-cli.org/show_bug.cgi?id=630), we will
keep this code around, it might become useful eventually. See
https://groups.google.com/d/msg/ledger-cli/35hA0Dvhom0/WX8gY_5kHy0J for
details of the discussion.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of Transaction.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A pair of
  converted</code></td>
<td>
<p>boolean, true if a conversion was made.
  entries: A list of the original entry if converted was False,
    or a list of the split converted entries if True.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/convert_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">split_currency_conversions</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">"""If the transcation has a mix of conversion at cost and a</span>
<span class="sd">    currency conversion, split the transction into two transactions: one</span>
<span class="sd">    that applies the currency conversion in the same account, and one</span>
<span class="sd">    that uses the other currency without conversion.</span>

<span class="sd">    This is required because Ledger does not appear to be able to grok a</span>
<span class="sd">    transaction like this one:</span>

<span class="sd">      2014-11-02 * "Buy some stock with foreign currency funds"</span>
<span class="sd">        Assets:CA:Investment:HOOL          5 HOOL {520.0 USD}</span>
<span class="sd">        Expenses:Commissions            9.95 USD</span>
<span class="sd">        Assets:CA:Investment:Cash   -2939.46 CAD @ 0.8879 USD</span>

<span class="sd">    HISTORICAL NOTE: Adding a price directive on the first posting above makes</span>
<span class="sd">    Ledger accept the transaction. So we will not split the transaction here</span>
<span class="sd">    now. However, since Ledger's treatment of this type of conflict is subject</span>
<span class="sd">    to revision (See http://bugs.ledger-cli.org/show_bug.cgi?id=630), we will</span>
<span class="sd">    keep this code around, it might become useful eventually. See</span>
<span class="sd">    https://groups.google.com/d/msg/ledger-cli/35hA0Dvhom0/WX8gY_5kHy0J for</span>
<span class="sd">    details of the discussion.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of Transaction.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of</span>
<span class="sd">        converted: boolean, true if a conversion was made.</span>
<span class="sd">        entries: A list of the original entry if converted was False,</span>
<span class="sd">          or a list of the split converted entries if True.</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">)</span>

    <span class="p">(</span><span class="n">postings_simple</span><span class="p">,</span> <span class="n">postings_at_price</span><span class="p">,</span> <span class="n">postings_at_cost</span><span class="p">)</span> <span class="o">=</span> <span class="n">postings_by_type</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="n">converted</span> <span class="o">=</span> <span class="n">postings_at_cost</span> <span class="ow">and</span> <span class="n">postings_at_price</span>
    <span class="k">if</span> <span class="n">converted</span><span class="p">:</span>
        <span class="c1"># Generate a new entry for each currency conversion.</span>
        <span class="n">new_entries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">replacement_postings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">posting_orig</span> <span class="ow">in</span> <span class="n">postings_at_price</span><span class="p">:</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">get_weight</span><span class="p">(</span><span class="n">posting_orig</span><span class="p">)</span>
            <span class="n">posting_pos</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Posting</span><span class="p">(</span><span class="n">posting_orig</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
                                       <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">posting_neg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Posting</span><span class="p">(</span><span class="n">posting_orig</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="o">-</span><span class="n">weight</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
                                       <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="n">currency_entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span>
                <span class="n">postings</span><span class="o">=</span><span class="p">[</span><span class="n">posting_orig</span><span class="p">,</span> <span class="n">posting_neg</span><span class="p">],</span>
                <span class="n">narration</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">narration</span> <span class="o">+</span> <span class="s1">' (Currency conversion)'</span><span class="p">)</span>
            <span class="n">new_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currency_entry</span><span class="p">)</span>
            <span class="n">replacement_postings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posting_pos</span><span class="p">)</span>

        <span class="n">converted_entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">postings</span><span class="o">=</span><span class="p">(</span>
            <span class="n">postings_at_cost</span> <span class="o">+</span> <span class="n">postings_simple</span> <span class="o">+</span> <span class="n">replacement_postings</span><span class="p">))</span>
        <span class="n">new_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">converted_entry</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_entries</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">converted</span><span class="p">,</span> <span class="n">new_entries</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.convert_reports_test">
<code>convert_reports_test</code>
<a class="headerlink" href="#beancount.reports.convert_reports_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports_test.TestLedgerConversion">
<code>TestLedgerConversion</code>
<a class="headerlink" href="#beancount.reports.convert_reports_test.TestLedgerConversion" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.convert_reports_test.TestLedgerConversion.check_parses_ledger">
<code class="highlight language-python">
check_parses_ledger<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger_filename</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.convert_reports_test.TestLedgerConversion.check_parses_ledger" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Assert that the filename parses through Ledger without errors.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the Ledger file.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/convert_reports_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">check_parses_ledger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger_filename</span><span class="p">):</span>
    <span class="sd">"""Assert that the filename parses through Ledger without errors.</span>

<span class="sd">    Args:</span>
<span class="sd">      filename: A string, the name of the Ledger file.</span>
<span class="sd">    """</span>
    <span class="n">version</span> <span class="o">=</span> <span class="n">get_ledger_version</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">version</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skipTest</span><span class="p">(</span><span class="s1">'Ledger is not installed or has insufficient version, '</span>
                      <span class="s1">'cannot verify conversion; skipping test'</span><span class="p">)</span>

    <span class="n">pipe</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">'ledger'</span><span class="p">,</span> <span class="s1">'-f'</span><span class="p">,</span> <span class="n">ledger_filename</span><span class="p">,</span> <span class="s1">'bal'</span><span class="p">],</span>
                            <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
    <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pipe</span><span class="o">.</span><span class="n">returncode</span><span class="p">,</span> <span class="n">stderr</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports_test.TestLedgerUtilityFunctionsOnPostings">
<code>TestLedgerUtilityFunctionsOnPostings</code>
<a class="headerlink" href="#beancount.reports.convert_reports_test.TestLedgerUtilityFunctionsOnPostings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.convert_reports_test.TestLedgerUtilityFunctionsOnPostings.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.convert_reports_test.TestLedgerUtilityFunctionsOnPostings.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/convert_reports_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@loader</span><span class="o">.</span><span class="n">load_doc</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">      2000-01-01 open Assets:CA:Investment:HOOL</span>
<span class="sd">      2000-01-01 open Expenses:Commissions</span>
<span class="sd">      2000-01-01 open Assets:CA:Investment:Cash</span>

<span class="sd">      2014-10-01 * "Buy some stock with local funds"</span>
<span class="sd">        Assets:CA:Investment:HOOL          5 HOOL {500.00 USD}</span>
<span class="sd">        Expenses:Commissions            9.95 USD</span>
<span class="sd">        Assets:CA:Investment:Cash   -2509.95 USD</span>

<span class="sd">      2014-10-02 * "Regular price conversion with fee"</span>
<span class="sd">        Assets:CA:Investment:Cash    2500.00 USD</span>
<span class="sd">        Expenses:Commissions            9.95 USD</span>
<span class="sd">        Assets:CA:Investment:Cash   -2826.84 CAD @ 0.8879 USD</span>

<span class="sd">      2014-10-03 * "Buy some stock with foreign currency funds"</span>
<span class="sd">        Assets:CA:Investment:HOOL          5 HOOL {520.0 USD}</span>
<span class="sd">        Expenses:Commissions            9.95 USD</span>
<span class="sd">        Assets:CA:Investment:Cash   -2939.46 CAD @ 0.8879 USD</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">txns</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">)]</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.convert_reports_test.get_ledger_version">
<code class="highlight language-python">
get_ledger_version<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.reports.convert_reports_test.get_ledger_version" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Check that we have a sufficient version of Ledger installed.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A tuple of integer, the Ledger binary version triple, or None,
if Ledger is not installed or could not be run.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/convert_reports_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_ledger_version</span><span class="p">():</span>
    <span class="sd">"""Check that we have a sufficient version of Ledger installed.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A tuple of integer, the Ledger binary version triple, or None,</span>
<span class="sd">      if Ledger is not installed or could not be run.</span>
<span class="sd">    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pipe</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">'ledger'</span><span class="p">,</span> <span class="s1">'--version'</span><span class="p">],</span>
                                <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                                <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
        <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">'(\d+)\.(\d+)\.(\d+)'</span><span class="p">,</span> <span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.export_reports">
<code>export_reports</code>
<a class="headerlink" href="#beancount.reports.export_reports" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Reports to Export to third-party portfolio sites.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.export_reports.ExportEntry">
<code>ExportEntry</code>
<a class="headerlink" href="#beancount.reports.export_reports.ExportEntry" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>ExportEntry(symbol, cost_currency, number, cost_number, mutual_fund, memo, holdings)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.export_reports.ExportEntry.__getnewargs__">
<code class="highlight language-python">
__getnewargs__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.reports.export_reports.ExportEntry.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>427
428
429</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">'Return self as a plain tuple.  Used by copy and pickle.'</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.export_reports.ExportEntry.__new__">
<code class="highlight language-python">
__new__<span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">cost_number</span><span class="p">,</span> <span class="n">mutual_fund</span><span class="p">,</span> <span class="n">memo</span><span class="p">,</span> <span class="n">holdings</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.export_reports.ExportEntry.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of ExportEntry(symbol, cost_currency, number, cost_number, mutual_fund, memo, holdings)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.export_reports.ExportEntry.__repr__">
<code class="highlight language-python">
__repr__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.reports.export_reports.ExportEntry.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>419
420
421</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">'Return a nicely formatted representation string'</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.export_reports.ExportPortfolioReport">
<code>ExportPortfolioReport</code>
<a class="headerlink" href="#beancount.reports.export_reports.ExportPortfolioReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Holdings lists that can be exported to external portfolio management software.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.export_reports.ExportPortfolioReport.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.export_reports.ExportPortfolioReport.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>410
411
412
413
414
415
416
417
418
419
420
421</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-d'</span><span class="p">,</span> <span class="s1">'--debug'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Output position export debugging information on stderr."</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-p'</span><span class="p">,</span> <span class="s1">'--promiscuous'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s2">"Include title and account names in memos. "</span>
                              <span class="s2">"Use this if you trust wherever you upload."</span><span class="p">))</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-a'</span><span class="p">,</span> <span class="s1">'--aggregate-by-commodity'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s2">"Group the holdings by account. This may help if your "</span>
                              <span class="s2">"portfolio fails to import and you have many holdings."</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.export_reports.classify_holdings_for_export">
<code class="highlight language-python">
classify_holdings_for_export<span class="p">(</span><span class="n">holdings_list</span><span class="p">,</span> <span class="n">commodities_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.export_reports.classify_holdings_for_export" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Figure out what to do for example with each holding.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>holdings_list</code></td>
<td><code></code></td>
<td>
<p>A list of Holding instances to be exported.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>commodities_map</code></td>
<td><code></code></td>
<td>
<p>A dict of commodity to Commodity instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A pair of</code></td>
<td>
<p>action_holdings: A list of (symbol, holding) for each holding. 'Symbol'
    is the ticker to use for export, and may be "CASH" or "IGNORE" for
    holdings to be converted or ignored.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">classify_holdings_for_export</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">,</span> <span class="n">commodities_map</span><span class="p">):</span>
    <span class="sd">"""Figure out what to do for example with each holding.</span>

<span class="sd">    Args:</span>
<span class="sd">      holdings_list: A list of Holding instances to be exported.</span>
<span class="sd">      commodities_map: A dict of commodity to Commodity instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of:</span>
<span class="sd">        action_holdings: A list of (symbol, holding) for each holding. 'Symbol'</span>
<span class="sd">          is the ticker to use for export, and may be "CASH" or "IGNORE" for</span>
<span class="sd">          holdings to be converted or ignored.</span>
<span class="sd">    """</span>
    <span class="c1"># Get the map of commodities to tickers and export meta tags.</span>
    <span class="n">exports</span> <span class="o">=</span> <span class="n">getters</span><span class="o">.</span><span class="n">get_values_meta</span><span class="p">(</span><span class="n">commodities_map</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">)</span>

    <span class="c1"># Classify the holdings based on their commodities' ticker metadata field.</span>
    <span class="n">action_holdings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">holdings_list</span><span class="p">:</span>
        <span class="c1"># Get export field and remove (MONEY:...) specifications.</span>
        <span class="n">export</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'\(.*\)'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">exports</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">holding</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">export</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">export</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"CASH"</span><span class="p">:</span>
                <span class="n">action_holdings</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">'CASH'</span><span class="p">,</span> <span class="n">holding</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">export</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"IGNORE"</span><span class="p">:</span>
                <span class="n">action_holdings</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">'IGNORE'</span><span class="p">,</span> <span class="n">holding</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">action_holdings</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">export</span><span class="p">,</span> <span class="n">holding</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">((</span><span class="s2">"Exporting holding using default commodity name '</span><span class="si">{}</span><span class="s2">'; this "</span>
                             <span class="s2">"can potentially break the OFX import. Consider providing "</span>
                             <span class="s2">"'export' metadata for your commodities."</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                 <span class="n">holding</span><span class="o">.</span><span class="n">currency</span><span class="p">))</span>
            <span class="n">action_holdings</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">holding</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">holding</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">action_holdings</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.export_reports.export_holdings">
<code class="highlight language-python">
export_holdings<span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">promiscuous</span><span class="p">,</span> <span class="n">aggregate_by_commodity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.export_reports.export_holdings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute a list of holdings to export.</p>
<p>Holdings that are converted to cash equivalents will receive a currency of
"CASH:&lt;currency&gt;" where &lt;currency&gt; is the converted cash currency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options as provided by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>promiscuous</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if we should output a promiscuious memo.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>aggregate_by_commodity</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if we should group the holdings by account.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A pair of
  exported</code></td>
<td>
<p>A list of ExportEntry tuples, one for each exported position.
  converted: A list of ExportEntry tuples, one for each converted position.
    These will contain multiple holdings.
  holdings_ignored: A list of Holding instances that were ignored, either
    because they were explicitly marked to be ignored, or because we could
    not convert them to a money vehicle matching the holding's cost-currency.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">export_holdings</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">promiscuous</span><span class="p">,</span> <span class="n">aggregate_by_commodity</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""Compute a list of holdings to export.</span>

<span class="sd">    Holdings that are converted to cash equivalents will receive a currency of</span>
<span class="sd">    "CASH:&lt;currency&gt;" where &lt;currency&gt; is the converted cash currency.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of options as provided by the parser.</span>
<span class="sd">      promiscuous: A boolean, true if we should output a promiscuious memo.</span>
<span class="sd">      aggregate_by_commodity: A boolean, true if we should group the holdings by account.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of</span>
<span class="sd">        exported: A list of ExportEntry tuples, one for each exported position.</span>
<span class="sd">        converted: A list of ExportEntry tuples, one for each converted position.</span>
<span class="sd">          These will contain multiple holdings.</span>
<span class="sd">        holdings_ignored: A list of Holding instances that were ignored, either</span>
<span class="sd">          because they were explicitly marked to be ignored, or because we could</span>
<span class="sd">          not convert them to a money vehicle matching the holding's cost-currency.</span>
<span class="sd">    """</span>
    <span class="c1"># Get the desired list of holdings.</span>
    <span class="n">holdings_list</span><span class="p">,</span> <span class="n">price_map</span> <span class="o">=</span> <span class="n">holdings_reports</span><span class="o">.</span><span class="n">get_assets_holdings</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span>
    <span class="n">commodities_map</span> <span class="o">=</span> <span class="n">getters</span><span class="o">.</span><span class="n">get_commodity_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
    <span class="n">dcontext</span> <span class="o">=</span> <span class="n">options_map</span><span class="p">[</span><span class="s1">'dcontext'</span><span class="p">]</span>

    <span class="c1"># Aggregate the holdings, if requested. Google Finance is notoriously</span>
    <span class="c1"># finnicky and if you have many holdings this might help.</span>
    <span class="k">if</span> <span class="n">aggregate_by_commodity</span><span class="p">:</span>
        <span class="n">holdings_list</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">aggregate_holdings_by</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">,</span>
                                                       <span class="k">lambda</span> <span class="n">holding</span><span class="p">:</span> <span class="n">holding</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>

    <span class="c1"># Classify all the holdings for export.</span>
    <span class="n">action_holdings</span> <span class="o">=</span> <span class="n">classify_holdings_for_export</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">,</span> <span class="n">commodities_map</span><span class="p">)</span>

    <span class="c1"># The lists of exported and converted export entries, and the list of</span>
    <span class="c1"># ignored holdings.</span>
    <span class="n">exported</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">converted</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">holdings_ignored</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Export the holdings with tickers individually.</span>
    <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">action_holdings</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"CASH"</span><span class="p">,</span> <span class="s2">"IGNORE"</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">holding</span><span class="o">.</span><span class="n">cost_number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">holding</span><span class="o">.</span><span class="n">cost_currency</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">holding</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
            <span class="n">cost_number</span> <span class="o">=</span> <span class="n">holding</span><span class="o">.</span><span class="n">number</span>
            <span class="n">cost_currency</span> <span class="o">=</span> <span class="n">holding</span><span class="o">.</span><span class="n">currency</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cost_number</span> <span class="o">=</span> <span class="n">holding</span><span class="o">.</span><span class="n">cost_number</span>
            <span class="n">cost_currency</span> <span class="o">=</span> <span class="n">holding</span><span class="o">.</span><span class="n">cost_currency</span>

        <span class="n">exported</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">ExportEntry</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span>
                        <span class="n">cost_currency</span><span class="p">,</span>
                        <span class="n">holding</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
                        <span class="n">cost_number</span><span class="p">,</span>
                        <span class="n">is_mutual_fund</span><span class="p">(</span><span class="n">symbol</span><span class="p">),</span>
                        <span class="n">holding</span><span class="o">.</span><span class="n">account</span> <span class="k">if</span> <span class="n">promiscuous</span> <span class="k">else</span> <span class="s1">''</span><span class="p">,</span>
                        <span class="p">[</span><span class="n">holding</span><span class="p">]))</span>

    <span class="c1"># Convert all the cash entries to their book and market value by currency.</span>
    <span class="n">cash_holdings_map</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">action_holdings</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">symbol</span> <span class="o">!=</span> <span class="s2">"CASH"</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">holding</span><span class="o">.</span><span class="n">cost_currency</span><span class="p">:</span>
            <span class="c1"># Accumulate market and book values.</span>
            <span class="n">cash_holdings_map</span><span class="p">[</span><span class="n">holding</span><span class="o">.</span><span class="n">cost_currency</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">holding</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># We cannot price this... no cost currency.</span>
            <span class="n">holdings_ignored</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">holding</span><span class="p">)</span>

    <span class="c1"># Get the money instruments.</span>
    <span class="n">money_instruments</span> <span class="o">=</span> <span class="n">get_money_instruments</span><span class="p">(</span><span class="n">commodities_map</span><span class="p">)</span>

    <span class="c1"># Convert all the cash values to money instruments, if possible. If not</span>
    <span class="c1"># possible, we'll just have to ignore those values.</span>

    <span class="c1"># Go through all the holdings to convert, and for each of those which aren't</span>
    <span class="c1"># in terms of one of the money instruments, which we can directly add to the</span>
    <span class="c1"># exported portfolio, attempt to convert them into currencies to one of</span>
    <span class="c1"># those in the money instruments.</span>
    <span class="n">money_values_book</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
    <span class="n">money_values_market</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
    <span class="n">money_values_holdings</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cost_currency</span><span class="p">,</span> <span class="n">holdings_list</span> <span class="ow">in</span> <span class="n">cash_holdings_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">book_value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">holding</span><span class="o">.</span><span class="n">book_value</span> <span class="k">for</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">holdings_list</span><span class="p">)</span>
        <span class="n">market_value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">holding</span><span class="o">.</span><span class="n">market_value</span> <span class="k">for</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">holdings_list</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cost_currency</span> <span class="ow">in</span> <span class="n">money_instruments</span><span class="p">:</span>
            <span class="c1"># The holding is already in terms of one of the money instruments.</span>
            <span class="n">money_values_book</span><span class="p">[</span><span class="n">cost_currency</span><span class="p">]</span> <span class="o">+=</span> <span class="n">book_value</span>
            <span class="n">money_values_market</span><span class="p">[</span><span class="n">cost_currency</span><span class="p">]</span> <span class="o">+=</span> <span class="n">market_value</span>
            <span class="n">money_values_holdings</span><span class="p">[</span><span class="n">cost_currency</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The holding is not in terms of one of the money instruments.</span>
            <span class="c1"># Find the first available price to convert it into one</span>
            <span class="k">for</span> <span class="n">money_currency</span> <span class="ow">in</span> <span class="n">money_instruments</span><span class="p">:</span>
                <span class="n">base_quote</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_currency</span><span class="p">,</span> <span class="n">money_currency</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">rate</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_latest_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">money_values_book</span><span class="p">[</span><span class="n">money_currency</span><span class="p">]</span> <span class="o">+=</span> <span class="n">book_value</span> <span class="o">*</span> <span class="n">rate</span>
                    <span class="n">money_values_market</span><span class="p">[</span><span class="n">money_currency</span><span class="p">]</span> <span class="o">+=</span> <span class="n">market_value</span> <span class="o">*</span> <span class="n">rate</span>
                    <span class="n">money_values_holdings</span><span class="p">[</span><span class="n">money_currency</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># We could not convert into any of the money commodities. Ignore</span>
                <span class="c1"># those holdings.</span>
                <span class="n">holdings_ignored</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">money_currency</span> <span class="ow">in</span> <span class="n">money_values_book</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">book_value</span> <span class="o">=</span> <span class="n">money_values_book</span><span class="p">[</span><span class="n">money_currency</span><span class="p">]</span>
        <span class="n">market_value</span> <span class="o">=</span> <span class="n">money_values_market</span><span class="p">[</span><span class="n">money_currency</span><span class="p">]</span>
        <span class="n">holdings_list</span> <span class="o">=</span> <span class="n">money_values_holdings</span><span class="p">[</span><span class="n">money_currency</span><span class="p">]</span>

        <span class="n">symbol</span> <span class="o">=</span> <span class="n">money_instruments</span><span class="p">[</span><span class="n">money_currency</span><span class="p">]</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">book_value</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">market_value</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">)</span>
        <span class="n">converted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">ExportEntry</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span>
                        <span class="n">money_currency</span><span class="p">,</span>
                        <span class="n">dcontext</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">market_value</span><span class="p">,</span> <span class="n">money_currency</span><span class="p">),</span>
                        <span class="n">dcontext</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">book_value</span> <span class="o">/</span> <span class="n">market_value</span><span class="p">,</span> <span class="n">money_currency</span><span class="p">),</span>
                        <span class="n">is_mutual_fund</span><span class="p">(</span><span class="n">symbol</span><span class="p">),</span>
                        <span class="s1">''</span><span class="p">,</span>
                        <span class="n">holdings_list</span><span class="p">))</span>

    <span class="c1"># Add all ignored holdings to a final list.</span>
    <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">action_holdings</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">symbol</span> <span class="o">==</span> <span class="s2">"IGNORE"</span><span class="p">:</span>
            <span class="n">holdings_ignored</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">holding</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">exported</span><span class="p">,</span> <span class="n">converted</span><span class="p">,</span> <span class="n">holdings_ignored</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.export_reports.get_money_instruments">
<code class="highlight language-python">
get_money_instruments<span class="p">(</span><span class="n">commodities_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.export_reports.get_money_instruments" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the money-market stand-ins for cash positions.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>commodities_map</code></td>
<td><code></code></td>
<td>
<p>A map of currency to their corresponding Commodity directives.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A dict of quote currency to the ticker symbol that stands for it,
e.g. {'USD'</code></td>
<td>
<p>'VMMXX'}.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_money_instruments</span><span class="p">(</span><span class="n">commodities_map</span><span class="p">):</span>
    <span class="sd">"""Get the money-market stand-ins for cash positions.</span>

<span class="sd">    Args:</span>
<span class="sd">      commodities_map: A map of currency to their corresponding Commodity directives.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A dict of quote currency to the ticker symbol that stands for it,</span>
<span class="sd">      e.g. {'USD': 'VMMXX'}.</span>
<span class="sd">    """</span>
    <span class="n">instruments</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">commodities_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">export</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">FIELD</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
        <span class="n">paren_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">'\((.*)\)'</span><span class="p">,</span> <span class="n">export</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">paren_match</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'MONEY:(</span><span class="si">{}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">CURRENCY_RE</span><span class="p">),</span> <span class="n">paren_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">instruments</span><span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">'\(.*\)'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">export</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="n">currency</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">"Invalid money specification: </span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span> <span class="n">export</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">instruments</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.export_reports.get_symbol">
<code class="highlight language-python">
get_symbol<span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s1">'google'</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.export_reports.get_symbol" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Filter a source specification to some corresponding ticker.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>source</code></td>
<td><code></code></td>
<td>
<p>A comma-separated list of sources as a string, such as
"google/NASDAQ:AAPL,yahoo/AAPL".</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The symbol string.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>If the sources does not contain a ticker for the
google source.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_symbol</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s1">'google'</span><span class="p">):</span>
    <span class="sd">"""Filter a source specification to some corresponding ticker.</span>

<span class="sd">    Args:</span>
<span class="sd">      source: A comma-separated list of sources as a string, such as</span>
<span class="sd">        "google/NASDAQ:AAPL,yahoo/AAPL".</span>
<span class="sd">    Returns:</span>
<span class="sd">      The symbol string.</span>
<span class="sd">    Raises:</span>
<span class="sd">      ValueError: If the sources does not contain a ticker for the</span>
<span class="sd">        google source.</span>
<span class="sd">    """</span>

    <span class="c1"># If the ticker is a list of &lt;source&gt;/&lt;symbol&gt;, extract the symbol</span>
    <span class="c1"># from it.</span>
    <span class="n">symbol_items</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span> <span class="n">sources</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)):</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'([a-zA-Z][a-zA-Z0-9._]+)/(.*)'</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">source</span><span class="p">,</span> <span class="n">symbol</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source</span><span class="p">,</span> <span class="n">symbol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">source</span>
        <span class="n">symbol_items</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">source</span><span class="p">,</span> <span class="n">symbol</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">symbol_items</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">'Invalid source "</span><span class="si">{}</span><span class="s1">" does not contain a ticker'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sources</span><span class="p">))</span>
    <span class="n">symbol_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">symbol_items</span><span class="p">)</span>
    <span class="c1"># If not found, return the first symbol in the list of items.</span>
    <span class="k">return</span> <span class="n">symbol_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prefer</span><span class="p">,</span> <span class="n">symbol_items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.export_reports.is_mutual_fund">
<code class="highlight language-python">
is_mutual_fund<span class="p">(</span><span class="n">ticker</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.export_reports.is_mutual_fund" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the GFinanc ticker is for a mutual fund.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ticker</code></td>
<td><code></code></td>
<td>
<p>A string, the symbol for GFinance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true for mutual funds.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>46
47
48
49
50
51
52
53
54</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">is_mutual_fund</span><span class="p">(</span><span class="n">ticker</span><span class="p">):</span>
    <span class="sd">"""Return true if the GFinanc ticker is for a mutual fund.</span>

<span class="sd">    Args:</span>
<span class="sd">      ticker: A string, the symbol for GFinance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true for mutual funds.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">'MUTF.*:'</span><span class="p">,</span> <span class="n">ticker</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.export_reports.render_ofx_date">
<code class="highlight language-python">
render_ofx_date<span class="p">(</span><span class="n">dtime</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.export_reports.render_ofx_date" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a datetime to the OFX format.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dtime</code></td>
<td><code></code></td>
<td>
<p>A datetime.datetime instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, rendered to milliseconds.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>257
258
259
260
261
262
263
264
265
266</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_ofx_date</span><span class="p">(</span><span class="n">dtime</span><span class="p">):</span>
    <span class="sd">"""Render a datetime to the OFX format.</span>

<span class="sd">    Args:</span>
<span class="sd">      dtime: A datetime.datetime instance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, rendered to milliseconds.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s1">'</span><span class="si">{}</span><span class="s1">.</span><span class="si">{:03d}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">'%Y%m</span><span class="si">%d</span><span class="s1">%H%M%S'</span><span class="p">),</span>
                              <span class="nb">int</span><span class="p">(</span><span class="n">dtime</span><span class="o">.</span><span class="n">microsecond</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.export_reports_test">
<code>export_reports_test</code>
<a class="headerlink" href="#beancount.reports.export_reports_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.export_reports_test.TestHoldingsReports">
<code>TestHoldingsReports</code>
<a class="headerlink" href="#beancount.reports.export_reports_test.TestHoldingsReports" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.export_reports_test.TestHoldingsReports.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.export_reports_test.TestHoldingsReports.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/export_reports_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@loader</span><span class="o">.</span><span class="n">load_doc</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    2014-01-01 open Assets:Bank1</span>
<span class="sd">    2014-01-01 open Assets:Bank2</span>
<span class="sd">    2014-01-01 open Assets:Bank3</span>
<span class="sd">    2014-01-01 open Income:Something</span>

<span class="sd">    2014-05-31 *</span>
<span class="sd">      Assets:Bank1         100 MSFT {200.01 USD}</span>
<span class="sd">      Income:Something</span>

<span class="sd">    2014-05-31 *</span>
<span class="sd">      Assets:Bank2         1000 INR @ 200 USD</span>
<span class="sd">      Income:Something</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">options_map</span> <span class="o">=</span> <span class="n">options_map</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.gviz">
<code>gviz</code>
<a class="headerlink" href="#beancount.reports.gviz" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Support for creating Google gviz timeline charts.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.gviz.gviz_timeline">
<code class="highlight language-python">
gviz_timeline<span class="p">(</span><span class="n">time_array</span><span class="p">,</span> <span class="n">data_array_map</span><span class="p">,</span> <span class="n">css_id</span><span class="o">=</span><span class="s1">'chart'</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.gviz.gviz_timeline" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create a HTML rendering of the given arrays.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>time_array</code></td>
<td><code></code></td>
<td>
<p>A sequence of datetime objects.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>data_array_map</code></td>
<td><code></code></td>
<td>
<p>A dict or list of items of name to
              sequence of data points.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>css_id</code></td>
<td><code></code></td>
<td>
<p>A string, the CSS id attribute of the target node.</p>
</td>
<td><code>'chart'</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>Javascript code for rendering the chart. (It's up to you to
insert the a div with the correct CSS id in your accompanying
HTML page.)</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/gviz.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">gviz_timeline</span><span class="p">(</span><span class="n">time_array</span><span class="p">,</span> <span class="n">data_array_map</span><span class="p">,</span> <span class="n">css_id</span><span class="o">=</span><span class="s1">'chart'</span><span class="p">):</span>
    <span class="sd">"""Create a HTML rendering of the given arrays.</span>

<span class="sd">    Args:</span>
<span class="sd">      time_array: A sequence of datetime objects.</span>
<span class="sd">      data_array_map: A dict or list of items of name to</span>
<span class="sd">                      sequence of data points.</span>
<span class="sd">      css_id: A string, the CSS id attribute of the target node.</span>
<span class="sd">    Returns:</span>
<span class="sd">      Javascript code for rendering the chart. (It's up to you to</span>
<span class="sd">      insert the a div with the correct CSS id in your accompanying</span>
<span class="sd">      HTML page.)</span>
<span class="sd">    """</span>
    <span class="c1"># Set the order of the data to be output.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_array_map</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">data_array_map</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_array_map</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

    <span class="c1"># Write preamble.</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>

    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;script src="https://www.google.com/jsapi" type="text/javascript"&gt;'</span>
              <span class="s1">'&lt;/script&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;script type="text/javascript"&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"""</span><span class="se">\</span>
<span class="s2">      google.load('visualization', '1', {packages: ['annotatedtimeline']});</span>
<span class="s2">      function draw() {</span>
<span class="s2">        var data = new google.visualization.DataTable();</span>
<span class="s2">      """</span><span class="p">)</span>

    <span class="c1"># Declare columns.</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"data.addColumn('</span><span class="si">{}</span><span class="s2">', '</span><span class="si">{}</span><span class="s2">');</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">'datetime'</span><span class="p">,</span> <span class="s1">'Time'</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">data_array_map</span><span class="p">:</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"data.addColumn('</span><span class="si">{}</span><span class="s2">', '</span><span class="si">{}</span><span class="s2">');</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">'number'</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>

    <span class="c1"># Render the rows.</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'data.addRows([</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

    <span class="n">datalists</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_array_map</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">dtime</span><span class="p">,</span> <span class="n">datas</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">time_array</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">datalists</span><span class="p">)):</span>
        <span class="n">js_datetime</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'Date(</span><span class="si">{0.year}</span><span class="s1">, </span><span class="si">{0.month}</span><span class="s1">, </span><span class="si">{0.day}</span><span class="s1">)'</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtime</span><span class="p">)</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'  [new </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">],</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">js_datetime</span><span class="p">,</span> <span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">datas</span><span class="p">))))</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">']);</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"""</span>
<span class="s2">        var annotatedtimeline = new google.visualization.AnnotatedTimeLine(</span>
<span class="s2">            document.getElementById('</span><span class="si">{css_id}</span><span class="s2">')</span>
<span class="s2">        );</span>

<span class="s2">        var options = {{</span>
<span class="s2">          'legendPosition'    : 'newRow',</span>
<span class="s2">          'displayAnnotations': true,</span>
<span class="s2">        }};</span>

<span class="s2">        annotatedtimeline.draw(data, options);</span>
<span class="s2">      }}</span>

<span class="s2">      google.setOnLoadCallback(draw);</span>
<span class="s2">    """</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">css_id</span><span class="o">=</span><span class="n">css_id</span><span class="p">))</span>

    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/script&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.holdings_reports">
<code>holdings_reports</code>
<a class="headerlink" href="#beancount.reports.holdings_reports" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Generate reports no holdings.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.holdings_reports.CashReport">
<code>CashReport</code>
<a class="headerlink" href="#beancount.reports.holdings_reports.CashReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The list of cash holdings (defined as currency = cost-currency).</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.holdings_reports.CashReport.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.holdings_reports.CashReport.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>274
275
276
277
278
279
280
281
282
283
284
285
286</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-c'</span><span class="p">,</span> <span class="s1">'--currency'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Which currency to convert all the holdings to"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-i'</span><span class="p">,</span> <span class="s1">'--ignored'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Report on ignored holdings instead of included ones"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-o'</span><span class="p">,</span> <span class="s1">'--operating-only'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Only report on operating currencies"</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.holdings_reports.CashReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.holdings_reports.CashReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">holdings_list</span><span class="p">,</span> <span class="n">price_map</span> <span class="o">=</span> <span class="n">get_assets_holdings</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span>
    <span class="n">holdings_list_orig</span> <span class="o">=</span> <span class="n">holdings_list</span>

    <span class="c1"># Keep only the holdings where currency is the same as the cost-currency.</span>
    <span class="n">holdings_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">holding</span>
                     <span class="k">for</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">holdings_list</span>
                     <span class="k">if</span> <span class="p">(</span><span class="n">holding</span><span class="o">.</span><span class="n">currency</span> <span class="o">==</span> <span class="n">holding</span><span class="o">.</span><span class="n">cost_currency</span> <span class="ow">or</span>
                         <span class="n">holding</span><span class="o">.</span><span class="n">cost_currency</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)]</span>

    <span class="c1"># Keep only those holdings held in one of the operating currencies.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">operating_only</span><span class="p">:</span>
        <span class="n">operating_currencies</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">options_map</span><span class="p">[</span><span class="s1">'operating_currency'</span><span class="p">])</span>
        <span class="n">holdings_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">holding</span>
                         <span class="k">for</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">holdings_list</span>
                         <span class="k">if</span> <span class="n">holding</span><span class="o">.</span><span class="n">currency</span> <span class="ow">in</span> <span class="n">operating_currencies</span><span class="p">]</span>

    <span class="c1"># Compute the list of ignored holdings and optionally report on them.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">ignored</span><span class="p">:</span>
        <span class="n">ignored_holdings</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">holdings_list_orig</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">)</span>
        <span class="n">holdings_list</span> <span class="o">=</span> <span class="n">ignored_holdings</span>

    <span class="c1"># Convert holdings to a unified currency.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">currency</span><span class="p">:</span>
        <span class="n">holdings_list</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">convert_to_currency</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span>
                                                     <span class="n">holdings_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">,</span> <span class="n">FIELD_SPEC</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.holdings_reports.HoldingsReport">
<code>HoldingsReport</code>
<a class="headerlink" href="#beancount.reports.holdings_reports.HoldingsReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The full list of holdings for Asset and Liabilities accounts.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.holdings_reports.HoldingsReport.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.holdings_reports.HoldingsReport.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>235
236
237
238
239
240
241
242
243
244
245
246
247
248</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-c'</span><span class="p">,</span> <span class="s1">'--currency'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Which currency to convert all the holdings to"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-r'</span><span class="p">,</span> <span class="s1">'--relative'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"True if we should render as relative values only"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-g'</span><span class="p">,</span> <span class="s1">'--groupby'</span><span class="p">,</span> <span class="s1">'--by'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">choices</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">aggregations</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"How to group the holdings (default is: don't group)"</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.holdings_reports.HoldingsReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.holdings_reports.HoldingsReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>250
251
252
253
254</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">keywords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">groupby</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">groupby</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="k">return</span> <span class="n">report_holdings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">relative</span><span class="p">,</span>
                           <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">keywords</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.holdings_reports.NetWorthReport">
<code>NetWorthReport</code>
<a class="headerlink" href="#beancount.reports.holdings_reports.NetWorthReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Generate a table of total net worth for each operating currency.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.holdings_reports.NetWorthReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.holdings_reports.NetWorthReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">holdings_list</span><span class="p">,</span> <span class="n">price_map</span> <span class="o">=</span> <span class="n">get_assets_holdings</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span>

    <span class="n">net_worths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">currency</span> <span class="ow">in</span> <span class="n">options_map</span><span class="p">[</span><span class="s1">'operating_currency'</span><span class="p">]:</span>

        <span class="c1"># Convert holdings to a unified currency.</span>
        <span class="c1">#</span>
        <span class="c1"># Note: It's entirely possible that the price map does not have all</span>
        <span class="c1"># the necessary rate conversions here. The resulting holdings will</span>
        <span class="c1"># simply have no cost when that is the case. We must handle this</span>
        <span class="c1"># gracefully below.</span>
        <span class="n">currency_holdings_list</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">convert_to_currency</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span>
                                                              <span class="n">currency</span><span class="p">,</span>
                                                              <span class="n">holdings_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">currency_holdings_list</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">holdings_list</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">aggregate_holdings_by</span><span class="p">(</span>
            <span class="n">currency_holdings_list</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">holding</span><span class="p">:</span> <span class="n">holding</span><span class="o">.</span><span class="n">cost_currency</span><span class="p">)</span>

        <span class="n">holdings_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">holding</span>
                         <span class="k">for</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">holdings_list</span>
                         <span class="k">if</span> <span class="n">holding</span><span class="o">.</span><span class="n">currency</span> <span class="ow">and</span> <span class="n">holding</span><span class="o">.</span><span class="n">cost_currency</span><span class="p">]</span>

        <span class="c1"># If after conversion there are no valid holdings, skip the currency</span>
        <span class="c1"># altogether.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">holdings_list</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">net_worths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">currency</span><span class="p">,</span> <span class="n">holdings_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">market_value</span><span class="p">))</span>

    <span class="n">field_spec</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'Currency'</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'Net Worth'</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:,.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">net_worths</span><span class="p">,</span> <span class="n">field_spec</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.holdings_reports.get_assets_holdings">
<code class="highlight language-python">
get_assets_holdings<span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">currency</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.holdings_reports.get_assets_holdings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return holdings for all assets and liabilities.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of parsed options.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>If specified, a string, the target currency to convert all
holding values to.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of Holding instances and a price-map.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_assets_holdings</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">currency</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Return holdings for all assets and liabilities.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of parsed options.</span>
<span class="sd">      currency: If specified, a string, the target currency to convert all</span>
<span class="sd">        holding values to.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of Holding instances and a price-map.</span>
<span class="sd">    """</span>
    <span class="c1"># Compute a price map, to perform conversions.</span>
    <span class="n">price_map</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">build_price_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>

    <span class="c1"># Get the list of holdings.</span>
    <span class="n">account_types</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get_account_types</span><span class="p">(</span><span class="n">options_map</span><span class="p">)</span>
    <span class="n">holdings_list</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">get_final_holdings</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span>
                                                <span class="p">(</span><span class="n">account_types</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span>
                                                 <span class="n">account_types</span><span class="o">.</span><span class="n">liabilities</span><span class="p">),</span>
                                                <span class="n">price_map</span><span class="p">)</span>

    <span class="c1"># Convert holdings to a unified currency.</span>
    <span class="k">if</span> <span class="n">currency</span><span class="p">:</span>
        <span class="n">holdings_list</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">convert_to_currency</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">holdings_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">holdings_list</span><span class="p">,</span> <span class="n">price_map</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.holdings_reports.get_holdings_entries">
<code class="highlight language-python">
get_holdings_entries<span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.holdings_reports.get_holdings_entries" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Summarizes the entries to list of entries representing the final holdings..</p>
<p>This list includes the latest prices entries as well. This can be used to
load a full snapshot of holdings without including the entire history. This
is a way of summarizing a balance sheet in a way that filters away history.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of parsed options.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the entries to print out.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_holdings_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="sd">"""Summarizes the entries to list of entries representing the final holdings..</span>

<span class="sd">    This list includes the latest prices entries as well. This can be used to</span>
<span class="sd">    load a full snapshot of holdings without including the entire history. This</span>
<span class="sd">    is a way of summarizing a balance sheet in a way that filters away history.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of parsed options.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the entries to print out.</span>
<span class="sd">    """</span>

    <span class="c1"># The entries will be created at the latest date, against an equity account.</span>
    <span class="n">latest_date</span> <span class="o">=</span> <span class="n">entries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">date</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">equity_account</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get_previous_accounts</span><span class="p">(</span><span class="n">options_map</span><span class="p">)</span>

    <span class="c1"># Get all the assets.</span>
    <span class="n">holdings_list</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_assets_holdings</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span>

    <span class="c1"># Create synthetic entries for them.</span>
    <span class="n">holdings_entries</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">holding</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">):</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">new_metadata</span><span class="p">(</span><span class="s1">'report_holdings_print'</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">latest_date</span><span class="p">,</span> <span class="n">flags</span><span class="o">.</span><span class="n">FLAG_SUMMARIZE</span><span class="p">,</span>
                                 <span class="kc">None</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[])</span>

        <span class="c1"># Convert the holding to a position.</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">holding_to_position</span><span class="p">(</span><span class="n">holding</span><span class="p">)</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">Posting</span><span class="p">(</span><span class="n">holding</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

        <span class="n">cost</span> <span class="o">=</span> <span class="o">-</span><span class="n">convert</span><span class="o">.</span><span class="n">get_cost</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">Posting</span><span class="p">(</span><span class="n">equity_account</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

        <span class="n">holdings_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="c1"># Get opening directives for all the accounts.</span>
    <span class="n">used_accounts</span> <span class="o">=</span> <span class="p">{</span><span class="n">holding</span><span class="o">.</span><span class="n">account</span> <span class="k">for</span> <span class="n">holding</span> <span class="ow">in</span> <span class="n">holdings_list</span><span class="p">}</span>
    <span class="n">open_entries</span> <span class="o">=</span> <span class="n">summarize</span><span class="o">.</span><span class="n">get_open_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">latest_date</span><span class="p">)</span>
    <span class="n">used_open_entries</span> <span class="o">=</span> <span class="p">[</span><span class="n">open_entry</span>
                         <span class="k">for</span> <span class="n">open_entry</span> <span class="ow">in</span> <span class="n">open_entries</span>
                         <span class="k">if</span> <span class="n">open_entry</span><span class="o">.</span><span class="n">account</span> <span class="ow">in</span> <span class="n">used_accounts</span><span class="p">]</span>

    <span class="c1"># Add an entry for the equity account we're using.</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">new_metadata</span><span class="p">(</span><span class="s1">'report_holdings_print'</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">used_open_entries</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">latest_date</span><span class="p">,</span> <span class="n">equity_account</span><span class="p">,</span>
                                          <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

    <span class="c1"># Get the latest price entries.</span>
    <span class="n">price_entries</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_last_price_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">used_open_entries</span> <span class="o">+</span> <span class="n">holdings_entries</span> <span class="o">+</span> <span class="n">price_entries</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.holdings_reports.load_from_csv">
<code class="highlight language-python">
load_from_csv<span class="p">(</span><span class="n">fileobj</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.holdings_reports.load_from_csv" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Load a list of holdings from a CSV file.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>fileobj</code></td>
<td><code></code></td>
<td>
<p>A file object.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  Instances of Holding, as read from the file.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">load_from_csv</span><span class="p">(</span><span class="n">fileobj</span><span class="p">):</span>
    <span class="sd">"""Load a list of holdings from a CSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">      fileobj: A file object.</span>
<span class="sd">    Yields:</span>
<span class="sd">      Instances of Holding, as read from the file.</span>
<span class="sd">    """</span>
    <span class="n">column_spec</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">'Account'</span><span class="p">,</span> <span class="s1">'account'</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'Units'</span><span class="p">,</span> <span class="s1">'number'</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'Currency'</span><span class="p">,</span> <span class="s1">'currency'</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'Cost Currency'</span><span class="p">,</span> <span class="s1">'cost_currency'</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'Average Cost'</span><span class="p">,</span> <span class="s1">'cost_number'</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'Price'</span><span class="p">,</span> <span class="s1">'price_number'</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'Book Value'</span><span class="p">,</span> <span class="s1">'book_value'</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'Market Value'</span><span class="p">,</span> <span class="s1">'market_value'</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'Price Date'</span><span class="p">,</span> <span class="s1">'price_date'</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="n">column_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">converter</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">converter</span> <span class="ow">in</span> <span class="n">column_spec</span><span class="p">}</span>
    <span class="n">klass</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">Holding</span>

    <span class="c1"># Create a set of default values for the namedtuple.</span>
    <span class="n">defaults_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">attr</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">klass</span><span class="o">.</span><span class="n">_fields</span><span class="p">}</span>

    <span class="c1"># Start reading the file.</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span>

    <span class="c1"># Check that the header is readable.</span>
    <span class="n">header</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
    <span class="n">attr_converters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">header_name</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">attr_converter</span> <span class="o">=</span> <span class="n">column_dict</span><span class="p">[</span><span class="n">header_name</span><span class="p">]</span>
            <span class="n">attr_converters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr_converter</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">"Invalid file contents for holdings"</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
        <span class="n">value_dict</span> <span class="o">=</span> <span class="n">defaults_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">converter</span><span class="p">),</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">attr_converters</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">converter</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">converter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">value_dict</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">yield</span> <span class="n">holdings</span><span class="o">.</span><span class="n">Holding</span><span class="p">(</span><span class="o">**</span><span class="n">value_dict</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.holdings_reports.report_holdings">
<code class="highlight language-python">
report_holdings<span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">relative</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">aggregation_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.holdings_reports.report_holdings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Generate a detailed list of all holdings.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>A string, a currency to convert to. If left to None, no
conversion is carried out.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>relative</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if we should reduce this to a relative value.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of parsed options.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>aggregation_key</code></td>
<td><code></code></td>
<td>
<p>A callable use to generate aggregations.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>sort_key</code></td>
<td><code></code></td>
<td>
<p>A function to use to sort the holdings, if specified.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Table instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">report_holdings</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">relative</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span>
                    <span class="n">aggregation_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">sort_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Generate a detailed list of all holdings.</span>

<span class="sd">    Args:</span>
<span class="sd">      currency: A string, a currency to convert to. If left to None, no</span>
<span class="sd">        conversion is carried out.</span>
<span class="sd">      relative: A boolean, true if we should reduce this to a relative value.</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of parsed options.</span>
<span class="sd">      aggregation_key: A callable use to generate aggregations.</span>
<span class="sd">      sort_key: A function to use to sort the holdings, if specified.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A Table instance.</span>
<span class="sd">    """</span>
    <span class="n">holdings_list</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_assets_holdings</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">aggregation_key</span><span class="p">:</span>
        <span class="n">holdings_list</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">aggregate_holdings_by</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">,</span> <span class="n">aggregation_key</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">relative</span><span class="p">:</span>
        <span class="n">holdings_list</span> <span class="o">=</span> <span class="n">holdings</span><span class="o">.</span><span class="n">reduce_relative</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">)</span>
        <span class="n">field_spec</span> <span class="o">=</span> <span class="n">RELATIVE_FIELD_SPEC</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">field_spec</span> <span class="o">=</span> <span class="n">FIELD_SPEC</span>

    <span class="k">if</span> <span class="n">sort_key</span><span class="p">:</span>
        <span class="n">holdings_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">sort_key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">holdings_list</span><span class="p">,</span> <span class="n">field_spec</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.holdings_reports_test">
<code>holdings_reports_test</code>
<a class="headerlink" href="#beancount.reports.holdings_reports_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.holdings_reports_test.TestHoldingsReports">
<code>TestHoldingsReports</code>
<a class="headerlink" href="#beancount.reports.holdings_reports_test.TestHoldingsReports" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.holdings_reports_test.TestHoldingsReports.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.holdings_reports_test.TestHoldingsReports.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/holdings_reports_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@loader</span><span class="o">.</span><span class="n">load_doc</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    2014-01-01 open Assets:Bank1</span>
<span class="sd">    2014-01-01 open Assets:Bank2</span>
<span class="sd">    2014-01-01 open Assets:Bank3</span>
<span class="sd">    2014-01-01 open Income:Something</span>

<span class="sd">    2014-05-31 *</span>
<span class="sd">      Assets:Bank1         100 MSFT {200.01 USD}</span>
<span class="sd">      Income:Something</span>

<span class="sd">    2014-05-31 *</span>
<span class="sd">      Assets:Bank2         1000 INR @ 200 USD</span>
<span class="sd">      Income:Something</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">options_map</span> <span class="o">=</span> <span class="n">options_map</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.html_formatter">
<code>html_formatter</code>
<a class="headerlink" href="#beancount.reports.html_formatter" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Base class for HTML formatters.</p>
<p>This object encapsulates the rendering of various objects to HTML.
You may, and should, derive and override from this object in order to
provide links within a web interface.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter">
<code>HTMLFormatter</code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A trivial formatter object that can be used to format strings as themselves.
    This mainly defines an interface to implement.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dcontext</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create an instance of HTMLFormatter.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dcontext</code></td>
<td><code></code></td>
<td>
<p>DisplayContext to use to render the numbers.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>19
20
21
22
23
24
25
26</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dcontext</span><span class="p">):</span>
    <span class="sd">"""Create an instance of HTMLFormatter.</span>

<span class="sd">    Args:</span>
<span class="sd">      dcontext: DisplayContext to use to render the numbers.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dformat</span> <span class="o">=</span> <span class="n">dcontext</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
        <span class="n">precision</span><span class="o">=</span><span class="n">display_context</span><span class="o">.</span><span class="n">Precision</span><span class="o">.</span><span class="n">MOST_COMMON</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_account">
<code class="highlight language-python">
render_account<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_account" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render an account name.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the account to render.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML to be spliced inside an HTML template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>28
29
30
31
32
33
34
35
36</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_account</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">):</span>
    <span class="sd">"""Render an account name.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, the name of the account to render.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML to be spliced inside an HTML template.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">account_name</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_amount">
<code class="highlight language-python">
render_amount<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_amount" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render an amount.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount</code></td>
<td><code></code></td>
<td>
<p>An Amount instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML to be spliced inside a table cell.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>49
50
51
52
53
54
55
56
57</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
    <span class="sd">"""Render an amount.</span>

<span class="sd">    Args:</span>
<span class="sd">      amount: An Amount instance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML to be spliced inside a table cell.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">amount</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dformat</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_commodity">
<code class="highlight language-python">
render_commodity<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_commodity" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render a commodity (base currency / quote currency).</p>
<p>This is only used when we want the commodity to link to its prices.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>commodity</code></td>
<td><code></code></td>
<td>
<p>A pair of strings, the base and quote currency names.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML to be spliced inside an HTML template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>113
114
115
116
117
118
119
120
121
122
123</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_commodity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">):</span>
    <span class="sd">"""Render a commodity (base currency / quote currency).</span>

<span class="sd">    This is only used when we want the commodity to link to its prices.</span>

<span class="sd">    Args:</span>
<span class="sd">      commodity: A pair of strings, the base and quote currency names.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML to be spliced inside an HTML template.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s1">'</span><span class="si">{}</span><span class="s1"> / </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">base_quote</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_context">
<code class="highlight language-python">
render_context<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_context" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render a reference to context around a transaction (maybe as an HTML link).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>A directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML to be spliced inside an HTML template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>73
74
75
76
77
78
79
80
81</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
    <span class="sd">"""Render a reference to context around a transaction (maybe as an HTML link).</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: A directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML to be spliced inside an HTML template.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s1">''</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_doc">
<code class="highlight language-python">
render_doc<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_doc" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render a document path.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the filename for the document.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML to be spliced inside an HTML template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 93
 94
 95
 96
 97
 98
 99
100
101</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">"""Render a document path.</span>

<span class="sd">    Args:</span>
<span class="sd">      filename: A string, the filename for the document.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML to be spliced inside an HTML template.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">filename</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_event_type">
<code class="highlight language-python">
render_event_type<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_event_type" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render an event type.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>event</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the even type.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML to be spliced inside an HTML template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>103
104
105
106
107
108
109
110
111</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_event_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="sd">"""Render an event type.</span>

<span class="sd">    Args:</span>
<span class="sd">      event: A string, the name of the even type.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML to be spliced inside an HTML template.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">event</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_inventory">
<code class="highlight language-python">
render_inventory<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inv</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_inventory" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render an inventory.</p>
<p>You can use this opportunity to convert the inventory to units or cost
or whatever.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>inv</code></td>
<td><code></code></td>
<td>
<p>An Inventory instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML to be spliced inside a table cell.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>59
60
61
62
63
64
65
66
67
68
69
70
71</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inv</span><span class="p">):</span>
    <span class="sd">"""Render an inventory.</span>

<span class="sd">    You can use this opportunity to convert the inventory to units or cost</span>
<span class="sd">    or whatever.</span>

<span class="sd">    Args:</span>
<span class="sd">      inv: An Inventory instance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML to be spliced inside a table cell.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s1">'&lt;br/&gt;'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">position_</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dformat</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">position_</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">inv</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_link">
<code class="highlight language-python">
render_link<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_link" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render a transaction link (maybe as an HTML link).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>link</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the link to render.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML to be spliced inside an HTML template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>83
84
85
86
87
88
89
90
91</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
    <span class="sd">"""Render a transaction link (maybe as an HTML link).</span>

<span class="sd">    Args:</span>
<span class="sd">      link: A string, the name of the link to render.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML to be spliced inside an HTML template.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">link</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_number">
<code class="highlight language-python">
render_number<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_number" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render a number for a currency using the formatter's display context.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A Decimal instance, the number to be rendered.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>A string, the commodity the number represent.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the formatted number to render.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>38
39
40
41
42
43
44
45
46
47</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">):</span>
    <span class="sd">"""Render a number for a currency using the formatter's display context.</span>

<span class="sd">    Args:</span>
<span class="sd">      number: A Decimal instance, the number to be rendered.</span>
<span class="sd">      currency: A string, the commodity the number represent.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the formatted number to render.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dformat</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.html_formatter.HTMLFormatter.render_source">
<code class="highlight language-python">
render_source<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meta</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.html_formatter.HTMLFormatter.render_source" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render a reference to the source file.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>meta</code></td>
<td><code></code></td>
<td>
<p>A metadata dict object.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML to be spliced inside an HTML template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/html_formatter.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>125
126
127
128
129
130
131
132
133</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meta</span><span class="p">):</span>
    <span class="sd">"""Render a reference to the source file.</span>

<span class="sd">    Args:</span>
<span class="sd">      meta: A metadata dict object.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML to be spliced inside an HTML template.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">printer</span><span class="o">.</span><span class="n">render_source</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.journal_html">
<code>journal_html</code>
<a class="headerlink" href="#beancount.reports.journal_html" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>HTML rendering routines for serving a lists of postings/entries.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.journal_html.Row">
<code>Row</code>
<a class="headerlink" href="#beancount.reports.journal_html.Row" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Row(entry, leg_postings, rowtype, extra_class, flag, description, links, amount_str, balance_str)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_html.Row.__getnewargs__">
<code class="highlight language-python">
__getnewargs__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.reports.journal_html.Row.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_html.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>427
428
429</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">'Return self as a plain tuple.  Used by copy and pickle.'</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_html.Row.__new__">
<code class="highlight language-python">
__new__<span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">leg_postings</span><span class="p">,</span> <span class="n">rowtype</span><span class="p">,</span> <span class="n">extra_class</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">links</span><span class="p">,</span> <span class="n">amount_str</span><span class="p">,</span> <span class="n">balance_str</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.journal_html.Row.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Row(entry, leg_postings, rowtype, extra_class, flag, description, links, amount_str, balance_str)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_html.Row.__repr__">
<code class="highlight language-python">
__repr__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.reports.journal_html.Row.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_html.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>419
420
421</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">'Return a nicely formatted representation string'</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.journal_html.html_entries_table">
<code class="highlight language-python">
html_entries_table<span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">txn_postings</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span> <span class="n">render_postings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_html.html_entries_table" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a list of entries into an HTML table, with no running balance.</p>
<p>This is appropriate for rendering tables of entries for postings with
multiple accounts, whereby computing the running balances makes little
sense.</p>
<p>(This function returns nothing, it write to oss as a side-effect.)</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>oss</code></td>
<td><code></code></td>
<td>
<p>A file object to write the output to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>txn_postings</code></td>
<td><code></code></td>
<td>
<p>A list of Posting or directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>formatter</code></td>
<td><code></code></td>
<td>
<p>An instance of HTMLFormatter, to be render accounts,
inventories, links and docs.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>render_postings</code></td>
<td><code></code></td>
<td>
<p>A boolean; if true, render the postings as rows under the
main transaction row.</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_html.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">html_entries_table</span><span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">txn_postings</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span> <span class="n">render_postings</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">"""Render a list of entries into an HTML table, with no running balance.</span>

<span class="sd">    This is appropriate for rendering tables of entries for postings with</span>
<span class="sd">    multiple accounts, whereby computing the running balances makes little</span>
<span class="sd">    sense.</span>

<span class="sd">    (This function returns nothing, it write to oss as a side-effect.)</span>

<span class="sd">    Args:</span>
<span class="sd">      oss: A file object to write the output to.</span>
<span class="sd">      txn_postings: A list of Posting or directive instances.</span>
<span class="sd">      formatter: An instance of HTMLFormatter, to be render accounts,</span>
<span class="sd">        inventories, links and docs.</span>
<span class="sd">      render_postings: A boolean; if true, render the postings as rows under the</span>
<span class="sd">        main transaction row.</span>
<span class="sd">    """</span>
    <span class="n">write</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="p">(</span><span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">))</span>

    <span class="n">write</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">      &lt;table class="entry-table"&gt;</span>
<span class="s1">      &lt;thead&gt;</span>
<span class="s1">        &lt;tr&gt;</span>
<span class="s1">         &lt;th class="datecell"&gt;Date&lt;/th&gt;</span>
<span class="s1">         &lt;th class="flag"&gt;F&lt;/th&gt;</span>
<span class="s1">         &lt;th class="description"&gt;Narration/Payee&lt;/th&gt;</span>
<span class="s1">         &lt;th class="amount"&gt;Amount&lt;/th&gt;</span>
<span class="s1">         &lt;th class="cost"&gt;Cost&lt;/th&gt;</span>
<span class="s1">         &lt;th class="price"&gt;Price&lt;/th&gt;</span>
<span class="s1">         &lt;th class="balance"&gt;Balance&lt;/th&gt;</span>
<span class="s1">        &lt;/tr&gt;</span>
<span class="s1">      &lt;/thead&gt;</span>
<span class="s1">    '''</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">iterate_html_postings</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">,</span> <span class="n">formatter</span><span class="p">):</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">entry</span>

        <span class="n">description</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">description</span>
        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">+=</span> <span class="n">render_links</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">links</span><span class="p">)</span>

        <span class="c1"># Render a row.</span>
        <span class="n">write</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">          &lt;tr class="</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">" title="</span><span class="si">{}</span><span class="s1">"&gt;</span>
<span class="s1">            &lt;td class="datecell"&gt;&lt;a href="</span><span class="si">{}</span><span class="s1">"&gt;</span><span class="si">{}</span><span class="s1">&lt;/a&gt;&lt;/td&gt;</span>
<span class="s1">            &lt;td class="flag"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">            &lt;td class="description" colspan="5"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">          &lt;/tr&gt;</span>
<span class="s1">        '''</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">rowtype</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">extra_class</span><span class="p">,</span>
                   <span class="s1">'</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">"filename"</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">"lineno"</span><span class="p">]),</span>
                   <span class="n">formatter</span><span class="o">.</span><span class="n">render_context</span><span class="p">(</span><span class="n">entry</span><span class="p">),</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
                   <span class="n">row</span><span class="o">.</span><span class="n">flag</span><span class="p">,</span> <span class="n">description</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">render_postings</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>

                <span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Posting'</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">flag</span> <span class="o">==</span> <span class="n">flags</span><span class="o">.</span><span class="n">FLAG_WARNING</span><span class="p">:</span>
                    <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'warning'</span><span class="p">)</span>

                <span class="n">write</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">                  &lt;tr class="</span><span class="si">{}</span><span class="s1">"&gt;</span>
<span class="s1">                    &lt;td class="datecell"&gt;&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="flag"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="description"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="amount num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="cost num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="price num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="balance num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                  &lt;/tr&gt;</span>
<span class="s1">                '''</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">classes</span><span class="p">),</span>
                           <span class="n">posting</span><span class="o">.</span><span class="n">flag</span> <span class="ow">or</span> <span class="s1">''</span><span class="p">,</span>
                           <span class="n">formatter</span><span class="o">.</span><span class="n">render_account</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">),</span>
                           <span class="n">posting</span><span class="o">.</span><span class="n">units</span> <span class="ow">or</span> <span class="s1">''</span><span class="p">,</span>
                           <span class="n">posting</span><span class="o">.</span><span class="n">cost</span> <span class="ow">or</span> <span class="s1">''</span><span class="p">,</span>
                           <span class="n">posting</span><span class="o">.</span><span class="n">price</span> <span class="ow">or</span> <span class="s1">''</span><span class="p">,</span>
                           <span class="n">convert</span><span class="o">.</span><span class="n">get_weight</span><span class="p">(</span><span class="n">posting</span><span class="p">)))</span>

    <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/table&gt;'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.journal_html.html_entries_table_with_balance">
<code class="highlight language-python">
html_entries_table_with_balance<span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">txn_postings</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span> <span class="n">render_postings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_html.html_entries_table_with_balance" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a list of entries into an HTML table, with a running balance.</p>
<p>(This function returns nothing, it write to oss as a side-effect.)</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>oss</code></td>
<td><code></code></td>
<td>
<p>A file object to write the output to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>txn_postings</code></td>
<td><code></code></td>
<td>
<p>A list of Posting or directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>formatter</code></td>
<td><code></code></td>
<td>
<p>An instance of HTMLFormatter, to be render accounts,
inventories, links and docs.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>render_postings</code></td>
<td><code></code></td>
<td>
<p>A boolean; if true, render the postings as rows under the
main transaction row.</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_html.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">html_entries_table_with_balance</span><span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">txn_postings</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span> <span class="n">render_postings</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">"""Render a list of entries into an HTML table, with a running balance.</span>

<span class="sd">    (This function returns nothing, it write to oss as a side-effect.)</span>

<span class="sd">    Args:</span>
<span class="sd">      oss: A file object to write the output to.</span>
<span class="sd">      txn_postings: A list of Posting or directive instances.</span>
<span class="sd">      formatter: An instance of HTMLFormatter, to be render accounts,</span>
<span class="sd">        inventories, links and docs.</span>
<span class="sd">      render_postings: A boolean; if true, render the postings as rows under the</span>
<span class="sd">        main transaction row.</span>
<span class="sd">    """</span>
    <span class="n">write</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="p">(</span><span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">))</span>

    <span class="n">write</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">      &lt;table class="entry-table"&gt;</span>
<span class="s1">      &lt;thead&gt;</span>
<span class="s1">        &lt;tr&gt;</span>
<span class="s1">         &lt;th class="datecell"&gt;Date&lt;/th&gt;</span>
<span class="s1">         &lt;th class="flag"&gt;F&lt;/th&gt;</span>
<span class="s1">         &lt;th class="description"&gt;Narration/Payee&lt;/th&gt;</span>
<span class="s1">         &lt;th class="position"&gt;Position&lt;/th&gt;</span>
<span class="s1">         &lt;th class="price"&gt;Price&lt;/th&gt;</span>
<span class="s1">         &lt;th class="cost"&gt;Cost&lt;/th&gt;</span>
<span class="s1">         &lt;th class="change"&gt;Change&lt;/th&gt;</span>
<span class="s1">         &lt;th class="balance"&gt;Balance&lt;/th&gt;</span>
<span class="s1">        &lt;/tr&gt;</span>
<span class="s1">      &lt;/thead&gt;</span>
<span class="s1">    '''</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">iterate_html_postings</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">,</span> <span class="n">formatter</span><span class="p">):</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">entry</span>

        <span class="n">description</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">description</span>
        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">+=</span> <span class="n">render_links</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">links</span><span class="p">)</span>

        <span class="c1"># Render a row.</span>
        <span class="n">write</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">          &lt;tr class="</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">" title="</span><span class="si">{}</span><span class="s1">"&gt;</span>
<span class="s1">            &lt;td class="datecell"&gt;&lt;a href="</span><span class="si">{}</span><span class="s1">"&gt;</span><span class="si">{}</span><span class="s1">&lt;/a&gt;&lt;/td&gt;</span>
<span class="s1">            &lt;td class="flag"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">            &lt;td class="description" colspan="4"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">            &lt;td class="change num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">            &lt;td class="balance num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">          &lt;/tr&gt;</span>
<span class="s1">        '''</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">rowtype</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">extra_class</span><span class="p">,</span>
                   <span class="s1">'</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">"filename"</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">"lineno"</span><span class="p">]),</span>
                   <span class="n">formatter</span><span class="o">.</span><span class="n">render_context</span><span class="p">(</span><span class="n">entry</span><span class="p">),</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
                   <span class="n">row</span><span class="o">.</span><span class="n">flag</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span>
                   <span class="n">row</span><span class="o">.</span><span class="n">amount_str</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">balance_str</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">render_postings</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>

                <span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Posting'</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">flag</span> <span class="o">==</span> <span class="n">flags</span><span class="o">.</span><span class="n">FLAG_WARNING</span><span class="p">:</span>
                    <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'warning'</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">leg_postings</span><span class="p">:</span>
                    <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'leg'</span><span class="p">)</span>

                <span class="n">write</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">                  &lt;tr class="</span><span class="si">{}</span><span class="s1">"&gt;</span>
<span class="s1">                    &lt;td class="datecell"&gt;&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="flag"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="description"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="position num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="price num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="cost num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="change num"&gt;&lt;/td&gt;</span>
<span class="s1">                    &lt;td class="balance num"&gt;&lt;/td&gt;</span>
<span class="s1">                  &lt;/tr&gt;</span>
<span class="s1">                '''</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">classes</span><span class="p">),</span>
                           <span class="n">posting</span><span class="o">.</span><span class="n">flag</span> <span class="ow">or</span> <span class="s1">''</span><span class="p">,</span>
                           <span class="n">formatter</span><span class="o">.</span><span class="n">render_account</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">),</span>
                           <span class="n">position</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">posting</span><span class="p">),</span>
                           <span class="n">posting</span><span class="o">.</span><span class="n">price</span> <span class="ow">or</span> <span class="s1">''</span><span class="p">,</span>
                           <span class="n">convert</span><span class="o">.</span><span class="n">get_weight</span><span class="p">(</span><span class="n">posting</span><span class="p">)))</span>

    <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/table&gt;'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.journal_html.iterate_html_postings">
<code class="highlight language-python">
iterate_html_postings<span class="p">(</span><span class="n">txn_postings</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_html.iterate_html_postings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Iterate through the list of transactions with rendered HTML strings for each cell.</p>
<p>This pre-renders all the data for each row to HTML. This is reused by the entries
table rendering routines.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>txn_postings</code></td>
<td><code></code></td>
<td>
<p>A list of TxnPosting or directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>formatter</code></td>
<td><code></code></td>
<td>
<p>An instance of HTMLFormatter, to be render accounts,
inventories, links and docs.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  Instances of Row tuples. See above.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_html.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">iterate_html_postings</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">,</span> <span class="n">formatter</span><span class="p">):</span>
    <span class="sd">"""Iterate through the list of transactions with rendered HTML strings for each cell.</span>

<span class="sd">    This pre-renders all the data for each row to HTML. This is reused by the entries</span>
<span class="sd">    table rendering routines.</span>

<span class="sd">    Args:</span>
<span class="sd">      txn_postings: A list of TxnPosting or directive instances.</span>
<span class="sd">      formatter: An instance of HTMLFormatter, to be render accounts,</span>
<span class="sd">        inventories, links and docs.</span>
<span class="sd">    Yields:</span>
<span class="sd">      Instances of Row tuples. See above.</span>
<span class="sd">    """</span>
    <span class="k">for</span> <span class="n">entry_line</span> <span class="ow">in</span> <span class="n">realization</span><span class="o">.</span><span class="n">iterate_with_balance</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">):</span>
        <span class="n">entry</span><span class="p">,</span> <span class="n">leg_postings</span><span class="p">,</span> <span class="n">change</span><span class="p">,</span> <span class="n">entry_balance</span> <span class="o">=</span> <span class="n">entry_line</span>

        <span class="c1"># Prepare the data to be rendered for this row.</span>
        <span class="n">balance_str</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">.</span><span class="n">render_inventory</span><span class="p">(</span><span class="n">entry_balance</span><span class="p">)</span>

        <span class="n">rowtype</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="s1">''</span>
        <span class="n">extra_class</span> <span class="o">=</span> <span class="s1">''</span>
        <span class="n">links</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">):</span>
            <span class="n">rowtype</span> <span class="o">=</span> <span class="n">FLAG_ROWTYPES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">flag</span><span class="p">,</span> <span class="s1">'Transaction'</span><span class="p">)</span>
            <span class="n">extra_class</span> <span class="o">=</span> <span class="s1">'warning'</span> <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">flag</span> <span class="o">==</span> <span class="n">flags</span><span class="o">.</span><span class="n">FLAG_WARNING</span> <span class="k">else</span> <span class="s1">''</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">flag</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">'&lt;span class="narration"&gt;</span><span class="si">{}</span><span class="s1">&lt;/span&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">narration</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">payee</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'&lt;span class="payee"&gt;</span><span class="si">{}</span><span class="s1">&lt;/span&gt;'</span>
                               <span class="s1">'&lt;span class="pnsep"&gt;|&lt;/span&gt;'</span>
                               <span class="s1">'</span><span class="si">{}</span><span class="s1">'</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">payee</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
            <span class="n">amount_str</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">.</span><span class="n">render_inventory</span><span class="p">(</span><span class="n">change</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">links</span> <span class="ow">and</span> <span class="n">formatter</span><span class="p">:</span>
                <span class="n">links</span> <span class="o">=</span> <span class="p">[</span><span class="n">formatter</span><span class="o">.</span><span class="n">render_link</span><span class="p">(</span><span class="n">link</span><span class="p">)</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">links</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Balance</span><span class="p">):</span>
            <span class="c1"># Check the balance here and possibly change the rowtype</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">diff_amount</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">'Balance </span><span class="si">{}</span><span class="s1"> has </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">formatter</span><span class="o">.</span><span class="n">render_account</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">),</span>
                    <span class="n">entry</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'Balance in </span><span class="si">{}</span><span class="s1"> fails; '</span>
                               <span class="s1">'expected = </span><span class="si">{}</span><span class="s1">, balance = </span><span class="si">{}</span><span class="s1">, difference = </span><span class="si">{}</span><span class="s1">'</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                   <span class="n">formatter</span><span class="o">.</span><span class="n">render_account</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">),</span>
                                   <span class="n">entry</span><span class="o">.</span><span class="n">amount</span><span class="p">,</span>
                                   <span class="n">entry_balance</span><span class="o">.</span><span class="n">get_currency_units</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">),</span>
                                   <span class="n">entry</span><span class="o">.</span><span class="n">diff_amount</span><span class="p">)</span>
                <span class="n">extra_class</span> <span class="o">=</span> <span class="s1">'fail'</span>

            <span class="n">amount_str</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">.</span><span class="n">render_amount</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Open</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Close</span><span class="p">)):</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                                         <span class="n">formatter</span><span class="o">.</span><span class="n">render_account</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">))</span>
            <span class="n">amount_str</span> <span class="o">=</span> <span class="s1">''</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Note</span><span class="p">):</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">comment</span><span class="p">)</span>
            <span class="n">amount_str</span> <span class="o">=</span> <span class="s1">''</span>
            <span class="n">balance_str</span> <span class="o">=</span> <span class="s1">''</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Document</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">'Document for </span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">formatter</span><span class="o">.</span><span class="n">render_account</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">),</span>
                <span class="n">formatter</span><span class="o">.</span><span class="n">render_doc</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">filename</span><span class="p">))</span>
            <span class="n">amount_str</span> <span class="o">=</span> <span class="s1">''</span>
            <span class="n">balance_str</span> <span class="o">=</span> <span class="s1">''</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">amount_str</span> <span class="o">=</span> <span class="s1">''</span>
            <span class="n">balance_str</span> <span class="o">=</span> <span class="s1">''</span>

        <span class="k">yield</span> <span class="n">Row</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">leg_postings</span><span class="p">,</span>
                  <span class="n">rowtype</span><span class="p">,</span> <span class="n">extra_class</span><span class="p">,</span>
                  <span class="n">flag</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">links</span><span class="p">,</span> <span class="n">amount_str</span><span class="p">,</span> <span class="n">balance_str</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.journal_html.render_links">
<code class="highlight language-python">
render_links<span class="p">(</span><span class="n">links</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_html.render_links" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render Transaction links to HTML.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>links</code></td>
<td><code></code></td>
<td>
<p>A list of set of strings, transaction "links" to be rendered.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, a snippet of HTML to be rendering somewhere.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_html.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>292
293
294
295
296
297
298
299
300
301
302</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_links</span><span class="p">(</span><span class="n">links</span><span class="p">):</span>
    <span class="sd">"""Render Transaction links to HTML.</span>

<span class="sd">    Args:</span>
<span class="sd">      links: A list of set of strings, transaction "links" to be rendered.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, a snippet of HTML to be rendering somewhere.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s1">'&lt;span class="links"&gt;</span><span class="si">{}</span><span class="s1">&lt;/span&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'&lt;a href="</span><span class="si">{}</span><span class="s1">"&gt;^&lt;/a&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.journal_html_test">
<code>journal_html_test</code>
<a class="headerlink" href="#beancount.reports.journal_html_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.journal_html_test.TestJournalRender">
<code>TestJournalRender</code>
<a class="headerlink" href="#beancount.reports.journal_html_test.TestJournalRender" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_html_test.TestJournalRender.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_html_test.TestJournalRender.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_html_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@loader</span><span class="o">.</span><span class="n">load_doc</span><span class="p">(</span><span class="n">expect_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    2014-01-01 open Assets:Checking</span>
<span class="sd">    2014-01-01 open Assets:Investing</span>
<span class="sd">    2014-01-01 open Assets:Savings</span>
<span class="sd">    2014-01-01 open Income:MountainOfMoney</span>
<span class="sd">    2014-01-01 open Equity:Opening-Balances</span>
<span class="sd">    2014-01-01 open Assets:Investing:Cash</span>
<span class="sd">    2014-01-01 open Assets:Investing:Stock</span>

<span class="sd">    2014-01-05 pad Assets:Checking Equity:Opening-Balances</span>

<span class="sd">    2014-02-10 balance Assets:Checking   100.00 USD</span>

<span class="sd">    2014-03-04 ! "Salary"</span>
<span class="sd">      Income:MountainOfMoney    -4000.00 USD</span>
<span class="sd">      Assets:Checking</span>

<span class="sd">    2014-03-05 balance Assets:Checking   4100.00 USD</span>

<span class="sd">    2014-03-10 note Assets:Checking "Something to say"</span>
<span class="sd">    2014-03-11 document Assets:Checking "/path/to/document.pdf"</span>

<span class="sd">    ;; With link.</span>
<span class="sd">    2014-03-17 * "Transfer" ^784375fd5a68</span>
<span class="sd">      Assets:Checking          -2000 USD</span>
<span class="sd">      Assets:Checking          -1500 USD</span>
<span class="sd">      Assets:Investing:Cash     3500 USD</span>

<span class="sd">    2014-03-25 * "Investment"</span>
<span class="sd">      Assets:Investing:Cash      -3000 USD</span>
<span class="sd">      Assets:Investing:Stock        30 STOCK {100 USD}</span>

<span class="sd">    ;; Failing.</span>
<span class="sd">    2014-05-01 balance  Assets:Checking   0.00 USD</span>

<span class="sd">    2014-12-31 close Assets:Checking</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
    <span class="n">real_root</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">realize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">real_account</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="s1">'Assets:Checking'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.journal_reports">
<code>journal_reports</code>
<a class="headerlink" href="#beancount.reports.journal_reports" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Report classes for all reports that display ending journals of accounts.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.journal_reports.ConversionsReport">
<code>ConversionsReport</code>
<a class="headerlink" href="#beancount.reports.journal_reports.ConversionsReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out a report of all conversions.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.journal_reports.DocumentsReport">
<code>DocumentsReport</code>
<a class="headerlink" href="#beancount.reports.journal_reports.DocumentsReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out a report of documents.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.journal_reports.JournalReport">
<code>JournalReport</code>
<a class="headerlink" href="#beancount.reports.journal_reports.JournalReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out an account register/journal.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_reports.JournalReport.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.journal_reports.JournalReport.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-a'</span><span class="p">,</span> <span class="s1">'--account'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Account to render"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-w'</span><span class="p">,</span> <span class="s1">'--width'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"The number of characters wide to render the report to"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-k'</span><span class="p">,</span> <span class="s1">'--precision'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"The number of digits to render after the period"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-b'</span><span class="p">,</span> <span class="s1">'--render-balance'</span><span class="p">,</span> <span class="s1">'--balance'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Render a running balance, not just changes"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-c'</span><span class="p">,</span> <span class="s1">'--at-cost'</span><span class="p">,</span> <span class="s1">'--cost'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Render values at cost, convert the units to cost value"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-x'</span><span class="p">,</span> <span class="s1">'--compact'</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">'verbosity'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_const'</span><span class="p">,</span>
                        <span class="n">const</span><span class="o">=</span><span class="n">journal_text</span><span class="o">.</span><span class="n">COMPACT</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">journal_text</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Rendering compactly"</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-X'</span><span class="p">,</span> <span class="s1">'--verbose'</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">'verbosity'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_const'</span><span class="p">,</span>
                        <span class="n">const</span><span class="o">=</span><span class="n">journal_text</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Rendering verbosely"</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_reports.JournalReport.get_postings">
<code class="highlight language-python">
get_postings<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real_root</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_reports.JournalReport.get_postings" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the postings corresponding to the account filter option.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>A RealAccount node for the root of all accounts.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of posting or directive instances.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_postings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real_root</span><span class="p">):</span>
    <span class="sd">"""Return the postings corresponding to the account filter option.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_root: A RealAccount node for the root of all accounts.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of posting or directive instances.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">account</span><span class="p">:</span>
        <span class="n">real_account</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">account</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">real_account</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># If the account isn't found, return an empty list of postings.</span>
            <span class="c1"># Note that this used to return the following error.</span>
            <span class="c1"># raise base.ReportError(</span>
            <span class="c1">#     "Invalid account name: {}".format(self.args.account))</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">real_account</span> <span class="o">=</span> <span class="n">real_root</span>

    <span class="k">return</span> <span class="n">realization</span><span class="o">.</span><span class="n">get_postings</span><span class="p">(</span><span class="n">real_account</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_reports.JournalReport.render_real_html">
<code class="highlight language-python">
render_real_html<span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_reports.JournalReport.render_real_html" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Wrap an htmldiv into our standard HTML template.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price database.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_date</code></td>
<td><code></code></td>
<td>
<p>A date for evaluating prices.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict, options as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>A file object to write the output to.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>237
238
239
240
241
242
243
244
245
246
247
248
249
250
251</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_real_html</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">"""Wrap an htmldiv into our standard HTML template.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_root: An instance of RealAccount.</span>
<span class="sd">      price_map: A price database.</span>
<span class="sd">      price_date: A date for evaluating prices.</span>
<span class="sd">      options_map: A dict, options as produced by the parser.</span>
<span class="sd">      file: A file object to write the output to.</span>
<span class="sd">    """</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">get_html_template</span><span class="p">()</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">render_real_htmldiv</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">oss</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span>
                               <span class="n">title</span><span class="o">=</span><span class="s1">''</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.journal_text">
<code>journal_text</code>
<a class="headerlink" href="#beancount.reports.journal_text" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Text rendering routines for serving a lists of postings/entries.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.journal_text.AmountColumnSizer">
<code>AmountColumnSizer</code>
<a class="headerlink" href="#beancount.reports.journal_text.AmountColumnSizer" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A class that computes minimal sizes for columns of numbers and their currencies.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_text.AmountColumnSizer.get_format">
<code class="highlight language-python">
get_format<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_text.AmountColumnSizer.get_format" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a format string for the column of numbers.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>precision</code></td>
<td><code></code></td>
<td>
<p>An integer, the number of digits to render after the period.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new-style Python format string, with PREFIX_number and PREFIX_currency named
fields.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_text.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>79
80
81
82
83
84
85
86
87
88
89
90
91</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision</span><span class="p">):</span>
    <span class="sd">"""Return a format string for the column of numbers.</span>

<span class="sd">    Args:</span>
<span class="sd">      precision: An integer, the number of digits to render after the period.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new-style Python format string, with PREFIX_number and PREFIX_currency named</span>
<span class="sd">      fields.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">'{{0:&gt;</span><span class="si">{width:d}</span><span class="s1">.</span><span class="si">{precision:d}</span><span class="s1">f}} {{1:&lt;</span><span class="si">{currency_width}</span><span class="s1">}}'</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_number_width</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">precision</span><span class="p">,</span>
        <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span>
        <span class="n">currency_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_currency_width</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_text.AmountColumnSizer.get_generic_format">
<code class="highlight language-python">
get_generic_format<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_text.AmountColumnSizer.get_generic_format" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a generic format string for rendering as wide as required.
This can be used to render an empty string in-lieu of a number.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>precision</code></td>
<td><code></code></td>
<td>
<p>An integer, the number of digits to render after the period.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new-style Python format string, with PREFIX_number and PREFIX_currency named
fields.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_text.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>65
66
67
68
69
70
71
72
73
74
75
76
77</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_generic_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision</span><span class="p">):</span>
    <span class="sd">"""Return a generic format string for rendering as wide as required.</span>
<span class="sd">    This can be used to render an empty string in-lieu of a number.</span>

<span class="sd">    Args:</span>
<span class="sd">      precision: An integer, the number of digits to render after the period.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new-style Python format string, with PREFIX_number and PREFIX_currency named</span>
<span class="sd">      fields.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s1">'{{</span><span class="si">{prefix}</span><span class="s1">:&lt;</span><span class="si">{width}</span><span class="s1">}}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_number_width</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">precision</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_currency_width</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_text.AmountColumnSizer.get_number_width">
<code class="highlight language-python">
get_number_width<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_text.AmountColumnSizer.get_number_width" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the width of the integer part of the max number.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An integer, the number of digits required to render the integral part.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_text.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>55
56
57
58
59
60
61
62
63</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_number_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""Return the width of the integer part of the max number.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An integer, the number of digits required to render the integral part.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_number</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_number</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_text.AmountColumnSizer.update">
<code class="highlight language-python">
update<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_text.AmountColumnSizer.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Update the sizer with the given number and currency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A Decimal instance.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>A string, the currency to render for it.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_text.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>41
42
43
44
45
46
47
48
49
50
51
52
53</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">):</span>
    <span class="sd">"""Update the sizer with the given number and currency.</span>

<span class="sd">    Args:</span>
<span class="sd">      number: A Decimal instance.</span>
<span class="sd">      currency: A string, the currency to render for it.</span>
<span class="sd">    """</span>
    <span class="n">abs_number</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">abs_number</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_number</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_number</span> <span class="o">=</span> <span class="n">abs_number</span>
    <span class="n">currency_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">currency</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">currency_width</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_currency_width</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_currency_width</span> <span class="o">=</span> <span class="n">currency_width</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.journal_text.get_entry_text_description">
<code class="highlight language-python">
get_entry_text_description<span class="p">(</span><span class="n">entry</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_text.get_entry_text_description" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the text of a description.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>A directive, of any type.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string to use for the filling the description field in text reports.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_text.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_entry_text_description</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">"""Return the text of a description.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: A directive, of any type.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string to use for the filling the description field in text reports.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">):</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">' | '</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">field</span>
                                  <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">payee</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">narration</span><span class="p">]</span>
                                  <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Balance</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">diff_amount</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s1">'PASS - In </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'FAIL - In </span><span class="si">{}</span><span class="s1">; '</span>
                           <span class="s1">'expected = </span><span class="si">{}</span><span class="s1">, difference = </span><span class="si">{}</span><span class="s1">'</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                               <span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">,</span>
                               <span class="n">entry</span><span class="o">.</span><span class="n">amount</span><span class="p">,</span>
                               <span class="n">entry</span><span class="o">.</span><span class="n">diff_amount</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Open</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Close</span><span class="p">)):</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">account</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Note</span><span class="p">):</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">comment</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Document</span><span class="p">):</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">filename</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">'-'</span>
    <span class="k">return</span> <span class="n">description</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.journal_text.render_posting">
<code class="highlight language-python">
render_posting<span class="p">(</span><span class="n">posting</span><span class="p">,</span> <span class="n">number_format</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_text.render_posting" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a posting compactly, for text report rendering.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>posting</code></td>
<td><code></code></td>
<td>
<p>An instance of Posting.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered posting.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_text.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_posting</span><span class="p">(</span><span class="n">posting</span><span class="p">,</span> <span class="n">number_format</span><span class="p">):</span>
    <span class="sd">"""Render a posting compactly, for text report rendering.</span>

<span class="sd">    Args:</span>
<span class="sd">      posting: An instance of Posting.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the rendered posting.</span>
<span class="sd">    """</span>
    <span class="c1"># Note: there's probably no need to redo the work of rendering here... see</span>
    <span class="c1"># if you can't just simply replace this by Position.to_string().</span>

    <span class="n">units</span> <span class="o">=</span> <span class="n">posting</span><span class="o">.</span><span class="n">units</span>
    <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">posting</span><span class="o">.</span><span class="n">flag</span> <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">flag</span> <span class="k">else</span> <span class="s1">' '</span><span class="p">,</span>
        <span class="s1">'</span><span class="si">{:32}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">),</span>
        <span class="n">number_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="n">cost</span> <span class="o">=</span> <span class="n">posting</span><span class="o">.</span><span class="n">cost</span>
    <span class="k">if</span> <span class="n">cost</span><span class="p">:</span>
        <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'{{</span><span class="si">{}</span><span class="s1">}}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
                                                            <span class="n">cost</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>

    <span class="n">price</span> <span class="o">=</span> <span class="n">posting</span><span class="o">.</span><span class="n">price</span>
    <span class="k">if</span> <span class="n">price</span><span class="p">:</span>
        <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'@ </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">price</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
                                                          <span class="n">price</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>

    <span class="k">return</span> <span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.journal_text.size_and_render_amounts">
<code class="highlight language-python">
size_and_render_amounts<span class="p">(</span><span class="n">postings</span><span class="p">,</span> <span class="n">at_cost</span><span class="p">,</span> <span class="n">render_balance</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_text.size_and_render_amounts" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Iterate through postings and compute sizers and render amounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>postings</code></td>
<td><code></code></td>
<td>
<p>A list of Posting or directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>at_cost</code></td>
<td><code></code></td>
<td>
<p>A boolean, if true, render the cost value, not the actual.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>render_balance</code></td>
<td><code></code></td>
<td>
<p>A boolean, if true, renders a running balance column.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_text.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">size_and_render_amounts</span><span class="p">(</span><span class="n">postings</span><span class="p">,</span> <span class="n">at_cost</span><span class="p">,</span> <span class="n">render_balance</span><span class="p">):</span>
    <span class="sd">"""Iterate through postings and compute sizers and render amounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      postings: A list of Posting or directive instances.</span>
<span class="sd">      at_cost: A boolean, if true, render the cost value, not the actual.</span>
<span class="sd">      render_balance: A boolean, if true, renders a running balance column.</span>
<span class="sd">    """</span>

    <span class="c1"># Compute the maximum width required to render the change and balance</span>
    <span class="c1"># columns. In order to carry this out, we will pre-compute all the data to</span>
    <span class="c1"># render this and save it for later.</span>
    <span class="n">change_sizer</span> <span class="o">=</span> <span class="n">AmountColumnSizer</span><span class="p">(</span><span class="s1">'change'</span><span class="p">)</span>
    <span class="n">balance_sizer</span> <span class="o">=</span> <span class="n">AmountColumnSizer</span><span class="p">(</span><span class="s1">'balance'</span><span class="p">)</span>

    <span class="n">entry_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">entry_line</span> <span class="ow">in</span> <span class="n">realization</span><span class="o">.</span><span class="n">iterate_with_balance</span><span class="p">(</span><span class="n">postings</span><span class="p">):</span>
        <span class="n">entry</span><span class="p">,</span> <span class="n">leg_postings</span><span class="p">,</span> <span class="n">change</span><span class="p">,</span> <span class="n">balance</span> <span class="o">=</span> <span class="n">entry_line</span>

        <span class="c1"># Convert to cost if necessary. (Note that this agglutinates currencies,</span>
        <span class="c1"># so we'd rather do make the conversion at this level (inventory) than</span>
        <span class="c1"># convert the positions or amounts later.)</span>
        <span class="k">if</span> <span class="n">at_cost</span><span class="p">:</span>
            <span class="n">change</span> <span class="o">=</span> <span class="n">change</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">convert</span><span class="o">.</span><span class="n">get_cost</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">render_balance</span><span class="p">:</span>
                <span class="n">balance</span> <span class="o">=</span> <span class="n">balance</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">convert</span><span class="o">.</span><span class="n">get_cost</span><span class="p">)</span>

        <span class="c1"># Compute the amounts and maximum widths for the change column.</span>
        <span class="n">change_amounts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">change</span><span class="o">.</span><span class="n">get_positions</span><span class="p">():</span>
            <span class="n">units</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">units</span>
            <span class="n">change_amounts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
            <span class="n">change_sizer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>

        <span class="c1"># Compute the amounts and maximum widths for the balance column.</span>
        <span class="n">balance_amounts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">render_balance</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">balance</span><span class="o">.</span><span class="n">get_positions</span><span class="p">():</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">units</span>
                <span class="n">balance_amounts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
                <span class="n">balance_sizer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>

        <span class="n">entry_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">entry</span><span class="p">,</span> <span class="n">leg_postings</span><span class="p">,</span> <span class="n">change_amounts</span><span class="p">,</span> <span class="n">balance_amounts</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">entry_data</span><span class="p">,</span> <span class="n">change_sizer</span><span class="p">,</span> <span class="n">balance_sizer</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.journal_text.text_entries_table">
<code class="highlight language-python">
text_entries_table<span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">postings</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">at_cost</span><span class="p">,</span> <span class="n">render_balance</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">,</span> <span class="n">output_format</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_text.text_entries_table" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of postings or directives with an accumulated balance.</p>
<p>This function has three verbosity modes for rendering:
1. COMPACT: no separating line, no postings
2. NORMAL: a separating line between entries, no postings
3. VERBOSE: renders all the postings in addition to normal.</p>
<p>The output is written to the 'oss' file object. Nothing is returned.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>oss</code></td>
<td><code></code></td>
<td>
<p>A file object to write the output to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>postings</code></td>
<td><code></code></td>
<td>
<p>A list of Posting or directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>width</code></td>
<td><code></code></td>
<td>
<p>An integer, the width to render the table to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>at_cost</code></td>
<td><code></code></td>
<td>
<p>A boolean, if true, render the cost value, not the actual.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>render_balance</code></td>
<td><code></code></td>
<td>
<p>A boolean, if true, renders a running balance column.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>precision</code></td>
<td><code></code></td>
<td>
<p>An integer, the number of digits to render after the period.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>verbosity</code></td>
<td><code></code></td>
<td>
<p>An integer, the verbosity level. See COMPACT, NORMAL, VERBOSE, etc.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>output_format</code></td>
<td><code></code></td>
<td>
<p>A string, either 'text' or 'csv' for the chosen output format.
This routine's inner loop calculations are complex enough it gets reused by both
formats.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>If the width is insufficient to render the description.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_text.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">text_entries_table</span><span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">postings</span><span class="p">,</span>
                       <span class="n">width</span><span class="p">,</span> <span class="n">at_cost</span><span class="p">,</span> <span class="n">render_balance</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">,</span>
                       <span class="n">output_format</span><span class="p">):</span>
    <span class="sd">"""Render a table of postings or directives with an accumulated balance.</span>

<span class="sd">    This function has three verbosity modes for rendering:</span>
<span class="sd">    1. COMPACT: no separating line, no postings</span>
<span class="sd">    2. NORMAL: a separating line between entries, no postings</span>
<span class="sd">    3. VERBOSE: renders all the postings in addition to normal.</span>

<span class="sd">    The output is written to the 'oss' file object. Nothing is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">      oss: A file object to write the output to.</span>
<span class="sd">      postings: A list of Posting or directive instances.</span>
<span class="sd">      width: An integer, the width to render the table to.</span>
<span class="sd">      at_cost: A boolean, if true, render the cost value, not the actual.</span>
<span class="sd">      render_balance: A boolean, if true, renders a running balance column.</span>
<span class="sd">      precision: An integer, the number of digits to render after the period.</span>
<span class="sd">      verbosity: An integer, the verbosity level. See COMPACT, NORMAL, VERBOSE, etc.</span>
<span class="sd">      output_format: A string, either 'text' or 'csv' for the chosen output format.</span>
<span class="sd">        This routine's inner loop calculations are complex enough it gets reused by both</span>
<span class="sd">        formats.</span>
<span class="sd">    Raises:</span>
<span class="sd">      ValueError: If the width is insufficient to render the description.</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="n">output_format</span> <span class="ow">in</span> <span class="p">(</span><span class="n">FORMAT_TEXT</span><span class="p">,</span> <span class="n">FORMAT_CSV</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">output_format</span> <span class="ow">is</span> <span class="n">FORMAT_CSV</span><span class="p">:</span>
        <span class="n">csv_writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">oss</span><span class="p">)</span>

    <span class="c1"># Render the changes and balances to lists of amounts and precompute sizes.</span>
    <span class="n">entry_data</span><span class="p">,</span> <span class="n">change_sizer</span><span class="p">,</span> <span class="n">balance_sizer</span> <span class="o">=</span> <span class="n">size_and_render_amounts</span><span class="p">(</span><span class="n">postings</span><span class="p">,</span>
                                                                      <span class="n">at_cost</span><span class="p">,</span>
                                                                      <span class="n">render_balance</span><span class="p">)</span>

    <span class="c1"># Render an empty line and compute the width the description should be (the</span>
    <span class="c1"># description is the only elastic field).</span>
    <span class="n">empty_format</span> <span class="o">=</span> <span class="s1">'{{date:10}} {{dirtype:5}} {{description}}  </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">change_sizer</span><span class="o">.</span><span class="n">get_generic_format</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">render_balance</span><span class="p">:</span>
        <span class="n">empty_format</span> <span class="o">+=</span> <span class="s1">'  </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">balance_sizer</span><span class="o">.</span><span class="n">get_generic_format</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
    <span class="n">empty_line</span> <span class="o">=</span> <span class="n">empty_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">dirtype</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span>
                                     <span class="n">change</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">balance</span><span class="o">=</span><span class="s1">''</span><span class="p">)</span>
    <span class="n">description_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">empty_line</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">description_width</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">"Width not sufficient to render text report (</span><span class="si">{}</span><span class="s2"> chars)"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="p">))</span>

    <span class="c1"># Establish a format string for the final format of all lines.</span>
    <span class="c1"># pylint: disable=duplicate-string-formatting-argument</span>
    <span class="n">line_format</span> <span class="o">=</span> <span class="s1">'{{date:10}} {{dirtype:5}} {{description:</span><span class="si">{:d}</span><span class="s1">.</span><span class="si">{:d}</span><span class="s1">}}  </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">description_width</span><span class="p">,</span> <span class="n">description_width</span><span class="p">,</span>
        <span class="n">change_sizer</span><span class="o">.</span><span class="n">get_generic_format</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
    <span class="n">change_format</span> <span class="o">=</span> <span class="n">change_sizer</span><span class="o">.</span><span class="n">get_format</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">render_balance</span><span class="p">:</span>
        <span class="n">line_format</span> <span class="o">+=</span> <span class="s1">'  </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">balance_sizer</span><span class="o">.</span><span class="n">get_generic_format</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">balance_format</span> <span class="o">=</span> <span class="n">balance_sizer</span><span class="o">.</span><span class="n">get_format</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">line_format</span> <span class="o">+=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span>

    <span class="c1"># Iterate over all the pre-computed data.</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">leg_postings</span><span class="p">,</span> <span class="n">change_amounts</span><span class="p">,</span> <span class="n">balance_amounts</span><span class="p">)</span> <span class="ow">in</span> <span class="n">entry_data</span><span class="p">:</span>

        <span class="c1"># Render the date.</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

        <span class="c1"># Get the directive type name.</span>
        <span class="n">dirtype</span> <span class="o">=</span> <span class="n">TEXT_SHORT_NAME</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">)</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">flag</span><span class="p">:</span>
            <span class="n">dirtype</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">flag</span>

        <span class="c1"># Get the description string and split the description line in multiple</span>
        <span class="c1"># lines.</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">get_entry_text_description</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
        <span class="n">description_lines</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">description_width</span><span class="p">)</span>

        <span class="c1"># Ensure at least one line is rendered (for zip_longest).</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">description_lines</span><span class="p">:</span>
            <span class="n">description_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>

        <span class="c1"># Render all the amounts in the line.</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">description</span><span class="p">,</span>
             <span class="n">change_amount</span><span class="p">,</span>
             <span class="n">balance_amount</span><span class="p">)</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">zip_longest</span><span class="p">(</span><span class="n">description_lines</span><span class="p">,</span>
                                                      <span class="n">change_amounts</span><span class="p">,</span>
                                                      <span class="n">balance_amounts</span><span class="p">,</span>
                                                      <span class="n">fillvalue</span><span class="o">=</span><span class="s1">''</span><span class="p">):</span>

            <span class="n">change</span> <span class="o">=</span> <span class="p">(</span><span class="n">change_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">change_amount</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
                                           <span class="n">change_amount</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
                      <span class="k">if</span> <span class="n">change_amount</span>
                      <span class="k">else</span> <span class="s1">''</span><span class="p">)</span>

            <span class="n">balance</span> <span class="o">=</span> <span class="p">(</span><span class="n">balance_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">balance_amount</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
                                             <span class="n">balance_amount</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
                       <span class="k">if</span> <span class="n">balance_amount</span>
                       <span class="k">else</span> <span class="s1">''</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">description</span> <span class="ow">and</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="n">VERBOSE</span> <span class="ow">and</span> <span class="n">leg_postings</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s1">'..'</span>

            <span class="k">if</span> <span class="n">output_format</span> <span class="ow">is</span> <span class="n">FORMAT_TEXT</span><span class="p">:</span>
                <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">,</span>
                                             <span class="n">dirtype</span><span class="o">=</span><span class="n">dirtype</span><span class="p">,</span>
                                             <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                                             <span class="n">change</span><span class="o">=</span><span class="n">change</span><span class="p">,</span>
                                             <span class="n">balance</span><span class="o">=</span><span class="n">balance</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">change_number</span><span class="p">,</span> <span class="n">change_currency</span> <span class="o">=</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">''</span>
                <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
                    <span class="n">change_number</span><span class="p">,</span> <span class="n">change_currency</span> <span class="o">=</span> <span class="n">change</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">render_balance</span><span class="p">:</span>
                    <span class="n">balance_number</span><span class="p">,</span> <span class="n">balance_currency</span> <span class="o">=</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">''</span>
                    <span class="k">if</span> <span class="n">balance</span><span class="p">:</span>
                        <span class="n">balance_number</span><span class="p">,</span> <span class="n">balance_currency</span> <span class="o">=</span> <span class="n">balance</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

                    <span class="n">row</span> <span class="o">=</span> <span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">dirtype</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span>
                           <span class="n">change_number</span><span class="p">,</span> <span class="n">change_currency</span><span class="p">,</span>
                           <span class="n">balance_number</span><span class="p">,</span> <span class="n">balance_currency</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">dirtype</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span>
                           <span class="n">change_number</span><span class="p">,</span> <span class="n">change_currency</span><span class="p">)</span>
                <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

            <span class="c1"># Reset the date, directive type and description. Only the first</span>
            <span class="c1"># line renders these; the other lines render only the amounts.</span>
            <span class="k">if</span> <span class="n">date</span><span class="p">:</span>
                <span class="n">date</span> <span class="o">=</span> <span class="n">dirtype</span> <span class="o">=</span> <span class="s1">''</span>

        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="n">VERBOSE</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">leg_postings</span><span class="p">:</span>
                <span class="n">posting_str</span> <span class="o">=</span> <span class="n">render_posting</span><span class="p">(</span><span class="n">posting</span><span class="p">,</span> <span class="n">change_format</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">posting_str</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">description_width</span><span class="p">:</span>
                    <span class="n">posting_str</span> <span class="o">=</span> <span class="n">posting_str</span><span class="p">[:</span><span class="n">description_width</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s1">'...'</span>

                <span class="k">if</span> <span class="n">output_format</span> <span class="ow">is</span> <span class="n">FORMAT_TEXT</span><span class="p">:</span>
                    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span>
                                                 <span class="n">dirtype</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span>
                                                 <span class="n">description</span><span class="o">=</span><span class="n">posting_str</span><span class="p">,</span>
                                                 <span class="n">change</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span>
                                                 <span class="n">balance</span><span class="o">=</span><span class="s1">''</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">posting_str</span><span class="p">)</span>
                    <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;=</span> <span class="n">NORMAL</span><span class="p">:</span>
            <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.journal_text_test">
<code>journal_text_test</code>
<a class="headerlink" href="#beancount.reports.journal_text_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.journal_text_test.TestJournalTextRender">
<code>TestJournalTextRender</code>
<a class="headerlink" href="#beancount.reports.journal_text_test.TestJournalTextRender" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.journal_text_test.TestJournalTextRender.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.journal_text_test.TestJournalTextRender.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/journal_text_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@loader</span><span class="o">.</span><span class="n">load_doc</span><span class="p">(</span><span class="n">expect_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    plugin "beancount.plugins.implicit_prices"</span>

<span class="sd">    2014-01-01 open Assets:Checking</span>
<span class="sd">    2014-01-01 open Assets:Investing</span>
<span class="sd">    2014-01-01 open Assets:Savings</span>
<span class="sd">    2014-01-01 open Income:MountainOfMoney</span>
<span class="sd">    2014-01-01 open Equity:Opening-Balances</span>

<span class="sd">    2014-01-05 pad Assets:Checking Equity:Opening-Balances</span>

<span class="sd">    2014-02-10 balance Assets:Checking   100.00 USD</span>

<span class="sd">    2014-03-04 ! "Salary"</span>
<span class="sd">      Income:MountainOfMoney    -4000.00 USD</span>
<span class="sd">      Assets:Checking</span>

<span class="sd">    2014-03-05 balance Assets:Checking   4100.00 USD</span>

<span class="sd">    2014-03-10 note Assets:Checking "Something to say"</span>
<span class="sd">    2014-03-11 document Assets:Checking "/path/to/document.pdf"</span>

<span class="sd">    ;; With link.</span>
<span class="sd">    2014-03-17 * "Transfer" ^784375fd5a68</span>
<span class="sd">      Assets:Checking          -2000 USD</span>
<span class="sd">      Assets:Checking          -1500 USD</span>
<span class="sd">      Assets:Investing:Cash     3500 USD</span>

<span class="sd">    2014-03-25 * "Investment"</span>
<span class="sd">      Assets:Investing:Cash      -3000 USD</span>
<span class="sd">      Assets:Investing:Stock        30 STOCK {100 USD}</span>

<span class="sd">    ;; Failing.</span>
<span class="sd">    2014-05-01 balance  Assets:Checking   0.00 USD</span>

<span class="sd">    2014-12-31 close Assets:Checking</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
    <span class="n">real_root</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">realize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">real_account</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="s1">'Assets:Checking'</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">postings</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">get_postings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_account</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.misc_reports">
<code>misc_reports</code>
<a class="headerlink" href="#beancount.reports.misc_reports" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Miscellaneous report classes.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.misc_reports.AccountsReport">
<code>AccountsReport</code>
<a class="headerlink" href="#beancount.reports.misc_reports.AccountsReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out the list of all accounts.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.misc_reports.ActivityReport">
<code>ActivityReport</code>
<a class="headerlink" href="#beancount.reports.misc_reports.ActivityReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the last or recent update activity.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.misc_reports.ActivityReport.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.misc_reports.ActivityReport.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/misc_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>154
155
156
157
158
159</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-d'</span><span class="p">,</span> <span class="s1">'--cutoff'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="n">date_utils</span><span class="o">.</span><span class="n">parse_date_liberally</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"Cutoff date where we ignore whatever comes after."</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.misc_reports.ActivityReport.render_real_html">
<code class="highlight language-python">
render_real_html<span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.misc_reports.ActivityReport.render_real_html" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Wrap an htmldiv into our standard HTML template.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price database.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_date</code></td>
<td><code></code></td>
<td>
<p>A date for evaluating prices.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict, options as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>A file object to write the output to.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/misc_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>237
238
239
240
241
242
243
244
245
246
247
248
249
250
251</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_real_html</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">"""Wrap an htmldiv into our standard HTML template.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_root: An instance of RealAccount.</span>
<span class="sd">      price_map: A price database.</span>
<span class="sd">      price_date: A date for evaluating prices.</span>
<span class="sd">      options_map: A dict, options as produced by the parser.</span>
<span class="sd">      file: A file object to write the output to.</span>
<span class="sd">    """</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">get_html_template</span><span class="p">()</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">render_real_htmldiv</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">oss</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span>
                               <span class="n">title</span><span class="o">=</span><span class="s1">''</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.misc_reports.CurrentEventsReport">
<code>CurrentEventsReport</code>
<a class="headerlink" href="#beancount.reports.misc_reports.CurrentEventsReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Produce a table of the current values of all event types.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.misc_reports.CurrentEventsReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.misc_reports.CurrentEventsReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/misc_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>109
110
111
112
113
114
115
116
117</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">events</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Event</span><span class="p">):</span>
            <span class="n">events</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">type</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">description</span>
    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">([(</span><span class="n">type_</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
                               <span class="k">for</span> <span class="n">type_</span><span class="p">,</span> <span class="n">description</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">events</span><span class="o">.</span><span class="n">items</span><span class="p">())],</span>
                              <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"Type"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">render_event_type</span><span class="p">),</span>
                               <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"Description"</span><span class="p">)])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.misc_reports.ErrorReport">
<code>ErrorReport</code>
<a class="headerlink" href="#beancount.reports.misc_reports.ErrorReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Report the errors.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.misc_reports.EventsReport">
<code>EventsReport</code>
<a class="headerlink" href="#beancount.reports.misc_reports.EventsReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Produce a table of all the values of a particular event.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.misc_reports.EventsReport.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.misc_reports.EventsReport.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/misc_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>125
126
127
128
129</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-e'</span><span class="p">,</span> <span class="s1">'--expr'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"A regexp to filer on which events to display."</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.misc_reports.EventsReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.misc_reports.EventsReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/misc_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>131
132
133
134
135
136
137
138
139
140
141
142
143</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">event_entries</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Event</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">expr</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">event_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">([(</span><span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
                               <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">event_entries</span><span class="p">],</span>
                              <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"Date"</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">isoformat</span><span class="p">),</span>
                               <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"Type"</span><span class="p">),</span>
                               <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"Description"</span><span class="p">)])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.misc_reports.NoopReport">
<code>NoopReport</code>
<a class="headerlink" href="#beancount.reports.misc_reports.NoopReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Report nothing.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.misc_reports.PrintReport">
<code>PrintReport</code>
<a class="headerlink" href="#beancount.reports.misc_reports.PrintReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out the entries.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.misc_reports.StatsDirectivesReport">
<code>StatsDirectivesReport</code>
<a class="headerlink" href="#beancount.reports.misc_reports.StatsDirectivesReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render statistics on each directive type, the number of entries by type.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.misc_reports.StatsDirectivesReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.misc_reports.StatsDirectivesReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/misc_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>231
232
233
234
235
236
237
238
239
240
241
242</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">):</span>
    <span class="n">entries_by_type</span> <span class="o">=</span> <span class="n">misc_utils</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="k">lambda</span> <span class="n">entry</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                                         <span class="n">entries</span><span class="p">)</span>
    <span class="n">nb_entries_by_type</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">entries</span> <span class="ow">in</span> <span class="n">entries_by_type</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">nb_entries_by_type</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                  <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">]</span>
    <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">'~Total~'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">))))</span>

    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'Type'</span><span class="p">),</span>
                                     <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'Num Entries'</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:&gt;}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">)])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.misc_reports.StatsPostingsReport">
<code>StatsPostingsReport</code>
<a class="headerlink" href="#beancount.reports.misc_reports.StatsPostingsReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the number of postings for each account.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.misc_reports.StatsPostingsReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.misc_reports.StatsPostingsReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/misc_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>251
252
253
254
255
256
257
258
259
260
261
262
263
264
265</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">):</span>
    <span class="n">all_postings</span> <span class="o">=</span> <span class="p">[</span><span class="n">posting</span>
                    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">]</span>
    <span class="n">postings_by_account</span> <span class="o">=</span> <span class="n">misc_utils</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="k">lambda</span> <span class="n">posting</span><span class="p">:</span> <span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">,</span>
                                             <span class="n">all_postings</span><span class="p">)</span>
    <span class="n">nb_postings_by_account</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">postings</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">postings</span> <span class="ow">in</span> <span class="n">postings_by_account</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">nb_postings_by_account</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">]</span>
    <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">'~Total~'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">nb_postings_by_account</span><span class="o">.</span><span class="n">values</span><span class="p">()))))</span>

    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'Account'</span><span class="p">),</span>
                                     <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'Num Postings'</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:&gt;}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">)])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.price_reports">
<code>price_reports</code>
<a class="headerlink" href="#beancount.reports.price_reports" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Miscellaneous report classes.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.price_reports.CommoditiesReport">
<code>CommoditiesReport</code>
<a class="headerlink" href="#beancount.reports.price_reports.CommoditiesReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out a list of commodities.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.price_reports.CommoditiesReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.price_reports.CommoditiesReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/price_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>26
27
28
29
30</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">price_map</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">build_price_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">([(</span><span class="n">base_quote</span><span class="p">,)</span>
                               <span class="k">for</span> <span class="n">base_quote</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">price_map</span><span class="o">.</span><span class="n">forward_pairs</span><span class="p">)],</span>
                              <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"Base/Quote"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatter</span><span class="o">.</span><span class="n">render_commodity</span><span class="p">)])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.price_reports.CommodityLifetimes">
<code>CommodityLifetimes</code>
<a class="headerlink" href="#beancount.reports.price_reports.CommodityLifetimes" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out a list of lifetimes of each commodity.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.price_reports.CommodityLifetimes.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.price_reports.CommodityLifetimes.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/price_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>39
40
41
42
43</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-c'</span><span class="p">,</span> <span class="s1">'--compress-days'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"The number of unused days to allow for continuous usage."</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.price_reports.CommodityPricesReport">
<code>CommodityPricesReport</code>
<a class="headerlink" href="#beancount.reports.price_reports.CommodityPricesReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print all the prices for a particular commodity.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.price_reports.CommodityPricesReport.add_args">
<code class="highlight language-python">
add_args<span class="p">(</span><span class="n">parser</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.price_reports.CommodityPricesReport.add_args" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add arguments to parse for this report.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>An instance of argparse.ArgumentParser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/price_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>69
70
71
72
73</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-c'</span><span class="p">,</span> <span class="s1">'--commodity'</span><span class="p">,</span> <span class="s1">'--currency'</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">'store'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">"The commodity pair to display."</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.price_reports.CommodityPricesReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.price_reports.CommodityPricesReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/price_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>91
92
93
94
95</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">date_rates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_date_rates</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">date_rates</span><span class="p">,</span>
                              <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"Date"</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">isoformat</span><span class="p">),</span>
                               <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"Price"</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:.5f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">)])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.price_reports.PriceDBReport">
<code>PriceDBReport</code>
<a class="headerlink" href="#beancount.reports.price_reports.PriceDBReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out the normalized price entries from the price db.
    Normalized means that we print prices in the most common (base, quote) order.
    This can be used to rebuild a prices database without having to share the
    entire ledger file.</p>
<pre><code>Only the forward prices are printed; which (base, quote) pair is selected is
selected based on the most common occurrence between (base, quote) and
(quote, base). This is done in the price map.
</code></pre>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.price_reports.PricesReport">
<code>PricesReport</code>
<a class="headerlink" href="#beancount.reports.price_reports.PricesReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print out the unnormalized price entries that we input.
    Unnormalized means that we may render both (base,quote) and (quote,base).
    This can be used to rebuild a prices database without having to share the
    entire ledger file.</p>
<pre><code>Note: this type of report should be removed once we have filtering on
directive type, this is simply the 'print' report with type:price. Maybe
rename the 'pricedb' report to just 'prices' for simplicity's sake.
</code></pre>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.price_reports.TickerReport">
<code>TickerReport</code>
<a class="headerlink" href="#beancount.reports.price_reports.TickerReport" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print a parseable mapping of (base, quote, ticker, name) for all commodities.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.price_reports.TickerReport.generate_table">
<code class="highlight language-python">
generate_table<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.price_reports.TickerReport.generate_table" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the report to a Table instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>errors</code></td>
<td><code></code></td>
<td>
<p>A list of errors that occurred during processing.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Table, that will get converted to another format.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/price_reports.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>169
170
171
172
173
174
175
176
177
178
179
180
181
182</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">commodity_map</span> <span class="o">=</span> <span class="n">getters</span><span class="o">.</span><span class="n">get_commodity_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
    <span class="n">ticker_info</span> <span class="o">=</span> <span class="n">getters</span><span class="o">.</span><span class="n">get_values_meta</span><span class="p">(</span><span class="n">commodity_map</span><span class="p">,</span> <span class="s1">'name'</span><span class="p">,</span> <span class="s1">'ticker'</span><span class="p">,</span> <span class="s1">'quote'</span><span class="p">)</span>

    <span class="n">price_rows</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">,</span> <span class="n">ticker</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ticker</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ticker_info</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">ticker</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">price_rows</span><span class="p">,</span>
                              <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"Currency"</span><span class="p">),</span>
                               <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"Cost-Currency"</span><span class="p">),</span>
                               <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"Symbol"</span><span class="p">),</span>
                               <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">"Name"</span><span class="p">)])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.report">
<code>report</code>
<a class="headerlink" href="#beancount.reports.report" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Produce various custom implemented reports.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.report.ListFormatsAction">
<code>ListFormatsAction</code>
<a class="headerlink" href="#beancount.reports.report.ListFormatsAction" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An argparse action that prints all supported formats (for each report).</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.report.ListReportsAction">
<code>ListReportsAction</code>
<a class="headerlink" href="#beancount.reports.report.ListReportsAction" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An argparse action that just prints the list of reports and exits.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.report.get_all_reports">
<code class="highlight language-python">
get_all_reports<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.reports.report.get_all_reports" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return all report classes.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of all available report classes.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/report.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_all_reports</span><span class="p">():</span>
    <span class="sd">"""Return all report classes.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A list of all available report classes.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span>
                            <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">module</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">__reports__</span><span class="p">,</span>
                                <span class="p">[</span><span class="n">balance_reports</span><span class="p">,</span>
                                 <span class="n">journal_reports</span><span class="p">,</span>
                                 <span class="n">holdings_reports</span><span class="p">,</span>
                                 <span class="n">export_reports</span><span class="p">,</span>
                                 <span class="n">price_reports</span><span class="p">,</span>
                                 <span class="n">misc_reports</span><span class="p">,</span>
                                 <span class="n">convert_reports</span><span class="p">]))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.report.get_list_report_string">
<code class="highlight language-python">
get_list_report_string<span class="p">(</span><span class="n">only_report</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.report.get_list_report_string" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a formatted string for the list of supported reports.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>only_report</code></td>
<td><code></code></td>
<td>
<p>A string, the name of a single report to produce the help
for. If not specified, list all the available reports.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A help string, or None, if 'only_report' was provided and is not a valid
report name.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/report.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_list_report_string</span><span class="p">(</span><span class="n">only_report</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Return a formatted string for the list of supported reports.</span>

<span class="sd">    Args:</span>
<span class="sd">      only_report: A string, the name of a single report to produce the help</span>
<span class="sd">        for. If not specified, list all the available reports.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A help string, or None, if 'only_report' was provided and is not a valid</span>
<span class="sd">      report name.</span>
<span class="sd">    """</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">num_reports</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">report_class</span> <span class="ow">in</span> <span class="n">get_all_reports</span><span class="p">():</span>
        <span class="c1"># Filter the name</span>
        <span class="k">if</span> <span class="n">only_report</span> <span class="ow">and</span> <span class="n">only_report</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">report_class</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Get the textual description.</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">' +'</span><span class="p">,</span> <span class="s1">' '</span><span class="p">,</span> <span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">report_class</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())),</span>
            <span class="n">initial_indent</span><span class="o">=</span><span class="s2">"    "</span><span class="p">,</span>
            <span class="n">subsequent_indent</span><span class="o">=</span><span class="s2">"    "</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

        <span class="c1"># Get the report's arguments.</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
        <span class="n">report_</span> <span class="o">=</span> <span class="n">report_class</span>
        <span class="n">report_class</span><span class="o">.</span><span class="n">add_args</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>

        <span class="c1"># Get the list of supported formats.</span>
        <span class="c1">## formats = report_class.get_supported_formats()</span>

        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1">:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">','</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">report_</span><span class="o">.</span><span class="n">names</span><span class="p">),</span>
                                     <span class="n">description</span><span class="p">))</span>
        <span class="n">num_reports</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">num_reports</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.table">
<code>table</code>
<a class="headerlink" href="#beancount.reports.table" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Table rendering.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.table.Table">
<code>Table</code>
<a class="headerlink" href="#beancount.reports.table.Table" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Table(columns, header, body)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.table.Table.__getnewargs__">
<code class="highlight language-python">
__getnewargs__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.reports.table.Table.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>427
428
429</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">'Return self as a plain tuple.  Used by copy and pickle.'</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.table.Table.__new__">
<code class="highlight language-python">
__new__<span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.reports.table.Table.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Table(columns, header, body)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.table.Table.__repr__">
<code class="highlight language-python">
__repr__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.reports.table.Table.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>419
420
421</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">'Return a nicely formatted representation string'</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.table.attribute_to_title">
<code class="highlight language-python">
attribute_to_title<span class="p">(</span><span class="n">fieldname</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.table.attribute_to_title" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert programming id into readable field name.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>fieldname</code></td>
<td><code></code></td>
<td>
<p>A string, a programming ids, such as 'book_value'.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A readable string, such as 'Book Value.'</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>25
26
27
28
29
30
31
32
33</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">attribute_to_title</span><span class="p">(</span><span class="n">fieldname</span><span class="p">):</span>
    <span class="sd">"""Convert programming id into readable field name.</span>

<span class="sd">    Args:</span>
<span class="sd">      fieldname: A string, a programming ids, such as 'book_value'.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A readable string, such as 'Book Value.'</span>
<span class="sd">   """</span>
    <span class="k">return</span> <span class="n">fieldname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'_'</span><span class="p">,</span> <span class="s1">' '</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.table.compute_table_widths">
<code class="highlight language-python">
compute_table_widths<span class="p">(</span><span class="n">rows</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.table.compute_table_widths" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the max character widths of a list of rows.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rows</code></td>
<td><code></code></td>
<td>
<p>A list of rows, which are sequences of strings.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of integers, the maximum widths required to render the columns of
this table.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>IndexError</code></td>
<td>
<p>If the rows are of different lengths.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">compute_table_widths</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="sd">"""Compute the max character widths of a list of rows.</span>

<span class="sd">    Args:</span>
<span class="sd">      rows: A list of rows, which are sequences of strings.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of integers, the maximum widths required to render the columns of</span>
<span class="sd">      this table.</span>
<span class="sd">    Raises:</span>
<span class="sd">      IndexError: If the rows are of different lengths.</span>
<span class="sd">    """</span>
    <span class="n">row_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
    <span class="n">first_row</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">row_iter</span><span class="p">)</span>
    <span class="n">num_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_row</span><span class="p">)</span>
    <span class="n">column_widths</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">first_row</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">row_iter</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
            <span class="n">cell_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cell_len</span> <span class="o">&gt;</span> <span class="n">column_widths</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">column_widths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell_len</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">!=</span> <span class="n">num_columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">"Invalid number of rows"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">column_widths</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.table.create_table">
<code class="highlight language-python">
create_table<span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">field_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.table.create_table" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert a list of tuples to an table report object.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rows</code></td>
<td><code></code></td>
<td>
<p>A list of tuples.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>field_spec</code></td>
<td><code></code></td>
<td>
<p>A list of strings, or a list of
(FIELDNAME-OR-INDEX, HEADER, FORMATTER-FUNCTION)
triplets, that selects a subset of the fields is to be rendered as well
as their ordering. If this is a dict, the values are functions to call
on the fields to render them. If a function is set to None, we will just
call str() on the field.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Table instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">field_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Convert a list of tuples to an table report object.</span>

<span class="sd">    Args:</span>
<span class="sd">      rows: A list of tuples.</span>
<span class="sd">      field_spec: A list of strings, or a list of</span>
<span class="sd">        (FIELDNAME-OR-INDEX, HEADER, FORMATTER-FUNCTION)</span>
<span class="sd">        triplets, that selects a subset of the fields is to be rendered as well</span>
<span class="sd">        as their ordering. If this is a dict, the values are functions to call</span>
<span class="sd">        on the fields to render them. If a function is set to None, we will just</span>
<span class="sd">        call str() on the field.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A Table instance.</span>
<span class="sd">    """</span>
    <span class="c1"># Normalize field_spec to a dict.</span>
    <span class="k">if</span> <span class="n">field_spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">namedtuple_class</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">field_spec</span> <span class="o">=</span> <span class="p">[(</span><span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">namedtuple_class</span><span class="o">.</span><span class="n">_fields</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_spec</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">new_field_spec</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">field_spec</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">field</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">field</span><span class="p">,</span> <span class="o">=</span> <span class="n">field</span>
                    <span class="n">new_field_spec</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">field</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">field</span>
                    <span class="n">new_field_spec</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">field</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">new_field_spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="n">attribute_to_title</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="s2">"Field </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Invalid type for column name"</span><span class="p">)</span>
                <span class="n">new_field_spec</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">field</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

        <span class="n">field_spec</span> <span class="o">=</span> <span class="n">new_field_spec</span>

    <span class="c1"># Ensure a nicely formatted header.</span>
    <span class="n">field_spec</span> <span class="o">=</span> <span class="p">[((</span><span class="n">name</span><span class="p">,</span> <span class="n">attribute_to_title</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">formatter</span><span class="p">)</span>
                   <span class="k">if</span> <span class="n">header_</span> <span class="ow">is</span> <span class="kc">None</span>
                   <span class="k">else</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">header_</span><span class="p">,</span> <span class="n">formatter</span><span class="p">))</span>
                  <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">header_</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span> <span class="ow">in</span> <span class="n">field_spec</span><span class="p">]</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_spec</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="n">field_spec</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">field_spec</span><span class="p">),</span> <span class="n">field_spec</span>

    <span class="c1"># Compute the column names.</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">)</span> <span class="ow">in</span> <span class="n">field_spec</span><span class="p">]</span>

    <span class="c1"># Compute the table header.</span>
    <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="n">header_column</span> <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">header_column</span><span class="p">,</span> <span class="n">__</span><span class="p">)</span> <span class="ow">in</span> <span class="n">field_spec</span><span class="p">]</span>

    <span class="c1"># Compute the table body.</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="n">body_row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">formatter</span> <span class="ow">in</span> <span class="n">field_spec</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Invalid type for column name"</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">formatter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s1">''</span>
            <span class="n">body_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">body_row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.table.render_table">
<code class="highlight language-python">
render_table<span class="p">(</span><span class="n">table_</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">output_format</span><span class="p">,</span> <span class="n">css_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">css_class</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.table.render_table" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the given table to the output file object in the requested format.</p>
<p>The table gets written out to the 'output' file.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table_</code></td>
<td><code></code></td>
<td>
<p>An instance of Table.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>output</code></td>
<td><code></code></td>
<td>
<p>A file object you can write to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>output_format</code></td>
<td><code></code></td>
<td>
<p>A string, the format to write the table to,
either 'csv', 'txt' or 'html'.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>css_id</code></td>
<td><code></code></td>
<td>
<p>A string, an optional CSS id for the table object (only used for HTML).</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>css_class</code></td>
<td><code></code></td>
<td>
<p>A string, an optional CSS class for the table object (only used for HTML).</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_table</span><span class="p">(</span><span class="n">table_</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">output_format</span><span class="p">,</span> <span class="n">css_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">css_class</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Render the given table to the output file object in the requested format.</span>

<span class="sd">    The table gets written out to the 'output' file.</span>

<span class="sd">    Args:</span>
<span class="sd">      table_: An instance of Table.</span>
<span class="sd">      output: A file object you can write to.</span>
<span class="sd">      output_format: A string, the format to write the table to,</span>
<span class="sd">        either 'csv', 'txt' or 'html'.</span>
<span class="sd">      css_id: A string, an optional CSS id for the table object (only used for HTML).</span>
<span class="sd">      css_class: A string, an optional CSS class for the table object (only used for HTML).</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">output_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'txt'</span><span class="p">,</span> <span class="s1">'text'</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">table_to_text</span><span class="p">(</span><span class="n">table_</span><span class="p">,</span> <span class="s2">"  "</span><span class="p">,</span> <span class="n">formats</span><span class="o">=</span><span class="p">{</span><span class="s1">'*'</span><span class="p">:</span> <span class="s1">'&gt;'</span><span class="p">,</span> <span class="s1">'account'</span><span class="p">:</span> <span class="s1">'&lt;'</span><span class="p">})</span>
        <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">output_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'csv'</span><span class="p">,):</span>
        <span class="n">table_to_csv</span><span class="p">(</span><span class="n">table_</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">output_format</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'htmldiv'</span><span class="p">,</span> <span class="s1">'html'</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">'html'</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;html&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;body&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

        <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;div id="</span><span class="si">{}</span><span class="s1">"&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">css_id</span><span class="p">)</span> <span class="k">if</span> <span class="n">css_id</span> <span class="k">else</span> <span class="s1">'&lt;div&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">css_class</span><span class="p">]</span> <span class="k">if</span> <span class="n">css_class</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">table_to_html</span><span class="p">(</span><span class="n">table_</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/div&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">'html'</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/body&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/html&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Unsupported format: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_format</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.table.table_to_csv">
<code class="highlight language-python">
table_to_csv<span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.table.table_to_csv" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a Table to a CSV file.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td><code></code></td>
<td>
<p>An instance of a Table.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>A file object to write to. If no object is provided, this
function returns a string.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td><code></code></td>
<td>
<p>Optional arguments forwarded to csv.writer().</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered table, or None, if a file object is provided
to write to.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">table_to_csv</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">"""Render a Table to a CSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">      table: An instance of a Table.</span>
<span class="sd">      file: A file object to write to. If no object is provided, this</span>
<span class="sd">        function returns a string.</span>
<span class="sd">      **kwargs: Optional arguments forwarded to csv.writer().</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the rendered table, or None, if a file object is provided</span>
<span class="sd">      to write to.</span>
<span class="sd">    """</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>

    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">header</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output_file</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.table.table_to_html">
<code class="highlight language-python">
table_to_html<span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.table.table_to_html" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a Table to HTML.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td><code></code></td>
<td>
<p>An instance of a Table.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>classes</code></td>
<td><code></code></td>
<td>
<p>A list of string, CSS classes to set on the table.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>A file object to write to. If no object is provided, this
function returns a string.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered table, or None, if a file object is provided
to write to.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">table_to_html</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Render a Table to HTML.</span>

<span class="sd">    Args:</span>
<span class="sd">      table: An instance of a Table.</span>
<span class="sd">      classes: A list of string, CSS classes to set on the table.</span>
<span class="sd">      file: A file object to write to. If no object is provided, this</span>
<span class="sd">        function returns a string.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the rendered table, or None, if a file object is provided</span>
<span class="sd">      to write to.</span>
<span class="sd">    """</span>
    <span class="c1"># Initialize file.</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">file</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;table class="</span><span class="si">{}</span><span class="s1">"&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">classes</span> <span class="ow">or</span> <span class="p">[])))</span>

    <span class="c1"># Render header.</span>
    <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">header</span><span class="p">:</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'  &lt;thead&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'    &lt;tr&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">header</span><span class="p">:</span>
            <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'      &lt;th&gt;</span><span class="si">{}</span><span class="s1">&lt;/th&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">header</span><span class="p">))</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'    &lt;/tr&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'  &lt;/thead&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

    <span class="c1"># Render body.</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'  &lt;tbody&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'    &lt;tr&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
            <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'      &lt;td&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'    &lt;/tr&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'  &lt;/tbody&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

    <span class="c1"># Render footer.</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/table&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.table.table_to_text">
<code class="highlight language-python">
table_to_text<span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column_interspace</span><span class="o">=</span><span class="s1">' '</span><span class="p">,</span> <span class="n">formats</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.table.table_to_text" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a Table to ASCII text.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td><code></code></td>
<td>
<p>An instance of a Table.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>column_interspace</code></td>
<td><code></code></td>
<td>
<p>A string to render between the columns as spacer.</p>
</td>
<td><code>' '</code></td>
</tr>
<tr>
<td><code>formats</code></td>
<td><code></code></td>
<td>
<p>An optional dict of column name to a format character that gets
inserted in a format string specified, like this (where '&lt;char&gt;' is):
{:&lt;char&gt;&lt;width&gt;}. A key of '<em>' will provide a default value, like
this, for example: (... formats={'</em>': '&gt;'}).</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered text table.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">table_to_text</span><span class="p">(</span><span class="n">table</span><span class="p">,</span>
                  <span class="n">column_interspace</span><span class="o">=</span><span class="s2">" "</span><span class="p">,</span>
                  <span class="n">formats</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Render a Table to ASCII text.</span>

<span class="sd">    Args:</span>
<span class="sd">      table: An instance of a Table.</span>
<span class="sd">      column_interspace: A string to render between the columns as spacer.</span>
<span class="sd">      formats: An optional dict of column name to a format character that gets</span>
<span class="sd">        inserted in a format string specified, like this (where '&lt;char&gt;' is):</span>
<span class="sd">        {:&lt;char&gt;&lt;width&gt;}. A key of '*' will provide a default value, like</span>
<span class="sd">        this, for example: (... formats={'*': '&gt;'}).</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the rendered text table.</span>
<span class="sd">    """</span>
    <span class="n">column_widths</span> <span class="o">=</span> <span class="n">compute_table_widths</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">([</span><span class="n">table</span><span class="o">.</span><span class="n">header</span><span class="p">],</span>
                                                         <span class="n">table</span><span class="o">.</span><span class="n">body</span><span class="p">))</span>

    <span class="c1"># Insert column format chars and compute line formatting string.</span>
    <span class="n">column_formats</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">formats</span><span class="p">:</span>
        <span class="n">default_format</span> <span class="o">=</span> <span class="n">formats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'*'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">width</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">column_widths</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">and</span> <span class="n">formats</span><span class="p">:</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="n">formats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">default_format</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">format_</span><span class="p">:</span>
                <span class="n">column_formats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"{{:</span><span class="si">{}{:d}</span><span class="s2">}}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">format_</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">column_formats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"{{:</span><span class="si">{:d}</span><span class="s2">}}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">column_formats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"{{:</span><span class="si">{:d}</span><span class="s2">}}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="p">))</span>

    <span class="n">line_format</span> <span class="o">=</span> <span class="n">column_interspace</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">column_formats</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="n">line_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">[(</span><span class="s1">'-'</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span> <span class="k">for</span> <span class="n">width</span> <span class="ow">in</span> <span class="n">column_widths</span><span class="p">])</span>

    <span class="c1"># Render the header.</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">header</span><span class="p">:</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="o">.</span><span class="n">header</span><span class="p">))</span>

    <span class="c1"># Render the body.</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">))</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.tree_table">
<code>tree_table</code>
<a class="headerlink" href="#beancount.reports.tree_table" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Routines to render an HTML table with a tree of accounts.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.tree_table.is_account_active">
<code class="highlight language-python">
is_account_active<span class="p">(</span><span class="n">real_account</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.tree_table.is_account_active" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the account should be rendered. An active account has
at least one directive that is not an Open directive.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_account</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if the account is active, according to the definition above.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/tree_table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">is_account_active</span><span class="p">(</span><span class="n">real_account</span><span class="p">):</span>
    <span class="sd">"""Return true if the account should be rendered. An active account has</span>
<span class="sd">    at least one directive that is not an Open directive.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_account: An instance of RealAccount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if the account is active, according to the definition above.</span>
<span class="sd">    """</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">real_account</span><span class="o">.</span><span class="n">txn_postings</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Open</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.tree_table.table_of_balances">
<code class="highlight language-python">
table_of_balances<span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">operating_currencies</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.tree_table.table_of_balances" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a tree table with the balance of each accounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>A RealAccount node, the root node to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A prices map, a built by build_price_map.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_date</code></td>
<td><code></code></td>
<td>
<p>A datetime.date instance, the date at which to compute market value.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>operating_currencies</code></td>
<td><code></code></td>
<td>
<p>A list of strings, the operating currencies to render
to their own dedicated columns.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>formatter</code></td>
<td><code></code></td>
<td>
<p>A object used to render account names and other links.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>classes</code></td>
<td><code></code></td>
<td>
<p>A list of strings, the CSS classes to attach to the renderd
top-level table objet.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string with HTML contents, the rendered table.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/tree_table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">table_of_balances</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span>
                      <span class="n">operating_currencies</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span>
                      <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Render a tree table with the balance of each accounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_root: A RealAccount node, the root node to render.</span>
<span class="sd">      price_map: A prices map, a built by build_price_map.</span>
<span class="sd">      price_date: A datetime.date instance, the date at which to compute market value.</span>
<span class="sd">      operating_currencies: A list of strings, the operating currencies to render</span>
<span class="sd">        to their own dedicated columns.</span>
<span class="sd">      formatter: A object used to render account names and other links.</span>
<span class="sd">      classes: A list of strings, the CSS classes to attach to the renderd</span>
<span class="sd">        top-level table objet.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string with HTML contents, the rendered table.</span>
<span class="sd">    """</span>
    <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Account'</span><span class="p">]</span> <span class="o">+</span> <span class="n">operating_currencies</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'Other'</span><span class="p">]</span>

    <span class="c1"># Pre-calculate which accounts should be rendered.</span>
    <span class="n">real_active</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">is_account_active</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">real_active</span><span class="p">:</span>
        <span class="n">active_set</span> <span class="o">=</span> <span class="p">{</span><span class="n">real_account</span><span class="o">.</span><span class="n">account</span>
                      <span class="k">for</span> <span class="n">real_account</span> <span class="ow">in</span> <span class="n">realization</span><span class="o">.</span><span class="n">iter_children</span><span class="p">(</span><span class="n">real_active</span><span class="p">)}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">active_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="n">balance_totals</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="p">()</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="k">if</span> <span class="n">classes</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'fullwidth'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">real_account</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">row_classes</span> <span class="ow">in</span> <span class="n">tree_table</span><span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span>
                                                       <span class="n">header</span><span class="p">,</span> <span class="n">classes</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">real_account</span> <span class="ow">is</span> <span class="n">TOTALS_LINE</span><span class="p">:</span>
            <span class="n">line_balance</span> <span class="o">=</span> <span class="n">balance_totals</span>
            <span class="n">row_classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'totals'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Check if this account has had activity; if not, skip rendering it.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">real_account</span><span class="o">.</span><span class="n">account</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">active_set</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="n">account_types</span><span class="o">.</span><span class="n">is_root_account</span><span class="p">(</span><span class="n">real_account</span><span class="o">.</span><span class="n">account</span><span class="p">)):</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">real_account</span><span class="o">.</span><span class="n">account</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">row_classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'parent-node'</span><span class="p">)</span>

            <span class="c1"># For each account line, get the final balance of the account at</span>
            <span class="c1"># latest market value.</span>
            <span class="n">line_balance</span> <span class="o">=</span> <span class="n">real_account</span><span class="o">.</span><span class="n">balance</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">convert</span><span class="o">.</span><span class="n">get_value</span><span class="p">,</span> <span class="n">price_map</span><span class="p">)</span>

            <span class="c1"># Update the total balance for the totals line.</span>
            <span class="n">balance_totals</span> <span class="o">+=</span> <span class="n">line_balance</span>

        <span class="c1"># Extract all the positions that the user has identified as operating</span>
        <span class="c1"># currencies to their own subinventories.</span>
        <span class="n">ccy_dict</span> <span class="o">=</span> <span class="n">line_balance</span><span class="o">.</span><span class="n">segregate_units</span><span class="p">(</span><span class="n">operating_currencies</span><span class="p">)</span>

        <span class="c1"># FIXME: This little algorithm is inefficient; rewrite it.</span>
        <span class="k">for</span> <span class="n">currency</span> <span class="ow">in</span> <span class="n">operating_currencies</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="n">ccy_dict</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span><span class="o">.</span><span class="n">get_currency_units</span><span class="p">(</span><span class="n">currency</span><span class="p">)</span>
            <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">formatter</span><span class="o">.</span><span class="n">render_number</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
                         <span class="k">if</span> <span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="o">!=</span> <span class="n">ZERO</span>
                         <span class="k">else</span> <span class="s1">''</span><span class="p">)</span>

        <span class="c1"># Render all the rest of the inventory in the last cell.</span>
        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">ccy_dict</span><span class="p">:</span>
            <span class="n">ccy_balance</span> <span class="o">=</span> <span class="n">ccy_dict</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
            <span class="n">last_cell</span> <span class="o">=</span> <span class="s1">'&lt;br/&gt;'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatter</span><span class="o">.</span><span class="n">render_amount</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                                     <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ccy_balance</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">last_cell</span> <span class="o">=</span> <span class="s1">''</span>
        <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last_cell</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.reports.tree_table.tree_table">
<code class="highlight language-python">
tree_table<span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">real_account</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.tree_table.tree_table" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Generator to a tree of accounts as an HTML table.</p>
<p>This yields each real_account object in turn and a list object used to
provide the values for the various columns to render.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>oss</code></td>
<td><code></code></td>
<td>
<p>a io.StringIO instance, into which we will render the HTML.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>real_account</code></td>
<td><code></code></td>
<td>
<p>an instance of a RealAccount node.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>formatter</code></td>
<td><code></code></td>
<td>
<p>A object used to render account names and other links.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>header</code></td>
<td><code></code></td>
<td>
<p>a list of header columns to render. The first column is special,
      and is used for the account name.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>classes</code></td>
<td><code></code></td>
<td>
<p>a list of CSS class strings to apply to the table element.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A generator of tuples of
  real_account</code></td>
<td>
<p>An instance of RealAccount to render as a row
  cells: A mutable list object to accumulate values for each column you
    want to render.
  row_classes: A mutable list object to accumulate css classes that you
    want to add for the row.</p>
<p>You need to append to the given 'cells' object; if you don't append
anything, this tells this routine to skip rendering the row. On the very
last line, the 'real_account' object will be a special sentinel value to
indicate that it is meant to render the totals line: TOTALS_LINE.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/reports/tree_table.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">tree_table</span><span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">real_account</span><span class="p">,</span> <span class="n">formatter</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Generator to a tree of accounts as an HTML table.</span>

<span class="sd">    This yields each real_account object in turn and a list object used to</span>
<span class="sd">    provide the values for the various columns to render.</span>

<span class="sd">    Args:</span>
<span class="sd">      oss: a io.StringIO instance, into which we will render the HTML.</span>
<span class="sd">      real_account: an instance of a RealAccount node.</span>
<span class="sd">      formatter: A object used to render account names and other links.</span>
<span class="sd">      header: a list of header columns to render. The first column is special,</span>
<span class="sd">              and is used for the account name.</span>
<span class="sd">      classes: a list of CSS class strings to apply to the table element.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A generator of tuples of</span>
<span class="sd">        real_account: An instance of RealAccount to render as a row</span>
<span class="sd">        cells: A mutable list object to accumulate values for each column you</span>
<span class="sd">          want to render.</span>
<span class="sd">        row_classes: A mutable list object to accumulate css classes that you</span>
<span class="sd">          want to add for the row.</span>

<span class="sd">      You need to append to the given 'cells' object; if you don't append</span>
<span class="sd">      anything, this tells this routine to skip rendering the row. On the very</span>
<span class="sd">      last line, the 'real_account' object will be a special sentinel value to</span>
<span class="sd">      indicate that it is meant to render the totals line: TOTALS_LINE.</span>
<span class="sd">    """</span>
    <span class="n">write</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="p">(</span><span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">))</span>

    <span class="n">classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="k">if</span> <span class="n">classes</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'tree-table'</span><span class="p">)</span>
    <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;table class="</span><span class="si">{}</span><span class="s1">"&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="k">if</span> <span class="n">classes</span> <span class="k">else</span> <span class="s1">''</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
        <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;thead&gt;'</span><span class="p">)</span>
        <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;tr&gt;'</span><span class="p">)</span>
        <span class="n">header_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;th class="first"&gt;</span><span class="si">{}</span><span class="s1">&lt;/th&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">header_iter</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">header_iter</span><span class="p">:</span>
            <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;th&gt;</span><span class="si">{}</span><span class="s1">&lt;/th&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">column</span><span class="p">))</span>
        <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/tr&gt;'</span><span class="p">)</span>
        <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/thead&gt;'</span><span class="p">)</span>

    <span class="c1"># Note: This code eventually should be reworked to be agnostic regarding</span>
    <span class="c1"># text or HTML output rendering.</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">real_account</span><span class="p">)</span>

    <span class="c1"># Yield with a None for the final line.</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">TOTALS_LINE</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">first_line</span><span class="p">,</span> <span class="n">unused_cont_line</span><span class="p">,</span> <span class="n">real_acc</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="c1"># Let the caller fill in the data to be rendered by adding it to a list</span>
        <span class="c1"># objects. The caller may return multiple cell values; this will create</span>
        <span class="c1"># multiple columns.</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">row_classes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">yield</span> <span class="n">real_acc</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">row_classes</span>

        <span class="c1"># If no cells were added, skip the line. If you want to render empty</span>
        <span class="c1"># cells, append empty strings.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cells</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Render the row</span>
        <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;tr class="</span><span class="si">{}</span><span class="s1">"&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row_classes</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">real_acc</span> <span class="ow">is</span> <span class="n">TOTALS_LINE</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">'&lt;span class="totals-label"&gt;&lt;/span&gt;'</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="n">formatter</span><span class="o">.</span><span class="n">render_account</span><span class="p">(</span><span class="n">real_acc</span><span class="o">.</span><span class="n">account</span><span class="p">)</span>
                     <span class="k">if</span> <span class="n">formatter</span>
                     <span class="k">else</span> <span class="n">real_acc</span><span class="o">.</span><span class="n">account</span><span class="p">)</span>

        <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;td class="tree-node-name"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>

        <span class="c1"># Add columns for each value rendered.</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">:</span>
            <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;td class="num"&gt;</span><span class="si">{}</span><span class="s1">&lt;/td&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span>

        <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/tr&gt;'</span><span class="p">)</span>

    <span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/table&gt;'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.reports.tree_table_test">
<code>tree_table_test</code>
<a class="headerlink" href="#beancount.reports.tree_table_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.reports.tree_table_test.TestTables">
<code>TestTables</code>
<a class="headerlink" href="#beancount.reports.tree_table_test.TestTables" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.reports.tree_table_test.TestTables.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.reports.tree_table_test.TestTables.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/reports/tree_table_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@loader</span><span class="o">.</span><span class="n">load_doc</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    2014-01-01 open Assets:US:Checking</span>
<span class="sd">    2014-01-01 open Assets:CA:Checking</span>
<span class="sd">    2014-01-01 open Assets:Inactive</span>
<span class="sd">    2014-01-01 open Equity:Opening-Balances</span>

<span class="sd">    2014-07-04 *</span>
<span class="sd">      Assets:US:Checking      3000 USD</span>
<span class="sd">      Equity:Opening-Balances</span>

<span class="sd">    2014-07-04 *</span>
<span class="sd">      Assets:CA:Checking      3000 CAD</span>
<span class="sd">      Equity:Opening-Balances</span>

<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">real_root</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">realize</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-right" href="beancount.scripts.html" title="beancount.scripts">Next <span class="icon icon-circle-arrow-right"></span></a>
<a class="btn btn-neutral" href="beancount.query.html" title="beancount.query"><span class="icon icon-circle-arrow-left"></span> Previous</a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<a class="fa fa-github" href="https://github.com/xuhcc/beancount-docs/" style="float: left; color: #fcfcfc"> GitHub</a>
<span><a href="beancount.query.html" style="color: #fcfcfc;">« Previous</a></span>
<span style="margin-left: 15px"><a href="beancount.scripts.html" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script>var base_url = '..';</script>
<script defer="" src="../js/theme.js"></script>
<script defer="" src="../js/extra.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
</body>
</html>
