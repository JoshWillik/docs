<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://xuhcc.github.io/beancount-docs/api_reference/beancount.web.html" rel="canonical"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>beancount.web - Beancount Documentation</title>
<link href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet">
<link href="../css/theme.css" rel="stylesheet">
<link href="../css/theme_extra.css" rel="stylesheet"/>
<link href="../css/custom.css" rel="stylesheet"/>
<script>
    // Current page data
    var mkdocs_page_name = "beancount.web";
    var mkdocs_page_input_path = "api_reference/beancount.web.md";
    var mkdocs_page_url = "/beancount-docs/api_reference/beancount.web.html";
  </script>
<script defer="" src="../js/jquery-2.1.1.min.js"></script>
<script defer="" src="../js/modernizr-2.8.3.min.js"></script>
</link></link></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href=".."> Beancount Documentation</a>
</div>
<div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Index</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Outline</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Users</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../01_command_line_accounting_in_context.html">Command Line Accounting in Context</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../02_the_double_entry_counting_method.html">The Double Entry Counting Method</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../03_installing_beancount.html">Installing Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../04_running_beancount_and_generating_reports.html">Running Beancount and Generating Reports</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../05_getting_started_with_beancount.html">Getting Started with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../06_beancount_language_syntax.html">Beancount Language Syntax</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../07_beancount_options_reference.html">Beancount Options Reference</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../08_precision_tolerances.html">Precision Tolerances</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../09_beancount_query_language.html">Beancount Query Language</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../10_beancount_cheat_sheet.html">Beancount Cheat Sheet</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../11_how_inventories_work.html">How Inventories Work</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../12_exporting_your_portfolio.html">Exporting Your Portfolio</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../13_tutorial_example.html">Tutorial &amp; Example</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../14_beancount_history_and_credits.html">Beancount History and Credits</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../15_a_comparison_of_beancount_and_ledger_hledger.html">A Comparison of Beancount and Ledger Hledger</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../16_fetching_prices_in_beancount.html">Fetching Prices in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../17_importing_external_data.html">Importing External Data</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Cookbooks &amp; Examples</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../18_command_line_accounting_cookbook.html">Command Line Accounting Cookbook</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../19_trading_with_beancount.html">Trading with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../20_stock_vesting_in_beancount.html">Stock Vesting in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../21_sharing_expenses_with_beancount.html">Sharing Expenses with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../22_how_we_share_expenses.html">How We Share Expenses</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Developers</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../23_beancount_scripting_plugins.html">Beancount Scripting Plugins</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../24_beancount_design_doc.html">Beancount Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../25_ledgerhub_design_doc.html">Ledgerhub Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../26_external_contributions.html">External Contributions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Enhancement Proposals &amp; Discussions</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../27_a_proposal_for_an_improvement_on_inventory_booking.html">A Proposal for an Improvement on Inventory Booking</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../28_settlement_dates_in_beancount.html">Settlement Dates in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../29_balance_assertions_in_beancount.html">Balance Assertions in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../30_fund_accounting_with_beancount.html">Fund Accounting with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../31_rounding_precision_in_beancount.html">Rounding Precision in Beancount</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">beancount</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.core.html">beancount.core</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ingest.html">beancount.ingest</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.loader.html">beancount.loader</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ops.html">beancount.ops</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.parser.html">beancount.parser</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.plugins.html">beancount.plugins</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.prices.html">beancount.prices</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.query.html">beancount.query</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.reports.html">beancount.reports</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.scripts.html">beancount.scripts</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.utils.html">beancount.utils</a>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="beancount.web.html">beancount.web</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#beancount.web">beancount.web</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.bottle_utils">bottle_utils</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.bottle_utils.AttrMapper">AttrMapper</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.bottle_utils.AttrMapper.__init__">__init__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.bottle_utils.internal_redirect">internal_redirect()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.bottle_utils_test">bottle_utils_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.bottle_utils_test.TestAttrMapper">TestAttrMapper</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.bottle_utils_test.TestAttrMapper.setUp">setUp()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.scrape">scrape</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.scrape.iterlinks">iterlinks()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.scrape.scrape_urls">scrape_urls()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.scrape.validate_local_links">validate_local_links()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.scrape.validate_local_links_in_dir">validate_local_links_in_dir()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.scrape_test">scrape_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.scrape_test.Redirect">Redirect</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.scrape_test.Redirect.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.scrape_test.Redirect.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.scrape_test.Redirect.__repr__">__repr__()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.views">views</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.AllView">AllView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.AllView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.ComponentView">ComponentView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.ComponentView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.ComponentView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.EmptyView">EmptyView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.EmptyView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.EmptyView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.MonthNavigation">MonthNavigation</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.MonthView">MonthView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.MonthView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.MonthView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.PayeeView">PayeeView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.PayeeView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.PayeeView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.TagView">TagView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.TagView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.TagView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.View">View</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.View.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.View.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.YearView">YearView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.YearView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.YearView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.views_test">views_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views_test.TestViews">TestViews</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views_test.TestViews.setUp">setUp()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.web">web</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.HTMLFormatter">HTMLFormatter</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.build_global">build_global()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_account">render_account()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_commodity">render_commodity()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_context">render_context()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_doc">render_doc()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_event_type">render_event_type()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_inventory">render_inventory()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_link">render_link()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_source">render_source()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.activity">activity()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.auto_reload_input_file">auto_reload_input_file()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.balsheet">balsheet()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.commodities">commodities()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.context_">context_()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.conversions_">conversions_()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.doc">doc()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.documents">documents()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.errors">errors()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.event">event()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.event_index">event_index()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.get_all_view">get_all_view()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.handle_view">handle_view()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_">holdings_()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_byaccount">holdings_byaccount()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_bycommodity">holdings_bycommodity()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_bycurrency">holdings_bycurrency()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_byrootaccount">holdings_byrootaccount()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.incognito">incognito()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.income">income()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.index">index()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.journal_">journal_()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.journal_all">journal_all()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.link">link()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.main">main()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.month_request">month_request()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.networth">networth()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.openbal">openbal()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.populate_view">populate_view()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.prices_values">prices_values()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_global">render_global()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_overlay">render_overlay()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_real_report">render_real_report()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_report">render_report()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_view">render_view()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.root">root()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.scrape_webapp">scrape_webapp()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.setup_monkey_patch_for_server_shutdown">setup_monkey_patch_for_server_shutdown()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.shutdown">shutdown()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.source">source()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.stats_postings">stats_postings()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.stats_types">stats_types()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.style">style()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.thread_server_shutdown">thread_server_shutdown()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.thread_server_start">thread_server_start()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.trial">trial()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.url_restrict_generator">url_restrict_generator()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.wait_ready">wait_ready()</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="top navigation" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="..">Beancount Documentation</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a href="..">Docs</a> »</li>
<li>API reference »</li>
<li>beancount.web</li>
<li class="wy-breadcrumbs-aside">
<a class="icon icon-github" href="https://github.com/xuhcc/beancount-docs/edit/master/docs/api_reference/beancount.web.md"> Edit on GitHub</a>
</li>
</ul>
<hr/>
</div>
<div role="main">
<div class="section">
<h1 id="beancountweb">beancount.web<a class="headerlink" href="#beancountweb" title="Permanent link"></a></h1>
<div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#beancount.web" id="beancount.web" style="visibility: hidden; width: 0; height: 0;">
<a class="headerlink" href="#beancount.web" title="Permanent link"></a></h2>
<div class="doc doc-contents first">
<p>Web server reporting front-end.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.bottle_utils">
<code>bottle_utils</code>
<a class="headerlink" href="#beancount.web.bottle_utils" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Bottle utilities, mostly helpers to do mounts on top of dynamic routes.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.bottle_utils.AttrMapper">
<code>AttrMapper</code>
<a class="headerlink" href="#beancount.web.bottle_utils.AttrMapper" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A URL mapper that allows attribute access for view-links.
    This is used in templates.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.bottle_utils.AttrMapper.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapper_function</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.bottle_utils.AttrMapper.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Constructor for an attribute mapper.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mapper_function</code></td>
<td><code></code></td>
<td>
<p>A function to apply on attribute lookup, and
upon calling .build().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/bottle_utils.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>15
16
17
18
19
20
21
22</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapper_function</span><span class="p">):</span>
    <span class="sd">"""Constructor for an attribute mapper.</span>

<span class="sd">    Args:</span>
<span class="sd">      mapper_function: A function to apply on attribute lookup, and</span>
<span class="sd">        upon calling .build().</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mapper_function</span> <span class="o">=</span> <span class="n">mapper_function</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.bottle_utils.internal_redirect">
<code class="highlight language-python">
internal_redirect<span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">path_depth</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.bottle_utils.internal_redirect" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A version of bottle's mountpoint_wrapper() that we call explicitly.</p>
<p>Bottle supports a mount() method that allows on to install an application on
a subpath of the main application. However, it does this on a fixed path. We
want to manually intercept the lazy creation or fetching of a view and call
for a redirect explicitly (via bottle's mountpoint_wrapper() function).
However, this function is hidden within the scope of a the Bottle.mount()
method; if it were defined globally we would just use it, but it is not. So
we copy if here. This is directly lifted from Bottle.mount() and edited
minimally.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>app</code></td>
<td><code></code></td>
<td>
<p>A Bottle instance.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>path_depth</code></td>
<td><code></code></td>
<td>
<p>The number of request path components to skip for the mount.
For example, if our subapplication is mount on /view/all, then the path
depth is 2.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Bottle HTTPResponse objet.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Exception</code></td>
<td>
<p>Any exception, depending on the callback.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/bottle_utils.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">internal_redirect</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">path_depth</span><span class="p">):</span>
    <span class="sd">"""A version of bottle's mountpoint_wrapper() that we call explicitly.</span>

<span class="sd">    Bottle supports a mount() method that allows on to install an application on</span>
<span class="sd">    a subpath of the main application. However, it does this on a fixed path. We</span>
<span class="sd">    want to manually intercept the lazy creation or fetching of a view and call</span>
<span class="sd">    for a redirect explicitly (via bottle's mountpoint_wrapper() function).</span>
<span class="sd">    However, this function is hidden within the scope of a the Bottle.mount()</span>
<span class="sd">    method; if it were defined globally we would just use it, but it is not. So</span>
<span class="sd">    we copy if here. This is directly lifted from Bottle.mount() and edited</span>
<span class="sd">    minimally.</span>

<span class="sd">    Args:</span>
<span class="sd">      app: A Bottle instance.</span>
<span class="sd">      path_depth: The number of request path components to skip for the mount.</span>
<span class="sd">        For example, if our subapplication is mount on /view/all, then the path</span>
<span class="sd">        depth is 2.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A Bottle HTTPResponse objet.</span>
<span class="sd">    Raises:</span>
<span class="sd">      Exception: Any exception, depending on the callback.</span>
<span class="sd">    """</span>
    <span class="c1"># pylint: disable=invalid-name</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">path_shift</span><span class="p">(</span><span class="n">path_depth</span><span class="p">)</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="n">bottle</span><span class="o">.</span><span class="n">HTTPResponse</span><span class="p">([])</span>
        <span class="k">def</span> <span class="nf">start_response</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">headerlist</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">exc_info</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">_raise</span><span class="p">(</span><span class="o">*</span><span class="n">exc_info</span><span class="p">)</span>
                <span class="k">finally</span><span class="p">:</span>
                    <span class="n">exc_info</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">rs</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">headerlist</span><span class="p">:</span> <span class="n">rs</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">append</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">app</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">body</span> <span class="ow">and</span> <span class="n">rs</span><span class="o">.</span><span class="n">body</span><span class="p">:</span> <span class="n">body</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">rs</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="n">rs</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">body</span> <span class="ow">or</span> <span class="n">rs</span><span class="o">.</span><span class="n">body</span>
        <span class="k">return</span> <span class="n">rs</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">path_shift</span><span class="p">(</span><span class="o">-</span><span class="n">path_depth</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.bottle_utils_test">
<code>bottle_utils_test</code>
<a class="headerlink" href="#beancount.web.bottle_utils_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.bottle_utils_test.TestAttrMapper">
<code>TestAttrMapper</code>
<a class="headerlink" href="#beancount.web.bottle_utils_test.TestAttrMapper" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.bottle_utils_test.TestAttrMapper.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.bottle_utils_test.TestAttrMapper.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/bottle_utils_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>11
12
13
14
15</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'a'</span><span class="p">:</span> <span class="s1">'the_a'</span><span class="p">,</span>
                  <span class="s1">'b'</span><span class="p">:</span> <span class="s1">'the_b'</span><span class="p">,</span>
                  <span class="s1">'c'</span><span class="p">:</span> <span class="s1">'the_c'</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mapper</span> <span class="o">=</span> <span class="n">bottle_utils</span><span class="o">.</span><span class="n">AttrMapper</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.scrape">
<code>scrape</code>
<a class="headerlink" href="#beancount.web.scrape" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.scrape.iterlinks">
<code class="highlight language-python">
iterlinks<span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">html_path</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.scrape.iterlinks" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Find links targets in HTML text.</p>
<p>This deals with both absolute and relative links, and it external links to
external sites.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>html</code></td>
<td><code></code></td>
<td>
<p>An lxml document node.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>html_path</code></td>
<td><code></code></td>
<td>
<p>The URL of the document node.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  URL strings, where found.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">iterlinks</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">html_path</span><span class="p">):</span>
    <span class="sd">"""Find links targets in HTML text.</span>

<span class="sd">    This deals with both absolute and relative links, and it external links to</span>
<span class="sd">    external sites.</span>

<span class="sd">    Args:</span>
<span class="sd">      html: An lxml document node.</span>
<span class="sd">      html_path: The URL of the document node.</span>
<span class="sd">    Yields:</span>
<span class="sd">      URL strings, where found.</span>

<span class="sd">    """</span>
    <span class="n">html_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">html_path</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">element</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">iterlinks</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">scheme</span> <span class="ow">or</span> <span class="n">url</span><span class="o">.</span><span class="n">netloc</span><span class="p">:</span>
            <span class="k">continue</span>  <span class="c1"># Skip external urls.</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">link</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">link</span><span class="p">):</span>
            <span class="n">link</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">html_dir</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">link</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.scrape.scrape_urls">
<code class="highlight language-python">
scrape_urls<span class="p">(</span><span class="n">url_format</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">ignore_regexp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.scrape.scrape_urls" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Recursively scrape pages from a web address.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>url_format</code></td>
<td><code></code></td>
<td>
<p>The pattern for building links from relative paths.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code></code></td>
<td>
<p>A callback function to invoke on each page to validate it.
The function is called with the response and the url as arguments.
This function should trigger an error on failure (via an exception).</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>ignore_regexp</code></td>
<td><code></code></td>
<td>
<p>A regular expression string, the urls to ignore.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of all the processed URLs and a set of all the skipped URLs.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">scrape_urls</span><span class="p">(</span><span class="n">url_format</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">ignore_regexp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Recursively scrape pages from a web address.</span>

<span class="sd">    Args:</span>
<span class="sd">      url_format: The pattern for building links from relative paths.</span>
<span class="sd">      callback: A callback function to invoke on each page to validate it.</span>
<span class="sd">        The function is called with the response and the url as arguments.</span>
<span class="sd">        This function should trigger an error on failure (via an exception).</span>
<span class="sd">      ignore_regexp: A regular expression string, the urls to ignore.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A set of all the processed URLs and a set of all the skipped URLs.</span>
<span class="sd">    """</span>
    <span class="c1"># The set of all URLs seen so far.</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="c1"># The list of all URLs to process. We use a list here so we have</span>
    <span class="c1"># reproducible order if we repeat the test.</span>
    <span class="n">process_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"/"</span><span class="p">]</span>

    <span class="c1"># A set of all the URLs processed and skipped everywhere.</span>
    <span class="n">all_processed_urls</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">all_skipped_urls</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="c1"># Loop over all URLs remaining to process.</span>
    <span class="k">while</span> <span class="n">process_list</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">process_list</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">"Processing: </span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
        <span class="n">all_processed_urls</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="c1"># Fetch the URL and check its return status.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

        <span class="c1"># Generate errors on redirects.</span>
        <span class="n">redirected_url</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">geturl</span><span class="p">())</span><span class="o">.</span><span class="n">path</span>
        <span class="k">if</span> <span class="n">redirected_url</span> <span class="o">!=</span> <span class="n">url</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">"Redirected: </span><span class="si">%s</span><span class="s2"> -&gt; </span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">redirected_url</span><span class="p">)</span>

        <span class="c1"># Read the contents. This can only be done once.</span>
        <span class="n">response_contents</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">skipped_urls</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">content_type</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="o">.</span><span class="n">get_content_type</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="s1">'text/html'</span><span class="p">:</span>
            <span class="c1"># Process all the links in the page and register all the unseen links to</span>
            <span class="c1"># be processed.</span>
            <span class="n">html_root</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">document_fromstring</span><span class="p">(</span><span class="n">response_contents</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">iterlinks</span><span class="p">(</span><span class="n">html_root</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>

                <span class="c1"># Skip URLs to be ignored.</span>
                <span class="k">if</span> <span class="n">ignore_regexp</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">ignore_regexp</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">"Skipping: </span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
                    <span class="n">skipped_urls</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
                    <span class="n">all_skipped_urls</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="c1"># Check if link has already been seen.</span>
                <span class="k">if</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">'Seen: "</span><span class="si">%s</span><span class="s1">"'</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="c1"># Schedule the link for scraping.</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">'Scheduling: "</span><span class="si">%s</span><span class="s1">"'</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
                <span class="n">process_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
                <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">html_root</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Call back for processing.</span>
        <span class="n">callback</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">response_contents</span><span class="p">,</span> <span class="n">html_root</span><span class="p">,</span> <span class="n">skipped_urls</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">all_processed_urls</span><span class="p">,</span> <span class="n">all_skipped_urls</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.scrape.validate_local_links">
<code class="highlight language-python">
validate_local_links<span class="p">(</span><span class="n">filename</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.scrape.validate_local_links" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Open and parse the given HTML filename and verify all local targets exist.</p>
<p>This checks that all the files pointed to by the file we're processing are
files that exist on disk. This can be used to validate that a baked output
does not have links to files that do not exist, that all the links are valid.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the HTML file to process.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A pair of</code></td>
<td>
<p>missing: A set of strings, the names of links to files that do not exist.
  empty: A boolean, true if this file is empty.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">validate_local_links</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">"""Open and parse the given HTML filename and verify all local targets exist.</span>

<span class="sd">    This checks that all the files pointed to by the file we're processing are</span>
<span class="sd">    files that exist on disk. This can be used to validate that a baked output</span>
<span class="sd">    does not have links to files that do not exist, that all the links are valid.</span>

<span class="sd">    Args:</span>
<span class="sd">      filename: A string, the name of the HTML file to process.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of:</span>
<span class="sd">        missing: A set of strings, the names of links to files that do not exist.</span>
<span class="sd">        empty: A boolean, true if this file is empty.</span>
<span class="sd">    """</span>
    <span class="n">filedir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">contents</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">empty</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">empty</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">document_fromstring</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">html</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">element</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">lxml</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">iterlinks</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
                <span class="n">urlpath</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">urlpath</span><span class="o">.</span><span class="n">scheme</span> <span class="ow">or</span> <span class="n">urlpath</span><span class="o">.</span><span class="n">netloc</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">urlpath</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">target</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">urlpath</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                    <span class="n">missing</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">missing</span><span class="p">,</span> <span class="n">empty</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.scrape.validate_local_links_in_dir">
<code class="highlight language-python">
validate_local_links_in_dir<span class="p">(</span><span class="n">directory</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.scrape.validate_local_links_in_dir" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Find all the files under the given directory and validate all their links.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>directory</code></td>
<td><code></code></td>
<td>
<p>A string, the root directory whose files to process.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A tuple of</code></td>
<td>
<p>files: A list of all the filenames found and processed.
  missing: A set of strings, the names of links to files that do not exist.
  empty: A boolean, true if this file is empty.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">validate_local_links_in_dir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
    <span class="sd">"""Find all the files under the given directory and validate all their links.</span>

<span class="sd">    Args:</span>
<span class="sd">      directory: A string, the root directory whose files to process.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A tuple of:</span>
<span class="sd">        files: A list of all the filenames found and processed.</span>
<span class="sd">        missing: A set of strings, the names of links to files that do not exist.</span>
<span class="sd">        empty: A boolean, true if this file is empty.</span>
<span class="sd">    """</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
                        <span class="nb">format</span><span class="o">=</span><span class="s1">'</span><span class="si">%(levelname)-8s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">allfiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">missing</span><span class="p">,</span> <span class="n">empty</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">afilename</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">allfiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">afilename</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"Validating: '</span><span class="si">%s</span><span class="s2">'"</span><span class="p">,</span> <span class="n">afilename</span><span class="p">)</span>
            <span class="n">missing</span><span class="p">,</span> <span class="n">is_empty</span> <span class="o">=</span> <span class="n">validate_local_links</span><span class="p">(</span><span class="n">afilename</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_empty</span><span class="p">:</span>
                <span class="n">empty</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">afilename</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">allfiles</span><span class="p">,</span> <span class="n">missing</span><span class="p">,</span> <span class="n">empty</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.scrape_test">
<code>scrape_test</code>
<a class="headerlink" href="#beancount.web.scrape_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.scrape_test.Redirect">
<code>Redirect</code>
<a class="headerlink" href="#beancount.web.scrape_test.Redirect" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Redirect(target_url,)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.scrape_test.Redirect.__getnewargs__">
<code class="highlight language-python">
__getnewargs__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.scrape_test.Redirect.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>427
428
429</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">'Return self as a plain tuple.  Used by copy and pickle.'</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.scrape_test.Redirect.__new__">
<code class="highlight language-python">
__new__<span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">target_url</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.web.scrape_test.Redirect.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Redirect(target_url,)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.scrape_test.Redirect.__repr__">
<code class="highlight language-python">
__repr__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.scrape_test.Redirect.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>419
420
421</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">'Return a nicely formatted representation string'</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.views">
<code>views</code>
<a class="headerlink" href="#beancount.web.views" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Views are filters on the global list of entries, which produces a subset of entries.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.AllView">
<code>AllView</code>
<a class="headerlink" href="#beancount.web.views.AllView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view that includes all the entries, unmodified.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.AllView.apply_filter">
<code class="highlight language-python">
apply_filter<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.views.AllView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>142
143</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.ComponentView">
<code>ComponentView</code>
<a class="headerlink" href="#beancount.web.views.ComponentView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view that includes transactions with at least one posting with an account
    that includes a given component.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.ComponentView.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.ComponentView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view clamped to one year.</p>
<p>Note: this is the only view where the entries are summarized and
clamped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>compnent</code></td>
<td><code></code></td>
<td>
<p>A string, the name of an account component to include.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>274
275
276
277
278
279
280
281
282
283
284
285
286
287
288</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">component</span><span class="p">):</span>
    <span class="sd">"""Create a view clamped to one year.</span>

<span class="sd">    Note: this is the only view where the entries are summarized and</span>
<span class="sd">    clamped.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      title: A string, the title of this view.</span>
<span class="sd">      compnent: A string, the name of an account component to include.</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">component</span> <span class="o">=</span> <span class="n">component</span>
    <span class="n">View</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.ComponentView.apply_filter">
<code class="highlight language-python">
apply_filter<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.views.ComponentView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>290
291
292
293
294
295
296</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">component</span>
    <span class="n">component_entries</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span>
                         <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span>
                         <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">has_entry_account_component</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">component</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">component_entries</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.EmptyView">
<code>EmptyView</code>
<a class="headerlink" href="#beancount.web.views.EmptyView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An empty view, for testing.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.EmptyView.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.EmptyView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create an empty view.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>*args</code></td>
<td><code></code></td>
<td>
<p>Ignored.</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>**kw</code></td>
<td><code></code></td>
<td>
<p>Ignored.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>122
123
124
125
126
127
128
129
130
131
132</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">"""Create an empty view.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      title: A string, the title of this view.</span>
<span class="sd">      *args: Ignored.</span>
<span class="sd">      **kw: Ignored.</span>
<span class="sd">    """</span>
    <span class="n">View</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.EmptyView.apply_filter">
<code class="highlight language-python">
apply_filter<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.views.EmptyView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the list of entries unmodified.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>134
135
136</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span><span class="p">):</span>
    <span class="s2">"Return the list of entries unmodified."</span>
    <span class="k">return</span> <span class="p">([],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.MonthNavigation">
<code>MonthNavigation</code>
<a class="headerlink" href="#beancount.web.views.MonthNavigation" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An enumeration.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.MonthView">
<code>MonthView</code>
<a class="headerlink" href="#beancount.web.views.MonthView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view of the entries for a single month.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.MonthView.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.MonthView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view clamped to one month.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>year</code></td>
<td><code></code></td>
<td>
<p>An integer, the year of period.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>month</code></td>
<td><code></code></td>
<td>
<p>An integer, the month to be used as year end.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>184
185
186
187
188
189
190
191
192
193
194
195
196
197
198</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">):</span>
    <span class="sd">"""Create a view clamped to one month.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      title: A string, the title of this view.</span>
<span class="sd">      year: An integer, the year of period.</span>
<span class="sd">      month: An integer, the month to be used as year end.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span>
    <span class="n">View</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">monthly</span> <span class="o">=</span> <span class="n">MonthNavigation</span><span class="o">.</span><span class="n">FULL</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.MonthView.apply_filter">
<code class="highlight language-python">
apply_filter<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.views.MonthView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>200
201
202
203
204
205
206
207
208
209</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="c1"># Clamp to the desired period.</span>
    <span class="n">begin_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="n">date_utils</span><span class="o">.</span><span class="n">next_month</span><span class="p">(</span><span class="n">begin_date</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">misc_utils</span><span class="o">.</span><span class="n">log_time</span><span class="p">(</span><span class="s1">'clamp'</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">):</span>
        <span class="n">entries</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">summarize</span><span class="o">.</span><span class="n">clamp_opt</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span>
                                             <span class="n">begin_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span>
                                             <span class="n">options_map</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">entries</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">end_date</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.PayeeView">
<code>PayeeView</code>
<a class="headerlink" href="#beancount.web.views.PayeeView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view that includes entries with some specific payee.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.PayeeView.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">payee</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.PayeeView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view clamped to one year.</p>
<p>Note: this is the only view where the entries are summarized and
clamped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>payee</code></td>
<td><code></code></td>
<td>
<p>A string, the payee whose transactions to include.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>245
246
247
248
249
250
251
252
253
254
255
256
257
258
259</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">payee</span><span class="p">):</span>
    <span class="sd">"""Create a view clamped to one year.</span>

<span class="sd">    Note: this is the only view where the entries are summarized and</span>
<span class="sd">    clamped.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      title: A string, the title of this view.</span>
<span class="sd">      payee: A string, the payee whose transactions to include.</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">payee</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">payee</span> <span class="o">=</span> <span class="n">payee</span>
    <span class="n">View</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.PayeeView.apply_filter">
<code class="highlight language-python">
apply_filter<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.views.PayeeView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>261
262
263
264
265
266
267</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">payee</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">payee</span>
    <span class="n">payee_entries</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span>
                     <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span>
                     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">payee</span> <span class="o">==</span> <span class="n">payee</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">payee_entries</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.TagView">
<code>TagView</code>
<a class="headerlink" href="#beancount.web.views.TagView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view that includes only entries some specific tags.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.TagView.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.TagView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view with only entries tagged with the given tags.</p>
<p>Note: this is the only view where the entries are summarized and
clamped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>tags</code></td>
<td><code></code></td>
<td>
<p>A set of strings, the tags to include. Entries with at least
one of these tags will be included in the output.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
    <span class="sd">"""Create a view with only entries tagged with the given tags.</span>

<span class="sd">    Note: this is the only view where the entries are summarized and</span>
<span class="sd">    clamped.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      title: A string, the title of this view.</span>
<span class="sd">      tags: A set of strings, the tags to include. Entries with at least</span>
<span class="sd">        one of these tags will be included in the output.</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">frozenset</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">tags</span>
    <span class="n">View</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.TagView.apply_filter">
<code class="highlight language-python">
apply_filter<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.views.TagView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>232
233
234
235
236
237
238
239</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags</span>
    <span class="n">tagged_entries</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">entry</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="p">)</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">tags</span> <span class="ow">and</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">tags</span> <span class="o">&amp;</span> <span class="n">tags</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">tagged_entries</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.View">
<code>View</code>
<a class="headerlink" href="#beancount.web.views.View" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A container for filtering a subset of entries and realizing that for
    display.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.View.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.View.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Build a View instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>all_entries</code></td>
<td><code></code></td>
<td>
<p>The full list of directives as output from the loader.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>The options dict, as output by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view to render.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="sd">"""Build a View instance.</span>

<span class="sd">    Args:</span>
<span class="sd">      all_entries: The full list of directives as output from the loader.</span>
<span class="sd">      options_map: The options dict, as output by the parser.</span>
<span class="sd">      title: A string, the title of this view to render.</span>
<span class="sd">    """</span>

    <span class="c1"># A reference to the full list of padded entries.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_entries</span> <span class="o">=</span> <span class="n">all_entries</span>

    <span class="c1"># List of filtered entries for this view, and index at the beginning</span>
    <span class="c1"># of the period transactions, past the opening balances. These are</span>
    <span class="c1"># computed in _initialize().</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">opening_entries</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">closing_entries</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Title.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>

    <span class="c1"># Realization of the filtered entries to display. These are computed in</span>
    <span class="c1"># _initialize().</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">real_accounts</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">opening_real_accounts</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">closing_real_accounts</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Monthly navigation style.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">monthly</span> <span class="o">=</span> <span class="n">MonthNavigation</span><span class="o">.</span><span class="n">NONE</span>

    <span class="c1"># Realize now, we don't need to do this lazily because we create these</span>
    <span class="c1"># view objects on-demand and cache them.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initialize</span><span class="p">(</span><span class="n">options_map</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.View.apply_filter">
<code class="highlight language-python">
apply_filter<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.views.View.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">):</span>
    <span class="sd">"""Filter the list of entries.</span>

<span class="sd">    This is used to obtain the filtered list of entries.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives to filter.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of</span>
<span class="sd">        1. a list of filtered entries, and</span>
<span class="sd">        2. an integer, the index at which the beginning of the entries for</span>
<span class="sd">          the period begin, one directive past the opening</span>
<span class="sd">          balances/initialization entries.</span>
<span class="sd">        3. a datetime.date instance, the date at which to evaluate the value</span>
<span class="sd">          of assets held at cost.</span>
<span class="sd">    """</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.YearView">
<code>YearView</code>
<a class="headerlink" href="#beancount.web.views.YearView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view of the entries for a single year.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.YearView.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">first_month</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.YearView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view clamped to one year.</p>
<p>Note: this is the only view where the entries are summarized and
clamped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>year</code></td>
<td><code></code></td>
<td>
<p>An integer, the year of the exercise period.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>first_month</code></td>
<td><code></code></td>
<td>
<p>The calendar month (starting with 1) with which the year opens.</p>
</td>
<td><code>1</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">first_month</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""Create a view clamped to one year.</span>

<span class="sd">    Note: this is the only view where the entries are summarized and</span>
<span class="sd">    clamped.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      options_map: A dict of options, as produced by the parser.</span>
<span class="sd">      title: A string, the title of this view.</span>
<span class="sd">      year: An integer, the year of the exercise period.</span>
<span class="sd">      first_month: The calendar month (starting with 1) with which the year opens.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first_month</span> <span class="o">=</span> <span class="n">first_month</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">first_month</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Invalid month: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">first_month</span><span class="p">))</span>
    <span class="n">View</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">monthly</span> <span class="o">=</span> <span class="n">MonthNavigation</span><span class="o">.</span><span class="n">COMPACT</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.YearView.apply_filter">
<code class="highlight language-python">
apply_filter<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.views.YearView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>170
171
172
173
174
175
176
177
178</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="c1"># Clamp to the desired period.</span>
    <span class="n">begin_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">misc_utils</span><span class="o">.</span><span class="n">log_time</span><span class="p">(</span><span class="s1">'clamp'</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">):</span>
        <span class="n">entries</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">summarize</span><span class="o">.</span><span class="n">clamp_opt</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span>
                                             <span class="n">begin_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span>
                                             <span class="n">options_map</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">entries</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">end_date</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.views_test">
<code>views_test</code>
<a class="headerlink" href="#beancount.web.views_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views_test.TestViews">
<code>TestViews</code>
<a class="headerlink" href="#beancount.web.views_test.TestViews" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views_test.TestViews.setUp">
<code class="highlight language-python">
setUp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.views_test.TestViews.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/views_test.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@loader</span><span class="o">.</span><span class="n">load_doc</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    2010-01-01 open Assets:Checking</span>
<span class="sd">    2010-01-01 open Assets:Savings</span>
<span class="sd">    2010-01-01 open Income:MoneyFountain</span>

<span class="sd">    ;; Before 2013</span>
<span class="sd">    2012-11-15 *</span>
<span class="sd">      Assets:Checking        1 USD</span>
<span class="sd">      Income:MoneyFountain</span>

<span class="sd">    ;; With tag</span>
<span class="sd">    2013-02-03 * #trip1</span>
<span class="sd">      Assets:Checking        1 USD</span>
<span class="sd">      Income:MoneyFountain</span>

<span class="sd">    ;; With payee</span>
<span class="sd">    2013-04-03 * "Hardware Store" "Hammer"</span>
<span class="sd">      Assets:Checking        1 USD</span>
<span class="sd">      Income:MoneyFountain</span>

<span class="sd">    ;; With unique account component ("Savings")</span>
<span class="sd">    2013-07-03 *</span>
<span class="sd">      Assets:Savings        1 USD</span>
<span class="sd">      Income:MoneyFountain</span>

<span class="sd">    ;; After 2013</span>
<span class="sd">    2014-01-18 *</span>
<span class="sd">      Assets:Checking        1 USD</span>
<span class="sd">      Income:MoneyFountain</span>

<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">options_map</span> <span class="o">=</span> <span class="n">options_map</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">empty_realization</span> <span class="o">=</span> <span class="n">realization</span><span class="o">.</span><span class="n">realize</span><span class="p">(</span>
        <span class="s1">''</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">get_account_types</span><span class="p">(</span><span class="n">options_map</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.web">
<code>web</code>
<a class="headerlink" href="#beancount.web.web" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Web server for Beancount ledgers.
This uses the Bottle single-file micro web framework (with no plugins).</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.web.HTMLFormatter">
<code>HTMLFormatter</code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A formatter object that can be used to render accounts links.</p>
<pre><code>Attributes:
  build_url: A function used to render links to a Bottle application.
  leafonly: a boolean, if true, render only the name of the leaf nodes.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.build_global">
<code class="highlight language-python">
build_global<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.build_global" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render to global application.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>70
71
72</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">build_global</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
    <span class="s2">"Render to global application."</span>
    <span class="k">return</span> <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_account">
<code class="highlight language-python">
render_account<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_account" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_account</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">):</span>
    <span class="sd">"""See base class."""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_links</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_only</span><span class="p">:</span>
            <span class="c1"># Calculate the number of components to figure out the indent to</span>
            <span class="c1"># render at.</span>
            <span class="n">components</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
            <span class="n">indent</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{:.1f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">components</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">EMS_PER_COMPONENT</span><span class="p">)</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'&lt;a href="</span><span class="si">{}</span><span class="s1">" class="account"&gt;</span><span class="si">{}</span><span class="s1">&lt;/a&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">build_url</span><span class="p">(</span><span class="s1">'journal'</span><span class="p">,</span>
                               <span class="n">account_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">account_xform</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">account_name</span><span class="p">)),</span>
                <span class="n">account</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">account_name</span><span class="p">))</span>
            <span class="k">return</span> <span class="s1">'&lt;span "account" style="padding-left: </span><span class="si">{}</span><span class="s1">em"&gt;</span><span class="si">{}</span><span class="s1">&lt;/span&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">indent</span><span class="p">,</span> <span class="n">anchor</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'&lt;a href="</span><span class="si">{}</span><span class="s1">" class="account"&gt;</span><span class="si">{}</span><span class="s1">&lt;/a&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">build_url</span><span class="p">(</span><span class="s1">'journal'</span><span class="p">,</span>
                               <span class="n">account_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">account_xform</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">account_name</span><span class="p">)),</span>
                <span class="n">account_name</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">'&lt;span "account"&gt;</span><span class="si">{}</span><span class="s1">&lt;/span&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">anchor</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_only</span><span class="p">:</span>
            <span class="c1"># Calculate the number of components to figure out the indent to</span>
            <span class="c1"># render at.</span>
            <span class="n">components</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
            <span class="n">indent</span> <span class="o">=</span> <span class="s1">'</span><span class="si">{:.1f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">components</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">EMS_PER_COMPONENT</span><span class="p">)</span>
            <span class="n">account_name</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">'&lt;span "account" style="padding-left: </span><span class="si">{}</span><span class="s1">em"&gt;</span><span class="si">{}</span><span class="s1">&lt;/span&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">indent</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'&lt;span "account"&gt;</span><span class="si">{}</span><span class="s1">&lt;/span&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_commodity">
<code class="highlight language-python">
render_commodity<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_commodity" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>135
136
137
138
139</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_commodity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">):</span>
    <span class="sd">"""See base class."""</span>
    <span class="n">base</span><span class="p">,</span> <span class="n">quote</span> <span class="o">=</span> <span class="n">base_quote</span>
    <span class="k">return</span> <span class="s1">'&lt;a href="</span><span class="si">{}</span><span class="s1">"&gt;</span><span class="si">{}</span><span class="s1"> / </span><span class="si">{}</span><span class="s1">&lt;/a&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_url</span><span class="p">(</span><span class="s1">'prices'</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="o">=</span><span class="n">quote</span><span class="p">),</span> <span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_context">
<code class="highlight language-python">
render_context<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_context" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>112
113
114
115
116
117</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
    <span class="sd">"""See base class."""</span>
    <span class="c1"># Note: rendering to global application.</span>
    <span class="c1"># Note(2): we could avoid rendering links to summarizing and transfer</span>
    <span class="c1"># entries which are not going to be found.</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_global</span><span class="p">(</span><span class="s1">'context'</span><span class="p">,</span> <span class="n">ehash</span><span class="o">=</span><span class="n">compare</span><span class="o">.</span><span class="n">hash_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_doc">
<code class="highlight language-python">
render_doc<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_doc" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>124
125
126
127
128</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">"""See base class."""</span>
    <span class="k">return</span> <span class="s1">'&lt;a href="</span><span class="si">{}</span><span class="s1">" class="filename"&gt;</span><span class="si">{}</span><span class="s1">&lt;/a&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_url</span><span class="p">(</span><span class="s1">'doc'</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)),</span>
        <span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_event_type">
<code class="highlight language-python">
render_event_type<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_event_type" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>130
131
132
133</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_event_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="sd">"""See base class."""</span>
    <span class="k">return</span> <span class="s1">'&lt;a href="</span><span class="si">{}</span><span class="s1">"&gt;</span><span class="si">{}</span><span class="s1">&lt;/a&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_url</span><span class="p">(</span><span class="s1">'event'</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">),</span>
                                        <span class="n">event</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_inventory">
<code class="highlight language-python">
render_inventory<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inv</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_inventory" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Override this formatter to convert the inventory to units only.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>108
109
110</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inv</span><span class="p">):</span>
    <span class="sd">"""Override this formatter to convert the inventory to units only."""</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">render_inventory</span><span class="p">(</span><span class="n">inv</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">convert</span><span class="o">.</span><span class="n">get_units</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_link">
<code class="highlight language-python">
render_link<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_link" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>119
120
121
122</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
    <span class="sd">"""See base class."""</span>
    <span class="c1"># Note: rendering to global application.</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_global</span><span class="p">(</span><span class="s1">'link'</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="n">link</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_source">
<code class="highlight language-python">
render_source<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_source" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>141
142
143</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
    <span class="sd">"""See base class."""</span>
    <span class="k">return</span> <span class="s1">'</span><span class="si">{}</span><span class="s1">#</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span><span class="s1">'source'</span><span class="p">),</span> <span class="n">source</span><span class="p">[</span><span class="s1">'lineno'</span><span class="p">])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.activity">
<code class="highlight language-python">
activity<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.activity" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the update activity.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>846
847
848
849
850
851
852
853
854
855</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/activity'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'activity'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">activity</span><span class="p">():</span>
    <span class="s2">"Render the update activity."</span>
    <span class="k">return</span> <span class="n">render_global</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Update Activity"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">render_real_report</span><span class="p">(</span><span class="n">misc_reports</span><span class="o">.</span><span class="n">ActivityReport</span><span class="p">,</span>
                                    <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">real_accounts</span><span class="p">,</span>
                                    <span class="n">app</span><span class="o">.</span><span class="n">price_map</span><span class="p">,</span>
                                    <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">price_date</span><span class="p">,</span>
                                    <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.auto_reload_input_file">
<code class="highlight language-python">
auto_reload_input_file<span class="p">(</span><span class="n">callback</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.auto_reload_input_file" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A plugin that automatically reloads the input file if it changed since the
last page was loaded.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">auto_reload_input_file</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
    <span class="sd">"""A plugin that automatically reloads the input file if it changed since the</span>
<span class="sd">    last page was loaded."""</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">posargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">filename</span>

        <span class="k">if</span> <span class="n">loader</span><span class="o">.</span><span class="n">needs_refresh</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">'Reloading...'</span><span class="p">)</span>

            <span class="c1"># Save the source for later, to render.</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">app</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

            <span class="c1"># Parse the beancount file.</span>
            <span class="n">entries</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">options_map</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

            <span class="c1"># Print out the list of errors.</span>
            <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
                <span class="c1"># pylint: disable=unsupported-assignment-operation</span>
                <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">'render_overlay'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">',----------------------------------------------------------------'</span><span class="p">)</span>
                <span class="n">printer</span><span class="o">.</span><span class="n">print_errors</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'`----------------------------------------------------------------'</span><span class="p">)</span>

            <span class="c1"># Save globals in the global app.</span>
            <span class="n">app</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
            <span class="n">app</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span>
            <span class="n">app</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options_map</span>
            <span class="n">app</span><span class="o">.</span><span class="n">account_types</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get_account_types</span><span class="p">(</span><span class="n">options_map</span><span class="p">)</span>

            <span class="c1"># Pre-compute the price database.</span>
            <span class="n">app</span><span class="o">.</span><span class="n">price_map</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">build_price_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>

            <span class="c1"># Pre-compute the list of active years.</span>
            <span class="n">app</span><span class="o">.</span><span class="n">active_years</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">getters</span><span class="o">.</span><span class="n">get_active_years</span><span class="p">(</span><span class="n">entries</span><span class="p">))</span>

            <span class="c1"># Reset the view cache.</span>
            <span class="n">app</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># For now, the overlay is a link to the errors page. Always render</span>
            <span class="c1"># it on the right when there are errors.</span>
            <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
                <span class="c1"># pylint: disable=unsupported-assignment-operation</span>
                <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">'render_overlay'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">posargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.balsheet">
<code class="highlight language-python">
balsheet<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.balsheet" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Balance sheet.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>628
629
630
631
632
633
634
635
636</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/balsheet'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'balsheet'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">balsheet</span><span class="p">():</span>
    <span class="s2">"Balance sheet."</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span><span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Balance Sheet"</span><span class="p">,</span>
                       <span class="n">contents</span><span class="o">=</span><span class="n">render_real_report</span><span class="p">(</span><span class="n">balance_reports</span><span class="o">.</span><span class="n">BalanceSheetReport</span><span class="p">,</span>
                                                   <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">closing_real_accounts</span><span class="p">,</span>
                                                   <span class="n">app</span><span class="o">.</span><span class="n">price_map</span><span class="p">,</span>
                                                   <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">price_date</span><span class="p">,</span>
                                                   <span class="n">leaf_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.commodities">
<code class="highlight language-python">
commodities<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.commodities" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a list commodities with list their prices page.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>815
816
817
818
819
820
821
822
823</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/commodities'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'commodities'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">commodities</span><span class="p">():</span>
    <span class="s2">"Render a list commodities with list their prices page."</span>
    <span class="n">html_table</span> <span class="o">=</span> <span class="n">render_report</span><span class="p">(</span><span class="n">price_reports</span><span class="o">.</span><span class="n">CommoditiesReport</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
                               <span class="p">[],</span>
                               <span class="n">css_id</span><span class="o">=</span><span class="s1">'price-index'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Commodities"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">html_table</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.context_">
<code class="highlight language-python">
context_<span class="p">(</span><span class="n">ehash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.context_" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the before &amp; after context around a transaction entry.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/context/&lt;ehash:re:[a-fA-F0-9]*&gt;'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'context'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">context_</span><span class="p">(</span><span class="n">ehash</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="s2">"Render the before &amp; after context around a transaction entry."</span>

    <span class="n">matching_entries</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span>
                        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">app</span><span class="o">.</span><span class="n">entries</span>
                        <span class="k">if</span> <span class="n">ehash</span> <span class="o">==</span> <span class="n">compare</span><span class="o">.</span><span class="n">hash_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)]</span>

    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matching_entries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"ERROR: Could not find matching entry for '</span><span class="si">{}</span><span class="s2">'"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ehash</span><span class="p">),</span>
              <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">matching_entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"ERROR: Ambiguous entries for '</span><span class="si">{}</span><span class="s2">'"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ehash</span><span class="p">),</span>
              <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>
        <span class="n">dcontext</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">'dcontext'</span><span class="p">]</span>
        <span class="n">printer</span><span class="o">.</span><span class="n">print_entries</span><span class="p">(</span><span class="n">matching_entries</span><span class="p">,</span> <span class="n">dcontext</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">oss</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">matching_entries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Render the context.</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;pre&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">render_entry_context</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="n">entry</span><span class="p">))</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/pre&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># Render the filelinks.</span>
        <span class="k">if</span> <span class="n">FILELINK_PROTOCOL</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">FILELINK_PROTOCOL</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'filename'</span><span class="p">),</span>
                                           <span class="n">lineno</span><span class="o">=</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'lineno'</span><span class="p">))</span>
            <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;div class="filelink"&gt;&lt;a href="</span><span class="si">{}</span><span class="s1">"&gt;</span><span class="si">{}</span><span class="s1">&lt;/a&gt;&lt;/div&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="s1">'Open'</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">render_global</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Context: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ehash</span><span class="p">),</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.conversions_">
<code class="highlight language-python">
conversions_<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.conversions_" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the list of transactions with conversions.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>774
775
776
777
778
779
780</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/conversions'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'conversions'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">conversions_</span><span class="p">():</span>
    <span class="s2">"Render the list of transactions with conversions."</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Conversions"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">render_report</span><span class="p">(</span><span class="n">journal_reports</span><span class="o">.</span><span class="n">ConversionsReport</span><span class="p">,</span>
                               <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.doc">
<code class="highlight language-python">
doc<span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.doc" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Serve static filenames for documents directives.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/doc/&lt;filename:re:.*&gt;'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">doc_name</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">doc</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="s2">"Serve static filenames for documents directives."</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="s1">'/'</span> <span class="o">+</span> <span class="n">filename</span>

    <span class="c1"># Check that there is a document directive that has this filename.</span>
    <span class="c1"># This is for security; we don't want to be able to serve just any file.</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">misc_utils</span><span class="o">.</span><span class="n">filter_type</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Document</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">filename</span> <span class="o">==</span> <span class="n">filename</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">bottle</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="s2">"Not found"</span><span class="p">)</span>

    <span class="c1"># Just serve the file ourselves.</span>
    <span class="k">return</span> <span class="n">bottle</span><span class="o">.</span><span class="n">static_file</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span>
                              <span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.documents">
<code class="highlight language-python">
documents<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.documents" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a tree with all the documents found.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>793
794
795
796
797
798
799</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/documents'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'documents'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">documents</span><span class="p">():</span>
    <span class="s2">"Render a tree with all the documents found."</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Documents"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">render_report</span><span class="p">(</span><span class="n">journal_reports</span><span class="o">.</span><span class="n">DocumentsReport</span><span class="p">,</span>
                               <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.errors">
<code class="highlight language-python">
errors<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.errors" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Report error encountered during parsing, checking and realization.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>336
337
338
339
340
341</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/errors'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'errors'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">errors</span><span class="p">():</span>
    <span class="s2">"Report error encountered during parsing, checking and realization."</span>
    <span class="k">return</span> <span class="n">render_global</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Errors"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">render_report</span><span class="p">(</span><span class="n">misc_reports</span><span class="o">.</span><span class="n">ErrorReport</span><span class="p">,</span> <span class="p">[],</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.event">
<code class="highlight language-python">
event<span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.event" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render all values of a particular event.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>826
827
828
829
830
831
832
833
834</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="sa">r</span><span class="s1">'/event/&lt;event:re:([A-Za-z0-9\-_/.]+)?&gt;'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'event'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">event</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="s2">"Render all values of a particular event."</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">event</span><span class="p">:</span>
        <span class="n">bottle</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span><span class="s1">'event_index'</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Event: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event</span><span class="p">),</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">render_report</span><span class="p">(</span><span class="n">misc_reports</span><span class="o">.</span><span class="n">EventsReport</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
                               <span class="p">[</span><span class="s1">'--expr'</span><span class="p">,</span> <span class="n">event</span><span class="p">]))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.event_index">
<code class="highlight language-python">
event_index<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.event_index" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the latest values of all events and an index.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>837
838
839
840
841
842
843</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/event'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'event_index'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">event_index</span><span class="p">():</span>
    <span class="s2">"Render the latest values of all events and an index."</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Events Index"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">render_report</span><span class="p">(</span><span class="n">misc_reports</span><span class="o">.</span><span class="n">CurrentEventsReport</span><span class="p">,</span>
                               <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.get_all_view">
<code class="highlight language-python">
get_all_view<span class="p">(</span><span class="n">app</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.get_all_view" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a view of all transactions.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of AllView, that covers all transactions.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>964
965
966
967
968
969
970</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_all_view</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="sd">"""Return a view of all transactions.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of AllView, that covers all transactions.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">views</span><span class="o">.</span><span class="n">AllView</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="s1">'All Transactions'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.handle_view">
<code class="highlight language-python">
handle_view<span class="p">(</span><span class="n">path_depth</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.handle_view" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A decorator for handlers which create views lazily.
If you decorate a method with this, the wrapper does the redirect
handling and your method is just a factory for a View instance,
which is cached.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path_depth</code></td>
<td><code></code></td>
<td>
<p>An integer, the number of components that form the view id.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A decorator function, used to wrap view handlers.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">handle_view</span><span class="p">(</span><span class="n">path_depth</span><span class="p">):</span>
    <span class="sd">"""A decorator for handlers which create views lazily.</span>
<span class="sd">    If you decorate a method with this, the wrapper does the redirect</span>
<span class="sd">    handling and your method is just a factory for a View instance,</span>
<span class="sd">    which is cached.</span>

<span class="sd">    Args:</span>
<span class="sd">      path_depth: An integer, the number of components that form the view id.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A decorator function, used to wrap view handlers.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">view_populator</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">components</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
            <span class="n">viewid</span> <span class="o">=</span> <span class="s1">'/'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">components</span><span class="p">[:</span><span class="n">path_depth</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Try fetching the view from the cache.</span>
                <span class="n">view</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">views</span><span class="p">[</span><span class="n">viewid</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="c1"># We need to create the view.</span>
                <span class="n">view</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">views</span><span class="p">[</span><span class="n">viewid</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># Save the view for the subrequest and redirect. populate_view()</span>
            <span class="c1"># picks this up and saves it in request.view.</span>
            <span class="n">request</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'VIEW'</span><span class="p">]</span> <span class="o">=</span> <span class="n">view</span>
            <span class="k">return</span> <span class="n">bottle_utils</span><span class="o">.</span><span class="n">internal_redirect</span><span class="p">(</span><span class="n">viewapp</span><span class="p">,</span> <span class="n">path_depth</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span>
    <span class="k">return</span> <span class="n">view_populator</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_">
<code class="highlight language-python">
holdings_<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.holdings_" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a detailed table of all holdings.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>661
662
663
664
665
666
667
668
669
670</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/equity/holdings'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'holdings'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">holdings_</span><span class="p">():</span>
    <span class="s2">"Render a detailed table of all holdings."</span>
    <span class="n">html_table</span> <span class="o">=</span> <span class="n">render_report</span><span class="p">(</span><span class="n">holdings_reports</span><span class="o">.</span><span class="n">HoldingsReport</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
                               <span class="p">[],</span>
                               <span class="n">css_class</span><span class="o">=</span><span class="s1">'holdings detail-table sortable'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Holdings"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">html_table</span><span class="p">,</span>
        <span class="n">scripts</span><span class="o">=</span><span class="s1">'&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_byaccount">
<code class="highlight language-python">
holdings_byaccount<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.holdings_byaccount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of holdings by account.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>672
673
674
675
676
677
678
679
680
681
682</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/equity/holdings_byaccount'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'holdings_byaccount'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">holdings_byaccount</span><span class="p">():</span>
    <span class="s2">"Render a table of holdings by account."</span>

    <span class="n">html_table</span> <span class="o">=</span> <span class="n">render_report</span><span class="p">(</span><span class="n">holdings_reports</span><span class="o">.</span><span class="n">HoldingsReport</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
                               <span class="p">[</span><span class="s1">'--by'</span><span class="p">,</span> <span class="s1">'account'</span><span class="p">],</span>
                               <span class="n">css_class</span><span class="o">=</span><span class="s1">'holdings detail-table sortable'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Holdings by Account"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">html_table</span><span class="p">,</span>
        <span class="n">scripts</span><span class="o">=</span><span class="s1">'&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_bycommodity">
<code class="highlight language-python">
holdings_bycommodity<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.holdings_bycommodity" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of holdings by commodity.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>696
697
698
699
700
701
702
703
704
705
706</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/equity/holdings_bycommodity'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'holdings_bycommodity'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">holdings_bycommodity</span><span class="p">():</span>
    <span class="s2">"Render a table of holdings by commodity."</span>

    <span class="n">html_table</span> <span class="o">=</span> <span class="n">render_report</span><span class="p">(</span><span class="n">holdings_reports</span><span class="o">.</span><span class="n">HoldingsReport</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
                               <span class="p">[</span><span class="s1">'--by'</span><span class="p">,</span> <span class="s1">'commodity'</span><span class="p">],</span>
                               <span class="n">css_class</span><span class="o">=</span><span class="s1">'holdings detail-table sortable'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Holdings by Commodity"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">html_table</span><span class="p">,</span>
        <span class="n">scripts</span><span class="o">=</span><span class="s1">'&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_bycurrency">
<code class="highlight language-python">
holdings_bycurrency<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.holdings_bycurrency" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of holdings by currency.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>708
709
710
711
712
713
714
715
716
717
718</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/equity/holdings_bycurrency'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'holdings_bycurrency'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">holdings_bycurrency</span><span class="p">():</span>
    <span class="s2">"Render a table of holdings by currency."</span>

    <span class="n">html_table</span> <span class="o">=</span> <span class="n">render_report</span><span class="p">(</span><span class="n">holdings_reports</span><span class="o">.</span><span class="n">HoldingsReport</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
                               <span class="p">[</span><span class="s1">'--by'</span><span class="p">,</span> <span class="s1">'currency'</span><span class="p">],</span>
                               <span class="n">css_class</span><span class="o">=</span><span class="s1">'holdings detail-table sortable'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Holdings by Currency"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">html_table</span><span class="p">,</span>
        <span class="n">scripts</span><span class="o">=</span><span class="s1">'&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_byrootaccount">
<code class="highlight language-python">
holdings_byrootaccount<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.holdings_byrootaccount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of holdings by account.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>684
685
686
687
688
689
690
691
692
693
694</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/equity/holdings_byrootaccount'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'holdings_byrootaccount'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">holdings_byrootaccount</span><span class="p">():</span>
    <span class="s2">"Render a table of holdings by account."</span>

    <span class="n">html_table</span> <span class="o">=</span> <span class="n">render_report</span><span class="p">(</span><span class="n">holdings_reports</span><span class="o">.</span><span class="n">HoldingsReport</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
                               <span class="p">[</span><span class="s1">'--by'</span><span class="p">,</span> <span class="s1">'root-account'</span><span class="p">],</span>
                               <span class="n">css_class</span><span class="o">=</span><span class="s1">'holdings detail-table sortable'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Holdings by Account"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">html_table</span><span class="p">,</span>
        <span class="n">scripts</span><span class="o">=</span><span class="s1">'&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;'</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.incognito">
<code class="highlight language-python">
incognito<span class="p">(</span><span class="n">callback</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.incognito" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A plugin that converts all numbers rendered into X's, in order
to hide the actual values in the ledger. This is used for doing
public demos using my real ledger, where I don't necessarily
want to share the detail of my financial life with the viewers
but when I still want an interesting ledger, with enough
detail that looks realistic.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">incognito</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
    <span class="sd">"""A plugin that converts all numbers rendered into X's, in order</span>
<span class="sd">    to hide the actual values in the ledger. This is used for doing</span>
<span class="sd">    public demos using my real ledger, where I don't necessarily</span>
<span class="sd">    want to share the detail of my financial life with the viewers</span>
<span class="sd">    but when I still want an interesting ledger, with enough</span>
<span class="sd">    detail that looks realistic."""</span>

    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">posargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">posargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># pylint: disable=bad-continuation</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'text/html'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span> <span class="ow">and</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">contents</span> <span class="o">=</span> <span class="n">text_utils</span><span class="o">.</span><span class="n">replace_numbers</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">contents</span>

    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.income">
<code class="highlight language-python">
income<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.income" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Income statement.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>650
651
652
653
654
655
656
657
658</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/income'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'income'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">income</span><span class="p">():</span>
    <span class="s2">"Income statement."</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span><span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Income Statement"</span><span class="p">,</span>
                       <span class="n">contents</span><span class="o">=</span><span class="n">render_real_report</span><span class="p">(</span><span class="n">balance_reports</span><span class="o">.</span><span class="n">IncomeStatementReport</span><span class="p">,</span>
                                                   <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">real_accounts</span><span class="p">,</span>
                                                   <span class="n">app</span><span class="o">.</span><span class="n">price_map</span><span class="p">,</span>
                                                   <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">price_date</span><span class="p">,</span>
                                                   <span class="n">leaf_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.index">
<code class="highlight language-python">
index<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.index" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Index of all pages, so that navigation need not have all links.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/index'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'index'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="s2">"Index of all pages, so that navigation need not have all links."</span>

    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;ul&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">page</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">"Balances"</span><span class="p">,</span> <span class="s2">"trial"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Balance Sheet"</span><span class="p">,</span> <span class="s2">"balsheet"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Opening Balances"</span><span class="p">,</span> <span class="s2">"openbal"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Income Statement"</span><span class="p">,</span> <span class="s2">"income"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"General Journal"</span><span class="p">,</span> <span class="s2">"journal_all"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Conversions"</span><span class="p">,</span> <span class="s2">"conversions"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Documents"</span><span class="p">,</span> <span class="s2">"documents"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Holdings (Full Detail)"</span><span class="p">,</span> <span class="s2">"holdings"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Holdings by Account"</span><span class="p">,</span> <span class="s2">"holdings_byaccount"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Holdings by Root Account"</span><span class="p">,</span> <span class="s2">"holdings_byrootaccount"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Holdings by Commodity"</span><span class="p">,</span> <span class="s2">"holdings_bycommodity"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Holdings by Currency"</span><span class="p">,</span> <span class="s2">"holdings_bycurrency"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Net Worth"</span><span class="p">,</span> <span class="s2">"networth"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Commodities"</span><span class="p">,</span> <span class="s2">"commodities"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Events"</span><span class="p">,</span> <span class="s2">"event_index"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Activity/Update"</span><span class="p">,</span> <span class="s2">"activity"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Statistics (Types)"</span><span class="p">,</span> <span class="s2">"stats_types"</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">"Statistics (Postings)"</span><span class="p">,</span> <span class="s2">"stats_postings"</span><span class="p">),</span>
    <span class="p">]:</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;li&gt;&lt;a href=</span><span class="si">{}</span><span class="s1">&gt;</span><span class="si">{}</span><span class="s1">&lt;/a&gt;&lt;/li&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span><span class="n">page</span><span class="p">),</span> <span class="n">title</span><span class="p">))</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/ul&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Index"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.journal_">
<code class="highlight language-python">
journal_<span class="p">(</span><span class="n">account_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.journal_" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A list of all the entries for this account realization.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/journal/&lt;account_name:re:.*&gt;'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'journal'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">journal_</span><span class="p">(</span><span class="n">account_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="s2">"A list of all the entries for this account realization."</span>
    <span class="n">account_name</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">account_xform</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>

    <span class="c1"># Figure out which account to render this from.</span>
    <span class="n">real_accounts</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">real_accounts</span>
    <span class="k">if</span> <span class="n">account_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">account_name</span> <span class="ow">and</span> <span class="n">account_types</span><span class="o">.</span><span class="n">is_balance_sheet_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span>
                                                                   <span class="n">app</span><span class="o">.</span><span class="n">account_types</span><span class="p">):</span>
            <span class="n">real_accounts</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">closing_real_accounts</span>

    <span class="c1"># Render the report.</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">account_name</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'--account=</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span><span class="p">))</span>

    <span class="n">render_postings</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'postings'</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">render_postings</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">render_postings</span> <span class="o">=</span> <span class="n">render_postings</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'1'</span><span class="p">,</span> <span class="s1">'true'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">render_postings</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'--verbose'</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">html_journal</span> <span class="o">=</span> <span class="n">render_real_report</span><span class="p">(</span><span class="n">journal_reports</span><span class="o">.</span><span class="n">JournalReport</span><span class="p">,</span>
                                          <span class="n">real_accounts</span><span class="p">,</span>
                                          <span class="n">app</span><span class="o">.</span><span class="n">price_map</span><span class="p">,</span>
                                          <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">price_date</span><span class="p">,</span>
                                          <span class="n">args</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">bottle</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="s1">'</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span><span class="n">pagetitle</span><span class="o">=</span><span class="s1">'</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span> <span class="ow">or</span>
                                             <span class="s1">'General Ledger (All Accounts)'</span><span class="p">),</span>
                       <span class="n">contents</span><span class="o">=</span><span class="n">html_journal</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.journal_all">
<code class="highlight language-python">
journal_all<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.journal_all" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A list of all the entries in this realization.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>731
732
733
734</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/journal/all'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'journal_all'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">journal_all</span><span class="p">():</span>
    <span class="s2">"A list of all the entries in this realization."</span>
    <span class="n">bottle</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span><span class="s1">'journal'</span><span class="p">,</span> <span class="n">account_name</span><span class="o">=</span><span class="s1">''</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.link">
<code class="highlight language-python">
link<span class="p">(</span><span class="n">link</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.link" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Serve journals for links.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>366
367
368
369
370
371
372
373
374
375
376
377
378
379</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/link/&lt;link:re:.*&gt;'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'link'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">link</span><span class="p">(</span><span class="n">link</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="s2">"Serve journals for links."</span>

    <span class="n">linked_entries</span> <span class="o">=</span> <span class="n">basicops</span><span class="o">.</span><span class="n">filter_link</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">entries</span><span class="p">)</span>

    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">HTMLFormatter</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">'dcontext'</span><span class="p">],</span>
                              <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get_url</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">account_xform</span><span class="p">,</span>
                              <span class="n">view_links</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">journal_html</span><span class="o">.</span><span class="n">html_entries_table_with_balance</span><span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">linked_entries</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_global</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Link: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">),</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.main">
<code class="highlight language-python">
main<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.main" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Main web service runner. This runs the event loop and blocks indefinitely.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1210
1211
1212
1213
1214
1215
1216
1217</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">"""Main web service runner. This runs the event loop and blocks indefinitely."""</span>

    <span class="n">argparser</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">add_web_arguments</span><span class="p">(</span><span class="n">argparser</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">argparser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">run_app</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.month_request">
<code class="highlight language-python">
month_request<span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.month_request" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a URL to a particular month of the context's request.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>491
492
493
494
495
496
497
498
499</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">month_request</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">):</span>
    <span class="sd">"""Render a URL to a particular month of the context's request.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="n">app</span><span class="o">.</span><span class="n">active_years</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">year</span> <span class="o">&gt;</span> <span class="n">app</span><span class="o">.</span><span class="n">active_years</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s1">''</span>
    <span class="n">month</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">month</span><span class="p">)</span>
    <span class="n">month</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{:0&gt;2d}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">month</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">'month'</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.networth">
<code class="highlight language-python">
networth<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.networth" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of the net worth for this filter.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>720
721
722
723
724
725
726
727</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/equity/networth'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'networth'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">networth</span><span class="p">():</span>
    <span class="s2">"Render a table of the net worth for this filter."</span>

    <span class="n">html_table</span> <span class="o">=</span> <span class="n">render_report</span><span class="p">(</span><span class="n">holdings_reports</span><span class="o">.</span><span class="n">NetWorthReport</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Net Worth"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">html_table</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.openbal">
<code class="highlight language-python">
openbal<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.openbal" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Opening balances.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>639
640
641
642
643
644
645
646
647</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/openbal'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'openbal'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">openbal</span><span class="p">():</span>
    <span class="s2">"Opening balances."</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span><span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Opening Balances"</span><span class="p">,</span>
                       <span class="n">contents</span><span class="o">=</span><span class="n">render_real_report</span><span class="p">(</span><span class="n">balance_reports</span><span class="o">.</span><span class="n">BalanceSheetReport</span><span class="p">,</span>
                                                   <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">opening_real_accounts</span><span class="p">,</span>
                                                   <span class="n">app</span><span class="o">.</span><span class="n">price_map</span><span class="p">,</span>
                                                   <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">price_date</span><span class="p">,</span>
                                                   <span class="n">leaf_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.populate_view">
<code class="highlight language-python">
populate_view<span class="p">(</span><span class="n">callback</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.populate_view" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A plugin that will populate the request with the current view instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>callback</code></td>
<td><code></code></td>
<td>
<p>A continuation function to call to handle the request.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A function to call to install view-specific parameters on the request.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>912
913
914
915
916
917
918
919
920
921
922
923</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">populate_view</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
    <span class="sd">"""A plugin that will populate the request with the current view instance.</span>

<span class="sd">    Args:</span>
<span class="sd">      callback: A continuation function to call to handle the request.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A function to call to install view-specific parameters on the request.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">request</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'VIEW'</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.prices_values">
<code class="highlight language-python">
prices_values<span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quote</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.prices_values" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render all the values for a particular price pair.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>802
803
804
805
806
807
808
809
810
811
812</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/prices'</span>
               <span class="sa">r</span><span class="s1">'/&lt;base:re:[A-Z][A-Z0-9</span><span class="se">\'</span><span class="s1">\.\_\-]{0,22}[A-Z0-9]&gt;'</span>
               <span class="sa">r</span><span class="s1">'/&lt;quote:re:[A-Z][A-Z0-9</span><span class="se">\'</span><span class="s1">\.\_\-]{0,22}[A-Z0-9]&gt;'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'prices'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">prices_values</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quote</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="s2">"Render all the values for a particular price pair."</span>
    <span class="n">html_table</span> <span class="o">=</span> <span class="n">render_report</span><span class="p">(</span><span class="n">price_reports</span><span class="o">.</span><span class="n">CommodityPricesReport</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
                               <span class="p">[</span><span class="s1">'--commodity'</span><span class="p">,</span> <span class="s1">'</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="p">)],</span>
                               <span class="n">css_id</span><span class="o">=</span><span class="s1">'price-index'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Price: </span><span class="si">{}</span><span class="s2"> / </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="p">),</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">html_table</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_global">
<code class="highlight language-python">
render_global<span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.render_global" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the title and contents in our standard template for a global page.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*args</code></td>
<td><code></code></td>
<td>
<p>A tuple of values for the HTML template.</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>*kw</code></td>
<td><code></code></td>
<td>
<p>A dict of optional values for the HTML template.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An HTML string of the rendered template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_global</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">"""Render the title and contents in our standard template for a global page.</span>

<span class="sd">    Args:</span>
<span class="sd">      *args: A tuple of values for the HTML template.</span>
<span class="sd">      *kw: A dict of optional values for the HTML template.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An HTML string of the rendered template.</span>
<span class="sd">    """</span>
    <span class="n">response</span><span class="o">.</span><span class="n">content_type</span> <span class="o">=</span> <span class="s1">'text/html'</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'A'</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span> <span class="c1"># Application mapper</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'V'</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span> <span class="c1"># View mapper</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'view_title'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'navigation'</span><span class="p">]</span> <span class="o">=</span> <span class="n">GLOBAL_NAVIGATION</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'scripts'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'scripts'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>

    <span class="n">kw</span><span class="p">[</span><span class="s1">'overlay'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">render_overlay</span><span class="p">(</span><span class="s1">'&lt;li&gt;&lt;a href="</span><span class="si">{}</span><span class="s1">"&gt;Errors&lt;/a&gt;&lt;/li&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">'errors'</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'render_overlay'</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span> <span class="s1">''</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_overlay">
<code class="highlight language-python">
render_overlay<span class="p">(</span><span class="n">contents</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.render_overlay" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render an overlay of the navigation with the current errors.</p>
<p>This is used to bring up new errors on any page when they occur.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML for the contents of the errors overlay.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>217
218
219
220
221
222
223
224
225
226
227
228
229
230</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_overlay</span><span class="p">(</span><span class="n">contents</span><span class="p">):</span>
    <span class="sd">"""Render an overlay of the navigation with the current errors.</span>

<span class="sd">    This is used to bring up new errors on any page when they occur.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A string of HTML for the contents of the errors overlay.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="s1">'''</span>
<span class="s1">      &lt;div class="navigation" id="nav-right"&gt;</span>
<span class="s1">        &lt;ul&gt;</span>
<span class="s1">          </span><span class="si">{}</span><span class="s1"></span>
<span class="s1">        &lt;/ul&gt;</span>
<span class="s1">      &lt;/div&gt;'''</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_real_report">
<code class="highlight language-python">
render_real_report<span class="p">(</span><span class="n">report_class</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.render_real_report" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Instantiate a report and rendering it to a string.</p>
<p>This is intended to be called in the context of a Bottle view app request
(it uses 'request').</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>report_class</code></td>
<td><code></code></td>
<td>
<p>A class, the type of the report to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price map as built by build_price_map().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_date</code></td>
<td><code></code></td>
<td>
<p>The date at which to evaluate the prices.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>args</code></td>
<td><code></code></td>
<td>
<p>A list of strings, the arguments to initialize the report with.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>leaf_only</code></td>
<td><code></code></td>
<td>
<p>A boolean, whether to render the leaf names only.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered report.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_real_report</span><span class="p">(</span><span class="n">report_class</span><span class="p">,</span> <span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span>
                       <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># pylint: disable=too-many-arguments</span>
    <span class="sd">"""Instantiate a report and rendering it to a string.</span>

<span class="sd">    This is intended to be called in the context of a Bottle view app request</span>
<span class="sd">    (it uses 'request').</span>

<span class="sd">    Args:</span>
<span class="sd">      report_class: A class, the type of the report to render.</span>
<span class="sd">      real_root: An instance of RealAccount to render.</span>
<span class="sd">      price_map: A price map as built by build_price_map().</span>
<span class="sd">      price_date: The date at which to evaluate the prices.</span>
<span class="sd">      args: A list of strings, the arguments to initialize the report with.</span>
<span class="sd">      leaf_only: A boolean, whether to render the leaf names only.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the rendered report.</span>
<span class="sd">    """</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">HTMLFormatter</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">'dcontext'</span><span class="p">],</span>
                              <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get_url</span><span class="p">,</span> <span class="n">leaf_only</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">account_xform</span><span class="p">)</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">report_</span> <span class="o">=</span> <span class="n">report_class</span><span class="o">.</span><span class="n">from_args</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="n">formatter</span><span class="p">)</span>
    <span class="n">report_</span><span class="o">.</span><span class="n">render_real_htmldiv</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">price_date</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="n">oss</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_report">
<code class="highlight language-python">
render_report<span class="p">(</span><span class="n">report_class</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">css_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">css_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.render_report" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Instantiate a report and rendering it to a string.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>report_class</code></td>
<td><code></code></td>
<td>
<p>A class, the type of the report to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>args</code></td>
<td><code></code></td>
<td>
<p>A list of strings, the arguments to initialize the report with.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>css_id</code></td>
<td><code></code></td>
<td>
<p>An optional string, the CSS id for the div to render.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>css_class</code></td>
<td><code></code></td>
<td>
<p>An optional string, the CSS class for the div to render.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>center</code></td>
<td><code></code></td>
<td>
<p>A boolean flag, if true, wrap the results in a &lt;center&gt; tag.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>leaf_only</code></td>
<td><code></code></td>
<td>
<p>A boolean, whether to render the leaf names only.</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered report.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_report</span><span class="p">(</span><span class="n">report_class</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">css_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">css_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">"""Instantiate a report and rendering it to a string.</span>

<span class="sd">    Args:</span>
<span class="sd">      report_class: A class, the type of the report to render.</span>
<span class="sd">      real_root: An instance of RealAccount to render.</span>
<span class="sd">      args: A list of strings, the arguments to initialize the report with.</span>
<span class="sd">      css_id: An optional string, the CSS id for the div to render.</span>
<span class="sd">      css_class: An optional string, the CSS class for the div to render.</span>
<span class="sd">      center: A boolean flag, if true, wrap the results in a &lt;center&gt; tag.</span>
<span class="sd">      leaf_only: A boolean, whether to render the leaf names only.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the rendered report.</span>
<span class="sd">    """</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">HTMLFormatter</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">'dcontext'</span><span class="p">],</span>
                              <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get_url</span><span class="p">,</span> <span class="n">leaf_only</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">account_xform</span><span class="p">)</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">center</span><span class="p">:</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;center&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">report_</span> <span class="o">=</span> <span class="n">report_class</span><span class="o">.</span><span class="n">from_args</span><span class="p">(</span><span class="n">args</span><span class="p">,</span>
                                     <span class="n">formatter</span><span class="o">=</span><span class="n">formatter</span><span class="p">,</span>
                                     <span class="n">css_id</span><span class="o">=</span><span class="n">css_id</span><span class="p">,</span>
                                     <span class="n">css_class</span><span class="o">=</span><span class="n">css_class</span><span class="p">)</span>
    <span class="n">report_</span><span class="o">.</span><span class="n">render_htmldiv</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="n">oss</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">center</span><span class="p">:</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/center&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_view">
<code class="highlight language-python">
render_view<span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.render_view" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the title and contents in our standard template for a view page.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*args</code></td>
<td><code></code></td>
<td>
<p>A tuple of values for the HTML template.</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>*kw</code></td>
<td><code></code></td>
<td>
<p>A dict of optional values for the HTML template.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An HTML string of the rendered template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">render_view</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">"""Render the title and contents in our standard template for a view page.</span>

<span class="sd">    Args:</span>
<span class="sd">      *args: A tuple of values for the HTML template.</span>
<span class="sd">      *kw: A dict of optional values for the HTML template.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An HTML string of the rendered template.</span>
<span class="sd">    """</span>
    <span class="n">response</span><span class="o">.</span><span class="n">content_type</span> <span class="o">=</span> <span class="s1">'text/html'</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'A'</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span> <span class="c1"># Application mapper</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'V'</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span> <span class="c1"># View mapper</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'view_title'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">' - '</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">title</span>

    <span class="n">overlays</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'render_overlay'</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">overlays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s1">'&lt;li&gt;&lt;a href="</span><span class="si">{}</span><span class="s1">"&gt;Errors&lt;/a&gt;&lt;/li&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">'errors'</span><span class="p">)))</span>

    <span class="c1"># Render navigation, with monthly navigation option.</span>
    <span class="n">oss</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">APP_NAVIGATION</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span> <span class="n">view_title</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">title</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">monthly</span> <span class="ow">is</span> <span class="n">views</span><span class="o">.</span><span class="n">MonthNavigation</span><span class="o">.</span><span class="n">COMPACT</span><span class="p">:</span>
        <span class="n">overlays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s1">'&lt;li&gt;&lt;a href="</span><span class="si">{}</span><span class="s1">"&gt;Monthly&lt;/a&gt;&lt;/li&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">Jan</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">monthly</span> <span class="ow">is</span> <span class="n">views</span><span class="o">.</span><span class="n">MonthNavigation</span><span class="o">.</span><span class="n">FULL</span><span class="p">:</span>
        <span class="n">annual</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">'year'</span><span class="p">,</span>
                                  <span class="n">path</span><span class="o">=</span><span class="n">DEFAULT_VIEW_REDIRECT</span><span class="p">,</span>
                                  <span class="n">year</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
        <span class="n">oss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">APP_NAVIGATION_MONTHLY_FULL</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">Mp</span><span class="o">=</span><span class="n">Mp</span><span class="p">,</span> <span class="n">Mn</span><span class="o">=</span><span class="n">Mn</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">V</span><span class="p">,</span> <span class="n">annual</span><span class="o">=</span><span class="n">annual</span><span class="p">))</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'navigation'</span><span class="p">]</span> <span class="o">=</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
    <span class="n">kw</span><span class="p">[</span><span class="s1">'overlay'</span><span class="p">]</span> <span class="o">=</span> <span class="n">render_overlay</span><span class="p">(</span><span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">overlays</span><span class="p">))</span>

    <span class="n">kw</span><span class="p">[</span><span class="s1">'scripts'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'scripts'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.root">
<code class="highlight language-python">
root<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.root" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Redirect the root page to the home page.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>262
263
264
265</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'root'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">root</span><span class="p">():</span>
    <span class="s2">"Redirect the root page to the home page."</span>
    <span class="n">bottle</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span><span class="s1">'toc'</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.scrape_webapp">
<code class="highlight language-python">
scrape_webapp<span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">ignore_regexp</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_colons</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">extra_args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.scrape_webapp" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Run a web server on a Beancount file and scrape it.</p>
<p>This is the main entry point of this module.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the file to parse.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code></code></td>
<td>
<p>A callback function to invoke on each page to validate it.
The function is called with the response and the url as arguments.
This function should trigger an error on failure (via an exception).</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>port</code></td>
<td><code></code></td>
<td>
<p>An integer, a free port to use for serving the pages.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>ignore_regexp</code></td>
<td><code></code></td>
<td>
<p>A regular expression string, the urls to ignore.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>quiet</code></td>
<td><code></code></td>
<td>
<p>True if we shouldn't log the web server pages.</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>no_colons</code></td>
<td><code></code></td>
<td>
<p>True if we should avoid rendering colons in URLs (for Windows).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>extra_args</code></td>
<td><code></code></td>
<td>
<p>Extra arguments to bean-web that we want to start the
server with.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of all the processed URLs and a set of all the skipped URLs.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">scrape_webapp</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">ignore_regexp</span><span class="p">,</span>
                  <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_colons</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">extra_args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Run a web server on a Beancount file and scrape it.</span>

<span class="sd">    This is the main entry point of this module.</span>

<span class="sd">    Args:</span>
<span class="sd">      filename: A string, the name of the file to parse.</span>
<span class="sd">      callback: A callback function to invoke on each page to validate it.</span>
<span class="sd">        The function is called with the response and the url as arguments.</span>
<span class="sd">        This function should trigger an error on failure (via an exception).</span>
<span class="sd">      port: An integer, a free port to use for serving the pages.</span>
<span class="sd">      ignore_regexp: A regular expression string, the urls to ignore.</span>
<span class="sd">      quiet: True if we shouldn't log the web server pages.</span>
<span class="sd">      no_colons: True if we should avoid rendering colons in URLs (for Windows).</span>
<span class="sd">      extra_args: Extra arguments to bean-web that we want to start the</span>
<span class="sd">        server with.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A set of all the processed URLs and a set of all the skipped URLs.</span>
<span class="sd">    """</span>
    <span class="n">url_format</span> <span class="o">=</span> <span class="s1">'http://localhost:</span><span class="si">{}</span><span class="s1">{{}}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>

    <span class="c1"># Create a set of valid arguments to run the app.</span>
    <span class="n">argparser</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">group</span> <span class="o">=</span> <span class="n">add_web_arguments</span><span class="p">(</span><span class="n">argparser</span><span class="p">)</span>
    <span class="n">group</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                       <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                       <span class="n">no_colons</span><span class="o">=</span><span class="n">no_colons</span><span class="p">,</span>
                       <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">)</span>

    <span class="n">all_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">filename</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">extra_args</span><span class="p">:</span>
        <span class="n">all_args</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extra_args</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">argparser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">all_args</span><span class="p">)</span>

    <span class="n">thread</span> <span class="o">=</span> <span class="n">thread_server_start</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="c1"># Skips:</span>
    <span class="c1"># - Docs cannot be read for external files.</span>
    <span class="c1">#</span>
    <span class="c1"># - Components views... well there are just too many, makes the tests</span>
    <span class="c1">#   impossibly slow. Just keep the A's so some are covered.</span>
    <span class="n">url_lists</span> <span class="o">=</span> <span class="n">scrape</span><span class="o">.</span><span class="n">scrape_urls</span><span class="p">(</span><span class="n">url_format</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">ignore_regexp</span><span class="p">)</span>

    <span class="n">thread_server_shutdown</span><span class="p">(</span><span class="n">thread</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">url_lists</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.setup_monkey_patch_for_server_shutdown">
<code class="highlight language-python">
setup_monkey_patch_for_server_shutdown<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.setup_monkey_patch_for_server_shutdown" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Setup globals to steal access to the server reference.
This is required to initiate shutdown, unfortunately.
(Bottle could easily remedy that.)</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">setup_monkey_patch_for_server_shutdown</span><span class="p">():</span>
    <span class="sd">"""Setup globals to steal access to the server reference.</span>
<span class="sd">    This is required to initiate shutdown, unfortunately.</span>
<span class="sd">    (Bottle could easily remedy that.)"""</span>

    <span class="c1"># Save the original function.</span>
    <span class="kn">from</span> <span class="nn">wsgiref.simple_server</span> <span class="kn">import</span> <span class="n">make_server</span>

    <span class="c1"># Create a decorator that will save the server upon start.</span>
    <span class="k">def</span> <span class="nf">stealing_make_server</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">server</span>
        <span class="n">server</span> <span class="o">=</span> <span class="n">make_server</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">server</span>

    <span class="c1"># Patch up wsgiref itself with the decorated function.</span>
    <span class="kn">import</span> <span class="nn">wsgiref.simple_server</span>
    <span class="n">wsgiref</span><span class="o">.</span><span class="n">simple_server</span><span class="o">.</span><span class="n">make_server</span> <span class="o">=</span> <span class="n">stealing_make_server</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.shutdown">
<code class="highlight language-python">
shutdown<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.shutdown" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Request for the server to shutdown.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1171
1172
1173</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">shutdown</span><span class="p">():</span>
    <span class="sd">"""Request for the server to shutdown."""</span>
    <span class="n">server</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.source">
<code class="highlight language-python">
source<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.source" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the source file, allowing scrolling at a specific line.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/source'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'source'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">source</span><span class="p">():</span>
    <span class="s2">"Render the source file, allowing scrolling at a specific line."</span>

    <span class="n">contents</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">no_source</span><span class="p">:</span>
        <span class="n">contents</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"Source hidden."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">contents</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;div id="source"&gt;'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()):</span>
            <span class="n">lineno</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">contents</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s1">'&lt;pre id="</span><span class="si">{lineno}</span><span class="s1">"&gt;</span><span class="si">{lineno}</span><span class="s1">  </span><span class="si">{line}</span><span class="s1">&lt;/pre&gt;</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">lineno</span><span class="o">=</span><span class="n">lineno</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()))</span>
        <span class="n">contents</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'&lt;/div&gt;'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_global</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Source"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">contents</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
        <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.stats_postings">
<code class="highlight language-python">
stats_postings<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.stats_postings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute and render statistics about the input file.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>865
866
867
868
869
870
871</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/stats_postings'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'stats_postings'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">stats_postings</span><span class="p">():</span>
    <span class="s2">"Compute and render statistics about the input file."</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Postings Statistics"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">render_report</span><span class="p">(</span><span class="n">misc_reports</span><span class="o">.</span><span class="n">StatsPostingsReport</span><span class="p">,</span>
                               <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.stats_types">
<code class="highlight language-python">
stats_types<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.stats_types" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute and render statistics about the input file.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>857
858
859
860
861
862
863</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/stats_types'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'stats_types'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">stats_types</span><span class="p">():</span>
    <span class="s2">"Compute and render statistics about the input file."</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Directives Statistics"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">render_report</span><span class="p">(</span><span class="n">misc_reports</span><span class="o">.</span><span class="n">StatsDirectivesReport</span><span class="p">,</span>
                               <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">entries</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.style">
<code class="highlight language-python">
style<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.style" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Stylesheet for the entire document.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>438
439
440
441
442
443
444
445</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/resources/web.css'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'style'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">style</span><span class="p">():</span>
    <span class="s2">"Stylesheet for the entire document."</span>
    <span class="n">response</span><span class="o">.</span><span class="n">content_type</span> <span class="o">=</span> <span class="s1">'text/css'</span>
    <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">'web.css'</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">global</span> <span class="n">STYLE</span><span class="p">;</span> <span class="n">STYLE</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">STYLE</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.thread_server_shutdown">
<code class="highlight language-python">
thread_server_shutdown<span class="p">(</span><span class="n">thread</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.thread_server_shutdown" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Shutdown the server running in the given thread.</p>
<p>Unfortauntely, in the meantime this has a side-effect on all servers.
This returns after waiting that the thread has stopped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>thread</code></td>
<td><code></code></td>
<td>
<p>A threading.Thread instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">thread_server_shutdown</span><span class="p">(</span><span class="n">thread</span><span class="p">):</span>
    <span class="sd">"""Shutdown the server running in the given thread.</span>

<span class="sd">    Unfortauntely, in the meantime this has a side-effect on all servers.</span>
<span class="sd">    This returns after waiting that the thread has stopped.</span>

<span class="sd">    Args:</span>
<span class="sd">      thread: A threading.Thread instance.</span>
<span class="sd">    """</span>
    <span class="c1"># Clean shutdown: request to stop, then join the thread.</span>
    <span class="c1"># Note that because we daemonize, we could forego this elegant detail.</span>
    <span class="n">shutdown</span><span class="p">()</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.thread_server_start">
<code class="highlight language-python">
thread_server_start<span class="p">(</span><span class="n">web_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.thread_server_start" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Start a server in a new thread.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>argparse_args</code></td>
<td><code></code></td>
<td>
<p>An argparse parsed options object, with all the options
from add_web_arguments().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new Thread instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">thread_server_start</span><span class="p">(</span><span class="n">web_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">"""Start a server in a new thread.</span>

<span class="sd">    Args:</span>
<span class="sd">      argparse_args: An argparse parsed options object, with all the options</span>
<span class="sd">        from add_web_arguments().</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new Thread instance.</span>

<span class="sd">    """</span>
    <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="n">run_app</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">web_args</span><span class="p">,),</span>
        <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Automatically exit if the process comes dwn.</span>
    <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># Ensure the server has at least started before running the scraper.</span>
    <span class="n">wait_ready</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">thread</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.trial">
<code class="highlight language-python">
trial<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.trial" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Trial balance / Chart of Accounts.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>616
617
618
619
620
621
622
623
624
625</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@viewapp</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/trial'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'trial'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">trial</span><span class="p">():</span>
    <span class="s2">"Trial balance / Chart of Accounts."</span>
    <span class="k">return</span> <span class="n">render_view</span><span class="p">(</span>
        <span class="n">pagetitle</span><span class="o">=</span><span class="s2">"Trial Balance"</span><span class="p">,</span>
        <span class="n">contents</span><span class="o">=</span><span class="n">render_real_report</span><span class="p">(</span><span class="n">balance_reports</span><span class="o">.</span><span class="n">BalancesReport</span><span class="p">,</span>
                                    <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">real_accounts</span><span class="p">,</span>
                                    <span class="n">app</span><span class="o">.</span><span class="n">price_map</span><span class="p">,</span>
                                    <span class="n">request</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">price_date</span><span class="p">,</span>
                                    <span class="n">leaf_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.url_restrict_generator">
<code class="highlight language-python">
url_restrict_generator<span class="p">(</span><span class="n">url_prefix</span><span class="p">)</span> </code>
<a class="headerlink" href="#beancount.web.web.url_restrict_generator" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Restrict to only a single prefix.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>url_prefix</code></td>
<td><code></code></td>
<td>
<p>A string, a URL prefix to restrict to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code></code></td>
<td>
<p>The function to wrap.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A handler decorator.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">url_restrict_generator</span><span class="p">(</span><span class="n">url_prefix</span><span class="p">):</span>
    <span class="sd">"""Restrict to only a single prefix.</span>

<span class="sd">    Args:</span>
<span class="sd">      url_prefix: A string, a URL prefix to restrict to.</span>
<span class="sd">      callback: The function to wrap.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A handler decorator.</span>
<span class="sd">    """</span>
    <span class="c1"># A list of URLs that should always be accepted, even when restricted.</span>
    <span class="n">allowed_regexps</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">regexp</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>
                       <span class="k">for</span> <span class="n">regexp</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'/web.css'</span><span class="p">,</span>
                                      <span class="s1">'/favicon.ico'</span><span class="p">,</span>
                                      <span class="s1">'/toc'</span><span class="p">,</span>
                                      <span class="s1">'/errors'</span><span class="p">,</span>
                                      <span class="s1">'/source'</span><span class="p">,</span>
                                      <span class="s1">'/link'</span><span class="p">,</span>
                                      <span class="s1">'/context'</span><span class="p">,</span>
                                      <span class="s1">'/third_party'</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">url_restrict_handler</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">match</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">allowed_regexps</span><span class="p">)</span> <span class="ow">or</span>
                <span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">url_prefix</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">path</span> <span class="o">==</span> <span class="s1">'/'</span><span class="p">:</span>
                <span class="n">bottle</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="n">url_prefix</span><span class="p">)</span>

            <span class="c1"># Note: we issue a "202 Accepted" status in order to satisfy bean-bake,</span>
            <span class="c1"># we want to distinguish between an actual 404 error and this case.</span>
            <span class="k">raise</span> <span class="n">bottle</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="mi">202</span><span class="p">,</span> <span class="s2">"URLs restricted to '</span><span class="si">{}</span><span class="s2">'"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url_prefix</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">wrapper</span>
    <span class="k">return</span> <span class="n">url_restrict_handler</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.wait_ready">
<code class="highlight language-python">
wait_ready<span class="p">()</span> </code>
<a class="headerlink" href="#beancount.web.web.wait_ready" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Wait until the 'server' global has been set.
This tells us the server is running.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1164
1165
1166
1167
1168
1169</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">wait_ready</span><span class="p">():</span>
    <span class="sd">"""Wait until the 'server' global has been set.</span>
<span class="sd">    This tells us the server is running.</span>
<span class="sd">    """</span>
    <span class="k">while</span> <span class="n">server</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral" href="beancount.utils.html" title="beancount.utils"><span class="icon icon-circle-arrow-left"></span> Previous</a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<a class="fa fa-github" href="https://github.com/xuhcc/beancount-docs/" style="float: left; color: #fcfcfc"> GitHub</a>
<span><a href="beancount.utils.html" style="color: #fcfcfc;">« Previous</a></span>
</span>
</div>
<script>var base_url = '..';</script>
<script defer="" src="../js/theme.js"></script>
<script defer="" src="../js/extra.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
</body>
</html>
