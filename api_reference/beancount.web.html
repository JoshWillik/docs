<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://beancount.github.io/docs/api_reference/beancount.web.html" rel="canonical"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>beancount.web - Beancount Documentation</title>
<link href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet">
<link href="../css/theme.css" rel="stylesheet">
<link href="../css/theme_extra.css" rel="stylesheet"/>
<link href="../css/custom.css" rel="stylesheet"/>
<script>
    // Current page data
    var mkdocs_page_name = "beancount.web";
    var mkdocs_page_input_path = "api_reference/beancount.web.md";
    var mkdocs_page_url = "/docs/api_reference/beancount.web.html";
  </script>
<script defer="" src="../js/jquery-2.1.1.min.js"></script>
<script defer="" src="../js/modernizr-2.8.3.min.js"></script>
</link></link></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href=".."> Beancount Documentation</a>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Index</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Outline</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Users</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../command_line_accounting_in_context.html">Command Line Accounting in Context</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../the_double_entry_counting_method.html">The Double Entry Counting Method</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installing_beancount.html">Installing Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../running_beancount_and_generating_reports.html">Running Beancount and Generating Reports</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started_with_beancount.html">Getting Started with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_language_syntax.html">Beancount Language Syntax</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_options_reference.html">Beancount Options Reference</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../precision_tolerances.html">Precision Tolerances</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_query_language.html">Beancount Query Language</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_cheat_sheet.html">Beancount Cheat Sheet</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../how_inventories_work.html">How Inventories Work</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../exporting_your_portfolio.html">Exporting Your Portfolio</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_example.html">Tutorial &amp; Example</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_history_and_credits.html">Beancount History and Credits</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../a_comparison_of_beancount_and_ledger_hledger.html">A Comparison of Beancount and Ledger Hledger</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fetching_prices_in_beancount.html">Fetching Prices in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../importing_external_data.html">Importing External Data</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Cookbooks &amp; Examples</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../command_line_accounting_cookbook.html">Command Line Accounting Cookbook</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../trading_with_beancount.html">Trading with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stock_vesting_in_beancount.html">Stock Vesting in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sharing_expenses_with_beancount.html">Sharing Expenses with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../how_we_share_expenses.html">How We Share Expenses</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../health_care_expenses.html">Health Care Expenses</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../calculating_portolio_returns.html">Calculating Portfolio Returns</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Developers</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../beancount_scripting_plugins.html">Beancount Scripting Plugins</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_design_doc.html">Beancount Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ledgerhub_design_doc.html">Ledgerhub Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../external_contributions.html">External Contributions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Enhancement Proposals &amp; Discussions</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../a_proposal_for_an_improvement_on_inventory_booking.html">A Proposal for an Improvement on Inventory Booking</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../settlement_dates_in_beancount.html">Settlement Dates in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../balance_assertions_in_beancount.html">Balance Assertions in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fund_accounting_with_beancount.html">Fund Accounting with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rounding_precision_in_beancount.html">Rounding Precision in Beancount</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Beancount 3</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../beancount_v3.html">Goals &amp; Design</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installing_beancount_v3.html">Installing Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_v3_dependencies.html">Dependencies</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">beancount</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.core.html">beancount.core</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ingest.html">beancount.ingest</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.loader.html">beancount.loader</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ops.html">beancount.ops</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.parser.html">beancount.parser</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.plugins.html">beancount.plugins</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.prices.html">beancount.prices</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.query.html">beancount.query</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.reports.html">beancount.reports</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.scripts.html">beancount.scripts</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.tools.html">beancount.tools</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.utils.html">beancount.utils</a>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="beancount.web.html">beancount.web</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#beancount.web">beancount.web</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.bottle_utils">bottle_utils</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.bottle_utils.AttrMapper">AttrMapper</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.bottle_utils.AttrMapper.__init__">__init__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.bottle_utils.internal_redirect">internal_redirect()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.scrape">scrape</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.scrape.iterlinks">iterlinks()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.scrape.scrape_urls">scrape_urls()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.scrape.validate_local_links">validate_local_links()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.scrape.validate_local_links_in_dir">validate_local_links_in_dir()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.views">views</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.AllView">AllView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.AllView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.ComponentView">ComponentView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.ComponentView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.ComponentView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.EmptyView">EmptyView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.EmptyView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.EmptyView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.MonthNavigation">MonthNavigation</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.MonthView">MonthView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.MonthView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.MonthView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.PayeeView">PayeeView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.PayeeView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.PayeeView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.TagView">TagView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.TagView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.TagView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.View">View</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.View.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.View.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.views.YearView">YearView</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.YearView.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.views.YearView.apply_filter">apply_filter()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.web.web">web</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.HTMLFormatter">HTMLFormatter</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.build_global">build_global()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_account">render_account()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_commodity">render_commodity()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_context">render_context()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_doc">render_doc()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_event_type">render_event_type()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_inventory">render_inventory()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_link">render_link()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.web.web.HTMLFormatter.render_source">render_source()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.activity">activity()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.auto_reload_input_file">auto_reload_input_file()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.balsheet">balsheet()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.commodities">commodities()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.context_">context_()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.conversions_">conversions_()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.doc">doc()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.documents">documents()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.errors">errors()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.event">event()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.event_index">event_index()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.get_all_view">get_all_view()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.handle_view">handle_view()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_">holdings_()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_byaccount">holdings_byaccount()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_bycommodity">holdings_bycommodity()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_bycurrency">holdings_bycurrency()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.holdings_byrootaccount">holdings_byrootaccount()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.incognito">incognito()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.income">income()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.index">index()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.journal_">journal_()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.journal_all">journal_all()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.link">link()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.main">main()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.month_request">month_request()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.networth">networth()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.openbal">openbal()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.populate_view">populate_view()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.prices_values">prices_values()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_global">render_global()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_overlay">render_overlay()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_real_report">render_real_report()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_report">render_report()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.render_view">render_view()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.root">root()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.scrape_webapp">scrape_webapp()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.setup_monkey_patch_for_server_shutdown">setup_monkey_patch_for_server_shutdown()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.shutdown">shutdown()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.source">source()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.stats_postings">stats_postings()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.stats_types">stats_types()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.style">style()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.thread_server_shutdown">thread_server_shutdown()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.thread_server_start">thread_server_start()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.trial">trial()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.url_restrict_generator">url_restrict_generator()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.web.web.wait_ready">wait_ready()</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="top navigation" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="..">Beancount Documentation</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a href="..">Docs</a> »</li>
<li>API reference »</li>
<li>beancount.web</li>
<li class="wy-breadcrumbs-aside">
<a class="icon icon-github" href="https://github.com/beancount/docs/edit/master/docs/api_reference/beancount.web.md"> Edit on GitHub</a>
</li>
</ul>
<hr/>
</div>
<div role="main">
<div class="section">
<h1 id="beancountweb">beancount.web<a class="headerlink" href="#beancountweb" title="Permanent link"></a></h1>
<div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#beancount.web" id="beancount.web" style="visibility: hidden; width: 0; height: 0;">
<a class="headerlink" href="#beancount.web" title="Permanent link"></a></h2>
<div class="doc doc-contents first">
<p>Web server reporting front-end.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.bottle_utils">
<code>beancount.web.bottle_utils</code>
<a class="headerlink" href="#beancount.web.bottle_utils" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Bottle utilities, mostly helpers to do mounts on top of dynamic routes.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.bottle_utils.AttrMapper">
<code>beancount.web.bottle_utils.AttrMapper</code>
<a class="headerlink" href="#beancount.web.bottle_utils.AttrMapper" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A URL mapper that allows attribute access for view-links.
    This is used in templates.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.bottle_utils.AttrMapper.__init__">
<code class="highlight language-python">
beancount.web.bottle_utils.AttrMapper.__init__
(self, mapper_function)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.bottle_utils.AttrMapper.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Constructor for an attribute mapper.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mapper_function</code></td>
<td><code></code></td>
<td>
<p>A function to apply on attribute lookup, and
upon calling .build().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/bottle_utils.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, mapper_function):
    """Constructor for an attribute mapper.

    Args:
      mapper_function: A function to apply on attribute lookup, and
        upon calling .build().
    """
    self.mapper_function = mapper_function
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.bottle_utils.internal_redirect">
<code class="highlight language-python">
beancount.web.bottle_utils.internal_redirect
(app, path_depth)

        </code>
<a class="headerlink" href="#beancount.web.bottle_utils.internal_redirect" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A version of bottle's mountpoint_wrapper() that we call explicitly.</p>
<p>Bottle supports a mount() method that allows on to install an application on
a subpath of the main application. However, it does this on a fixed path. We
want to manually intercept the lazy creation or fetching of a view and call
for a redirect explicitly (via bottle's mountpoint_wrapper() function).
However, this function is hidden within the scope of a the Bottle.mount()
method; if it were defined globally we would just use it, but it is not. So
we copy if here. This is directly lifted from Bottle.mount() and edited
minimally.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>app</code></td>
<td><code></code></td>
<td>
<p>A Bottle instance.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>path_depth</code></td>
<td><code></code></td>
<td>
<p>The number of request path components to skip for the mount.
For example, if our subapplication is mount on /view/all, then the path
depth is 2.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Bottle HTTPResponse object.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Exception</code></td>
<td>
<p>Any exception, depending on the callback.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/bottle_utils.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def internal_redirect(app, path_depth):
    """A version of bottle's mountpoint_wrapper() that we call explicitly.

    Bottle supports a mount() method that allows on to install an application on
    a subpath of the main application. However, it does this on a fixed path. We
    want to manually intercept the lazy creation or fetching of a view and call
    for a redirect explicitly (via bottle's mountpoint_wrapper() function).
    However, this function is hidden within the scope of a the Bottle.mount()
    method; if it were defined globally we would just use it, but it is not. So
    we copy if here. This is directly lifted from Bottle.mount() and edited
    minimally.

    Args:
      app: A Bottle instance.
      path_depth: The number of request path components to skip for the mount.
        For example, if our subapplication is mount on /view/all, then the path
        depth is 2.
    Returns:
      A Bottle HTTPResponse object.
    Raises:
      Exception: Any exception, depending on the callback.
    """
    # pylint: disable=invalid-name
    try:
        request.path_shift(path_depth)
        rs = bottle.HTTPResponse([])
        def start_response(status, headerlist, exc_info=None):
            if exc_info:
                try:
                    _raise(*exc_info)
                finally:
                    exc_info = None
            rs.status = status
            for name, value in headerlist: rs.add_header(name, value)
            return rs.body.append
        body = app(request.environ, start_response)
        if body and rs.body: body = itertools.chain(rs.body, body)
        rs.body = body or rs.body
        return rs
    finally:
        request.path_shift(-path_depth)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.scrape">
<code>beancount.web.scrape</code>
<a class="headerlink" href="#beancount.web.scrape" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.scrape.iterlinks">
<code class="highlight language-python">
beancount.web.scrape.iterlinks
(html, html_path)

        </code>
<a class="headerlink" href="#beancount.web.scrape.iterlinks" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Find links targets in HTML text.</p>
<p>This deals with both absolute and relative links, and it external links to
external sites.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>html</code></td>
<td><code></code></td>
<td>
<p>An lxml document node.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>html_path</code></td>
<td><code></code></td>
<td>
<p>The URL of the document node.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  URL strings, where found.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def iterlinks(html, html_path):
    """Find links targets in HTML text.

    This deals with both absolute and relative links, and it external links to
    external sites.

    Args:
      html: An lxml document node.
      html_path: The URL of the document node.
    Yields:
      URL strings, where found.

    """
    html_dir = path.dirname(html_path)
    for element, attribute, link, pos in lxml.html.iterlinks(html):
        url = urllib.parse.urlparse(link)
        if url.scheme or url.netloc:
            continue  # Skip external urls.
        link = url.path
        if not link:
            continue
        if not path.isabs(link):
            link = path.join(html_dir, link)
        yield link
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.scrape.scrape_urls">
<code class="highlight language-python">
beancount.web.scrape.scrape_urls
(url_format, callback, ignore_regexp=None)

        </code>
<a class="headerlink" href="#beancount.web.scrape.scrape_urls" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Recursively scrape pages from a web address.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>url_format</code></td>
<td><code></code></td>
<td>
<p>The pattern for building links from relative paths.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code></code></td>
<td>
<p>A callback function to invoke on each page to validate it.
The function is called with the response and the url as arguments.
This function should trigger an error on failure (via an exception).</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>ignore_regexp</code></td>
<td><code></code></td>
<td>
<p>A regular expression string, the urls to ignore.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of all the processed URLs and a set of all the skipped URLs.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def scrape_urls(url_format, callback, ignore_regexp=None):
    """Recursively scrape pages from a web address.

    Args:
      url_format: The pattern for building links from relative paths.
      callback: A callback function to invoke on each page to validate it.
        The function is called with the response and the url as arguments.
        This function should trigger an error on failure (via an exception).
      ignore_regexp: A regular expression string, the urls to ignore.
    Returns:
      A set of all the processed URLs and a set of all the skipped URLs.
    """
    # The set of all URLs seen so far.
    seen = set()

    # The list of all URLs to process. We use a list here so we have
    # reproducible order if we repeat the test.
    process_list = ["/"]

    # A set of all the URLs processed and skipped everywhere.
    all_processed_urls = set()
    all_skipped_urls = set()

    # Loop over all URLs remaining to process.
    while process_list:
        url = process_list.pop()

        logging.debug("Processing: %s", url)
        all_processed_urls.add(url)

        # Fetch the URL and check its return status.
        response = urllib.request.urlopen(url_format.format(url))

        # Generate errors on redirects.
        redirected_url = urllib.parse.urlparse(response.geturl()).path
        if redirected_url != url:
            logging.error("Redirected: %s -&gt; %s", url, redirected_url)

        # Read the contents. This can only be done once.
        response_contents = response.read()

        skipped_urls = set()
        content_type = response.info().get_content_type()
        if content_type == 'text/html':
            # Process all the links in the page and register all the unseen links to
            # be processed.
            html_root = lxml.html.document_fromstring(response_contents)
            for link in iterlinks(html_root, url):

                # Skip URLs to be ignored.
                if ignore_regexp and re.match(ignore_regexp, link):
                    logging.debug("Skipping: %s", link)
                    skipped_urls.add(link)
                    all_skipped_urls.add(link)
                    continue

                # Check if link has already been seen.
                if link in seen:
                    logging.debug('Seen: "%s"', link)
                    continue

                # Schedule the link for scraping.
                logging.debug('Scheduling: "%s"', link)
                process_list.append(link)
                seen.add(link)

        else:
            html_root = None

        # Call back for processing.
        callback(url, response, response_contents, html_root, skipped_urls)

    return all_processed_urls, all_skipped_urls
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.scrape.validate_local_links">
<code class="highlight language-python">
beancount.web.scrape.validate_local_links
(filename)

        </code>
<a class="headerlink" href="#beancount.web.scrape.validate_local_links" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Open and parse the given HTML filename and verify all local targets exist.</p>
<p>This checks that all the files pointed to by the file we're processing are
files that exist on disk. This can be used to validate that a baked output
does not have links to files that do not exist, that all the links are valid.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the HTML file to process.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A pair of</code></td>
<td>
<p>missing: A set of strings, the names of links to files that do not exist.
  empty: A boolean, true if this file is empty.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def validate_local_links(filename):
    """Open and parse the given HTML filename and verify all local targets exist.

    This checks that all the files pointed to by the file we're processing are
    files that exist on disk. This can be used to validate that a baked output
    does not have links to files that do not exist, that all the links are valid.

    Args:
      filename: A string, the name of the HTML file to process.
    Returns:
      A pair of:
        missing: A set of strings, the names of links to files that do not exist.
        empty: A boolean, true if this file is empty.
    """
    filedir = path.dirname(filename)
    contents = open(filename, 'rb').read()

    empty = len(contents) == 0
    missing = set()
    if not empty:
        html = lxml.html.document_fromstring(contents)
        if html is not None:
            for element, attribute, link, pos in lxml.html.iterlinks(html):
                urlpath = urllib.parse.urlparse(link)
                if urlpath.scheme or urlpath.netloc:
                    continue
                if path.isabs(urlpath.path):
                    continue
                target = path.normpath(path.join(filedir, urlpath.path))
                if not path.exists(target):
                    missing.add(target)

    return missing, empty
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.scrape.validate_local_links_in_dir">
<code class="highlight language-python">
beancount.web.scrape.validate_local_links_in_dir
(directory)

        </code>
<a class="headerlink" href="#beancount.web.scrape.validate_local_links_in_dir" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Find all the files under the given directory and validate all their links.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>directory</code></td>
<td><code></code></td>
<td>
<p>A string, the root directory whose files to process.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A tuple of</code></td>
<td>
<p>files: A list of all the filenames found and processed.
  missing: A set of strings, the names of links to files that do not exist.
  empty: A boolean, true if this file is empty.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/scrape.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def validate_local_links_in_dir(directory):
    """Find all the files under the given directory and validate all their links.

    Args:
      directory: A string, the root directory whose files to process.
    Returns:
      A tuple of:
        files: A list of all the filenames found and processed.
        missing: A set of strings, the names of links to files that do not exist.
        empty: A boolean, true if this file is empty.
    """
    logging.basicConfig(level=logging.INFO,
                        format='%(levelname)-8s: %(message)s')
    allfiles = []
    missing, empty = set(), set()
    for root, dirs, files in os.walk(directory):
        for filename in files:
            afilename = path.join(root, filename)
            allfiles.append(afilename)
            logging.info("Validating: '%s'", afilename)
            missing, is_empty = validate_local_links(afilename)
            if is_empty:
                empty.add(afilename)
    return allfiles, missing, empty
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.views">
<code>beancount.web.views</code>
<a class="headerlink" href="#beancount.web.views" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Views are filters on the global list of entries, which produces a subset of entries.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.AllView">
<code>beancount.web.views.AllView</code>
<a class="headerlink" href="#beancount.web.views.AllView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view that includes all the entries, unmodified.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.AllView.apply_filter">
<code class="highlight language-python">
beancount.web.views.AllView.apply_filter
(self, entries, options_map)

        </code>
<a class="headerlink" href="#beancount.web.views.AllView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def apply_filter(self, entries, options_map):
    return (entries, None, None)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.ComponentView">
<code>beancount.web.views.ComponentView</code>
<a class="headerlink" href="#beancount.web.views.ComponentView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view that includes transactions with at least one posting with an account
    that includes a given component.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.ComponentView.__init__">
<code class="highlight language-python">
beancount.web.views.ComponentView.__init__
(self, entries, options_map, title, component)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.ComponentView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view clamped to one year.</p>
<p>Note: this is the only view where the entries are summarized and
clamped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>component</code></td>
<td><code></code></td>
<td>
<p>A string, the name of an account component to include.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, entries, options_map, title, component):
    """Create a view clamped to one year.

    Note: this is the only view where the entries are summarized and
    clamped.

    Args:
      entries: A list of directives.
      options_map: A dict of options, as produced by the parser.
      title: A string, the title of this view.
      component: A string, the name of an account component to include.
    """
    assert isinstance(component, str)
    self.component = component
    View.__init__(self, entries, options_map, title)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.ComponentView.apply_filter">
<code class="highlight language-python">
beancount.web.views.ComponentView.apply_filter
(self, entries, options_map)

        </code>
<a class="headerlink" href="#beancount.web.views.ComponentView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def apply_filter(self, entries, options_map):
    component = self.component
    component_entries = [entry
                         for entry in entries
                         if data.has_entry_account_component(entry, component)]

    return component_entries, None, None
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.EmptyView">
<code>beancount.web.views.EmptyView</code>
<a class="headerlink" href="#beancount.web.views.EmptyView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An empty view, for testing.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.EmptyView.__init__">
<code class="highlight language-python">
beancount.web.views.EmptyView.__init__
    (self, entries, options_map, title, *
args, **
kw)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.EmptyView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create an empty view.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>*args</code></td>
<td><code></code></td>
<td>
<p>Ignored.</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>**kw</code></td>
<td><code></code></td>
<td>
<p>Ignored.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, entries, options_map, title, *args, **kw):
    """Create an empty view.

    Args:
      entries: A list of directives.
      options_map: A dict of options, as produced by the parser.
      title: A string, the title of this view.
      *args: Ignored.
      **kw: Ignored.
    """
    View.__init__(self, entries, options_map, title)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.EmptyView.apply_filter">
<code class="highlight language-python">
beancount.web.views.EmptyView.apply_filter
(self, _, __)

        </code>
<a class="headerlink" href="#beancount.web.views.EmptyView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the list of entries unmodified.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def apply_filter(self, _, __):
    "Return the list of entries unmodified."
    return ([], None, None)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.MonthNavigation">
<code>beancount.web.views.MonthNavigation</code>
<a class="headerlink" href="#beancount.web.views.MonthNavigation" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An enumeration.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.MonthView">
<code>beancount.web.views.MonthView</code>
<a class="headerlink" href="#beancount.web.views.MonthView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view of the entries for a single month.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.MonthView.__init__">
<code class="highlight language-python">
beancount.web.views.MonthView.__init__
(self, entries, options_map, title, year, month)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.MonthView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view clamped to one month.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>year</code></td>
<td><code></code></td>
<td>
<p>An integer, the year of period.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>month</code></td>
<td><code></code></td>
<td>
<p>An integer, the month to be used as year end.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, entries, options_map, title, year, month):
    """Create a view clamped to one month.

    Args:
      entries: A list of directives.
      options_map: A dict of options, as produced by the parser.
      title: A string, the title of this view.
      year: An integer, the year of period.
      month: An integer, the month to be used as year end.
    """
    self.year = year
    self.month = month
    View.__init__(self, entries, options_map, title)

    self.monthly = MonthNavigation.FULL
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.MonthView.apply_filter">
<code class="highlight language-python">
beancount.web.views.MonthView.apply_filter
(self, entries, options_map)

        </code>
<a class="headerlink" href="#beancount.web.views.MonthView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def apply_filter(self, entries, options_map):
    # Clamp to the desired period.
    begin_date = datetime.date(self.year, self.month, 1)
    end_date = date_utils.next_month(begin_date)

    with misc_utils.log_time('clamp', logging.info):
        entries, index = summarize.clamp_opt(entries,
                                             begin_date, end_date,
                                             options_map)
    return entries, index, end_date
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.PayeeView">
<code>beancount.web.views.PayeeView</code>
<a class="headerlink" href="#beancount.web.views.PayeeView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view that includes entries with some specific payee.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.PayeeView.__init__">
<code class="highlight language-python">
beancount.web.views.PayeeView.__init__
(self, entries, options_map, title, payee)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.PayeeView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view clamped to one year.</p>
<p>Note: this is the only view where the entries are summarized and
clamped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>payee</code></td>
<td><code></code></td>
<td>
<p>A string, the payee whose transactions to include.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, entries, options_map, title, payee):
    """Create a view clamped to one year.

    Note: this is the only view where the entries are summarized and
    clamped.

    Args:
      entries: A list of directives.
      options_map: A dict of options, as produced by the parser.
      title: A string, the title of this view.
      payee: A string, the payee whose transactions to include.
    """
    assert isinstance(payee, str)
    self.payee = payee
    View.__init__(self, entries, options_map, title)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.PayeeView.apply_filter">
<code class="highlight language-python">
beancount.web.views.PayeeView.apply_filter
(self, entries, options_map)

        </code>
<a class="headerlink" href="#beancount.web.views.PayeeView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def apply_filter(self, entries, options_map):
    payee = self.payee
    payee_entries = [entry
                     for entry in entries
                     if isinstance(entry, data.Transaction) and (entry.payee == payee)]

    return payee_entries, None, None
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.TagView">
<code>beancount.web.views.TagView</code>
<a class="headerlink" href="#beancount.web.views.TagView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view that includes only entries some specific tags.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.TagView.__init__">
<code class="highlight language-python">
beancount.web.views.TagView.__init__
(self, entries, options_map, title, tags)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.TagView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view with only entries tagged with the given tags.</p>
<p>Note: this is the only view where the entries are summarized and
clamped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>tags</code></td>
<td><code></code></td>
<td>
<p>A set of strings, the tags to include. Entries with at least
one of these tags will be included in the output.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, entries, options_map, title, tags):
    """Create a view with only entries tagged with the given tags.

    Note: this is the only view where the entries are summarized and
    clamped.

    Args:
      entries: A list of directives.
      options_map: A dict of options, as produced by the parser.
      title: A string, the title of this view.
      tags: A set of strings, the tags to include. Entries with at least
        one of these tags will be included in the output.
    """
    assert isinstance(tags, (set, frozenset, list, tuple))
    self.tags = tags
    View.__init__(self, entries, options_map, title)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.TagView.apply_filter">
<code class="highlight language-python">
beancount.web.views.TagView.apply_filter
(self, entries, options_map)

        </code>
<a class="headerlink" href="#beancount.web.views.TagView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def apply_filter(self, entries, options_map):
    tags = self.tags
    tagged_entries = [
        entry
        for entry in entries
        if isinstance(entry, data.Transaction) and entry.tags and (entry.tags &amp; tags)]

    return tagged_entries, None, None
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.View">
<code>beancount.web.views.View</code>
<a class="headerlink" href="#beancount.web.views.View" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A container for filtering a subset of entries and realizing that for
    display.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.View.__init__">
<code class="highlight language-python">
beancount.web.views.View.__init__
(self, all_entries, options_map, title)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.View.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Build a View instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>all_entries</code></td>
<td><code></code></td>
<td>
<p>The full list of directives as output from the loader.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>The options dict, as output by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view to render.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, all_entries, options_map, title):
    """Build a View instance.

    Args:
      all_entries: The full list of directives as output from the loader.
      options_map: The options dict, as output by the parser.
      title: A string, the title of this view to render.
    """

    # A reference to the full list of padded entries.
    self.all_entries = all_entries

    # List of filtered entries for this view, and index at the beginning
    # of the period transactions, past the opening balances. These are
    # computed in _initialize().
    self.entries = None
    self.opening_entries = None
    self.closing_entries = None

    # Title.
    self.title = title

    # Realization of the filtered entries to display. These are computed in
    # _initialize().
    self.real_accounts = None
    self.opening_real_accounts = None
    self.closing_real_accounts = None

    # Monthly navigation style.
    self.monthly = MonthNavigation.NONE

    # Realize now, we don't need to do this lazily because we create these
    # view objects on-demand and cache them.
    self._initialize(options_map)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.View.apply_filter">
<code class="highlight language-python">
beancount.web.views.View.apply_filter
(self, entries)

        </code>
<a class="headerlink" href="#beancount.web.views.View.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def apply_filter(self, entries):
    """Filter the list of entries.

    This is used to obtain the filtered list of entries.

    Args:
      entries: A list of directives to filter.
    Returns:
      A pair of
        1. a list of filtered entries, and
        2. an integer, the index at which the beginning of the entries for
          the period begin, one directive past the opening
          balances/initialization entries.
        3. a datetime.date instance, the date at which to evaluate the value
          of assets held at cost.
    """
    raise NotImplementedError
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.views.YearView">
<code>beancount.web.views.YearView</code>
<a class="headerlink" href="#beancount.web.views.YearView" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A view of the entries for a single year.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.YearView.__init__">
<code class="highlight language-python">
beancount.web.views.YearView.__init__
(self, entries, options_map, title, year, first_month=1)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.web.views.YearView.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a view clamped to one year.</p>
<p>Note: this is the only view where the entries are summarized and
clamped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>title</code></td>
<td><code></code></td>
<td>
<p>A string, the title of this view.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>year</code></td>
<td><code></code></td>
<td>
<p>An integer, the year of the exercise period.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>first_month</code></td>
<td><code></code></td>
<td>
<p>The calendar month (starting with 1) with which the year opens.</p>
</td>
<td><code>1</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, entries, options_map, title, year, first_month=1):
    """Create a view clamped to one year.

    Note: this is the only view where the entries are summarized and
    clamped.

    Args:
      entries: A list of directives.
      options_map: A dict of options, as produced by the parser.
      title: A string, the title of this view.
      year: An integer, the year of the exercise period.
      first_month: The calendar month (starting with 1) with which the year opens.
    """
    self.year = year
    self.first_month = first_month
    if not (1 &lt;= first_month &lt;= 12):
        raise ValueError("Invalid month: {}".format(first_month))
    View.__init__(self, entries, options_map, title)

    self.monthly = MonthNavigation.COMPACT
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.views.YearView.apply_filter">
<code class="highlight language-python">
beancount.web.views.YearView.apply_filter
(self, entries, options_map)

        </code>
<a class="headerlink" href="#beancount.web.views.YearView.apply_filter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Filter the list of entries.</p>
<p>This is used to obtain the filtered list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives to filter.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of
  1. a list of filtered entries, and
  2. an integer, the index at which the beginning of the entries for
    the period begin, one directive past the opening
    balances/initialization entries.
  3. a datetime.date instance, the date at which to evaluate the value
    of assets held at cost.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/views.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def apply_filter(self, entries, options_map):
    # Clamp to the desired period.
    begin_date = datetime.date(self.year, self.first_month, 1)
    end_date = datetime.date(self.year+1, self.first_month, 1)
    with misc_utils.log_time('clamp', logging.info):
        entries, index = summarize.clamp_opt(entries,
                                             begin_date, end_date,
                                             options_map)
    return entries, index, end_date
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.web.web">
<code>beancount.web.web</code>
<a class="headerlink" href="#beancount.web.web" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Web server for Beancount ledgers.
This uses the Bottle single-file micro web framework (with no plugins).</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.web.web.HTMLFormatter">
<code>beancount.web.web.HTMLFormatter</code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A formatter object that can be used to render accounts links.</p>
<pre><code>Attributes:
  build_url: A function used to render links to a Bottle application.
  leafonly: a boolean, if true, render only the name of the leaf nodes.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.build_global">
<code class="highlight language-python">
beancount.web.web.HTMLFormatter.build_global
    (self, *
args, **
kwds)

        </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.build_global" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render to global application.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def build_global(self, *args, **kwds):
    "Render to global application."
    return app.router.build(*args, **kwds)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_account">
<code class="highlight language-python">
beancount.web.web.HTMLFormatter.render_account
(self, account_name)

        </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_account" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_account(self, account_name):
    """See base class."""
    if self.view_links:
        if self.leaf_only:
            # Calculate the number of components to figure out the indent to
            # render at.
            components = account.split(account_name)
            indent = '{:.1f}'.format(len(components) * self.EMS_PER_COMPONENT)
            anchor = '&lt;a href="{}" class="account"&gt;{}&lt;/a&gt;'.format(
                self.build_url('journal',
                               account_name=self.account_xform.render(account_name)),
                account.leaf(account_name))
            return '&lt;span "account" style="padding-left: {}em"&gt;{}&lt;/span&gt;'.format(
                indent, anchor)
        else:
            anchor = '&lt;a href="{}" class="account"&gt;{}&lt;/a&gt;'.format(
                self.build_url('journal',
                               account_name=self.account_xform.render(account_name)),
                account_name)
            return '&lt;span "account"&gt;{}&lt;/span&gt;'.format(anchor)
    else:
        if self.leaf_only:
            # Calculate the number of components to figure out the indent to
            # render at.
            components = account.split(account_name)
            indent = '{:.1f}'.format(len(components) * self.EMS_PER_COMPONENT)
            account_name = account.leaf(account_name)
            return '&lt;span "account" style="padding-left: {}em"&gt;{}&lt;/span&gt;'.format(
                indent, account_name)
        else:
            return '&lt;span "account"&gt;{}&lt;/span&gt;'.format(account_name)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_commodity">
<code class="highlight language-python">
beancount.web.web.HTMLFormatter.render_commodity
(self, base_quote)

        </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_commodity" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_commodity(self, base_quote):
    """See base class."""
    base, quote = base_quote
    return '&lt;a href="{}"&gt;{} / {}&lt;/a&gt;'.format(
        self.build_url('prices', base=base, quote=quote), base, quote)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_context">
<code class="highlight language-python">
beancount.web.web.HTMLFormatter.render_context
(self, entry)

        </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_context" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_context(self, entry):
    """See base class."""
    # Note: rendering to global application.
    # Note(2): we could avoid rendering links to summarizing and transfer
    # entries which are not going to be found.
    return self.build_global('context', ehash=compare.hash_entry(entry))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_doc">
<code class="highlight language-python">
beancount.web.web.HTMLFormatter.render_doc
(self, filename)

        </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_doc" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_doc(self, filename):
    """See base class."""
    return '&lt;a href="{}" class="filename"&gt;{}&lt;/a&gt;'.format(
        self.build_url('doc', filename=filename.lstrip('/')),
        path.basename(filename))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_event_type">
<code class="highlight language-python">
beancount.web.web.HTMLFormatter.render_event_type
(self, event)

        </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_event_type" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_event_type(self, event):
    """See base class."""
    return '&lt;a href="{}"&gt;{}&lt;/a&gt;'.format(self.build_url('event', event=event),
                                        event)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_inventory">
<code class="highlight language-python">
beancount.web.web.HTMLFormatter.render_inventory
(self, inv)

        </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_inventory" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Override this formatter to convert the inventory to units only.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_inventory(self, inv):
    """Override this formatter to convert the inventory to units only."""
    return super().render_inventory(inv.reduce(convert.get_units))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_link">
<code class="highlight language-python">
beancount.web.web.HTMLFormatter.render_link
(self, link)

        </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_link" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_link(self, link):
    """See base class."""
    # Note: rendering to global application.
    return self.build_global('link', link=link)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.web.web.HTMLFormatter.render_source">
<code class="highlight language-python">
beancount.web.web.HTMLFormatter.render_source
(self, source)

        </code>
<a class="headerlink" href="#beancount.web.web.HTMLFormatter.render_source" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>See base class.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_source(self, source):
    """See base class."""
    return '{}#{}'.format(app.get_url('source'), source['lineno'])
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.activity">
<code class="highlight language-python">
beancount.web.web.activity
()

        </code>
<a class="headerlink" href="#beancount.web.web.activity" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the update activity.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/activity', name='activity')
def activity():
    "Render the update activity."
    return render_global(
        pagetitle="Update Activity",
        contents=render_real_report(misc_reports.ActivityReport,
                                    request.view.real_accounts,
                                    app.price_map,
                                    request.view.price_date,
                                    leaf_only=False))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.auto_reload_input_file">
<code class="highlight language-python">
beancount.web.web.auto_reload_input_file
(callback)

        </code>
<a class="headerlink" href="#beancount.web.web.auto_reload_input_file" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A plugin that automatically reloads the input file if it changed since the
last page was loaded.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def auto_reload_input_file(callback):
    """A plugin that automatically reloads the input file if it changed since the
    last page was loaded."""
    def wrapper(*posargs, **kwargs):
        filename = app.args.filename

        if loader.needs_refresh(app.options):
            logging.info('Reloading...')

            # Save the source for later, to render.
            with open(filename, encoding='utf8') as f:
                app.source = f.read()

            # Parse the beancount file.
            entries, errors, options_map = loader.load_file(filename)

            # Print out the list of errors.
            if errors:
                # pylint: disable=unsupported-assignment-operation
                request.params['render_overlay'] = True
                print(',----------------------------------------------------------------')
                printer.print_errors(errors, file=sys.stdout)
                print('`----------------------------------------------------------------')

            # Save globals in the global app.
            app.entries = entries
            app.errors = errors
            app.options = options_map
            app.account_types = options.get_account_types(options_map)

            # Pre-compute the price database.
            app.price_map = prices.build_price_map(entries)

            # Pre-compute the list of active years.
            app.active_years = list(getters.get_active_years(entries))

            # Reset the view cache.
            app.views.clear()

        else:
            # For now, the overlay is a link to the errors page. Always render
            # it on the right when there are errors.
            if app.errors:
                # pylint: disable=unsupported-assignment-operation
                request.params['render_overlay'] = True

        return callback(*posargs, **kwargs)
    return wrapper
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.balsheet">
<code class="highlight language-python">
beancount.web.web.balsheet
()

        </code>
<a class="headerlink" href="#beancount.web.web.balsheet" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Balance sheet.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/balsheet', name='balsheet')
def balsheet():
    "Balance sheet."
    return render_view(pagetitle="Balance Sheet",
                       contents=render_real_report(balance_reports.BalanceSheetReport,
                                                   request.view.closing_real_accounts,
                                                   app.price_map,
                                                   request.view.price_date,
                                                   leaf_only=True))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.commodities">
<code class="highlight language-python">
beancount.web.web.commodities
()

        </code>
<a class="headerlink" href="#beancount.web.web.commodities" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a list commodities with list their prices page.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/commodities', name='commodities')
def commodities():
    "Render a list commodities with list their prices page."
    html_table = render_report(price_reports.CommoditiesReport, request.view.entries,
                               [],
                               css_id='price-index')
    return render_view(
        pagetitle="Commodities",
        contents=html_table)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.context_">
<code class="highlight language-python">
beancount.web.web.context_
(ehash=None)

        </code>
<a class="headerlink" href="#beancount.web.web.context_" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the before &amp; after context around a transaction entry.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@app.route('/context/&lt;ehash:re:[a-fA-F0-9]*&gt;', name='context')
def context_(ehash=None):
    "Render the before &amp; after context around a transaction entry."

    matching_entries = [entry
                        for entry in app.entries
                        if ehash == compare.hash_entry(entry)]

    oss = io.StringIO()
    if len(matching_entries) == 0:
        print("ERROR: Could not find matching entry for '{}'".format(ehash),
              file=oss)

    elif len(matching_entries) &gt; 1:
        print("ERROR: Ambiguous entries for '{}'".format(ehash),
              file=oss)
        print(file=oss)
        dcontext = app.options['dcontext']
        printer.print_entries(matching_entries, dcontext, file=oss)

    else:
        entry = matching_entries[0]

        # Render the context.
        oss.write("&lt;pre&gt;\n")
        oss.write(context.render_entry_context(app.entries, app.options, entry))
        oss.write("&lt;/pre&gt;\n")

        # Render the filelinks.
        if FILELINK_PROTOCOL:
            meta = entry.meta
            uri = FILELINK_PROTOCOL.format(filename=meta.get('filename'),
                                           lineno=meta.get('lineno'))
            oss.write('&lt;div class="filelink"&gt;&lt;a href="{}"&gt;{}&lt;/a&gt;&lt;/div&gt;'.format(uri, 'Open'))

    return render_global(
        pagetitle="Context: {}".format(ehash),
        contents=oss.getvalue())
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.conversions_">
<code class="highlight language-python">
beancount.web.web.conversions_
()

        </code>
<a class="headerlink" href="#beancount.web.web.conversions_" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the list of transactions with conversions.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/conversions', name='conversions')
def conversions_():
    "Render the list of transactions with conversions."
    return render_view(
        pagetitle="Conversions",
        contents=render_report(journal_reports.ConversionsReport,
                               request.view.entries, leaf_only=False))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.doc">
<code class="highlight language-python">
beancount.web.web.doc
(filename=None)

        </code>
<a class="headerlink" href="#beancount.web.web.doc" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Serve static filenames for documents directives.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@app.route('/doc/&lt;filename:re:.*&gt;', name=doc_name)
def doc(filename=None):
    "Serve static filenames for documents directives."

    filename = '/' + filename

    # Check that there is a document directive that has this filename.
    # This is for security; we don't want to be able to serve just any file.
    for entry in misc_utils.filter_type(app.entries, data.Document):
        if entry.filename == filename:
            break
    else:
        raise bottle.HTTPError(404, "Not found")

    # Just serve the file ourselves.
    return bottle.static_file(path.basename(filename),
                              path.dirname(filename))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.documents">
<code class="highlight language-python">
beancount.web.web.documents
()

        </code>
<a class="headerlink" href="#beancount.web.web.documents" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a tree with all the documents found.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/documents', name='documents')
def documents():
    "Render a tree with all the documents found."
    return render_view(
        pagetitle="Documents",
        contents=render_report(journal_reports.DocumentsReport,
                               request.view.entries, leaf_only=False))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.errors">
<code class="highlight language-python">
beancount.web.web.errors
()

        </code>
<a class="headerlink" href="#beancount.web.web.errors" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Report error encountered during parsing, checking and realization.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@app.route('/errors', name='errors')
def errors():
    "Report error encountered during parsing, checking and realization."
    return render_global(
        pagetitle="Errors",
        contents=render_report(misc_reports.ErrorReport, [], leaf_only=False))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.event">
<code class="highlight language-python">
beancount.web.web.event
(event=None)

        </code>
<a class="headerlink" href="#beancount.web.web.event" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render all values of a particular event.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route(r'/event/&lt;event:re:([A-Za-z0-9\-_/.]+)?&gt;', name='event')
def event(event=None):
    "Render all values of a particular event."
    if not event:
        bottle.redirect(app.get_url('event_index'))
    return render_view(
        pagetitle="Event: {}".format(event),
        contents=render_report(misc_reports.EventsReport, app.entries,
                               ['--expr', event]))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.event_index">
<code class="highlight language-python">
beancount.web.web.event_index
()

        </code>
<a class="headerlink" href="#beancount.web.web.event_index" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the latest values of all events and an index.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/event', name='event_index')
def event_index():
    "Render the latest values of all events and an index."
    return render_view(
        pagetitle="Events Index",
        contents=render_report(misc_reports.CurrentEventsReport,
                               request.view.entries))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.get_all_view">
<code class="highlight language-python">
beancount.web.web.get_all_view
(app)

        </code>
<a class="headerlink" href="#beancount.web.web.get_all_view" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a view of all transactions.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of AllView, that covers all transactions.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_all_view(app):
    """Return a view of all transactions.

    Returns:
      An instance of AllView, that covers all transactions.
    """
    return views.AllView(app.entries, app.options, 'All Transactions')
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.handle_view">
<code class="highlight language-python">
beancount.web.web.handle_view
(path_depth)

        </code>
<a class="headerlink" href="#beancount.web.web.handle_view" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A decorator for handlers which create views lazily.
If you decorate a method with this, the wrapper does the redirect
handling and your method is just a factory for a View instance,
which is cached.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path_depth</code></td>
<td><code></code></td>
<td>
<p>An integer, the number of components that form the view id.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A decorator function, used to wrap view handlers.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def handle_view(path_depth):
    """A decorator for handlers which create views lazily.
    If you decorate a method with this, the wrapper does the redirect
    handling and your method is just a factory for a View instance,
    which is cached.

    Args:
      path_depth: An integer, the number of components that form the view id.
    Returns:
      A decorator function, used to wrap view handlers.
    """
    def view_populator(callback):
        def wrapper(*args, **kwargs):
            components = request.path.split('/')
            viewid = '/'.join(components[:path_depth+1])
            try:
                # Try fetching the view from the cache.
                view = app.views[viewid]
            except KeyError:
                # We need to create the view.
                view = app.views[viewid] = callback(*args, **kwargs)

            # Save the view for the subrequest and redirect. populate_view()
            # picks this up and saves it in request.view.
            request.environ['VIEW'] = view
            return bottle_utils.internal_redirect(viewapp, path_depth)
        return wrapper
    return view_populator
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_">
<code class="highlight language-python">
beancount.web.web.holdings_
()

        </code>
<a class="headerlink" href="#beancount.web.web.holdings_" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a detailed table of all holdings.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/equity/holdings', name='holdings')
def holdings_():
    "Render a detailed table of all holdings."
    html_table = render_report(holdings_reports.HoldingsReport, request.view.entries,
                               [],
                               css_class='holdings detail-table sortable', center=True)
    return render_view(
        pagetitle="Holdings",
        contents=html_table,
        scripts='&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;')
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_byaccount">
<code class="highlight language-python">
beancount.web.web.holdings_byaccount
()

        </code>
<a class="headerlink" href="#beancount.web.web.holdings_byaccount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of holdings by account.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/equity/holdings_byaccount', name='holdings_byaccount')
def holdings_byaccount():
    "Render a table of holdings by account."

    html_table = render_report(holdings_reports.HoldingsReport, request.view.entries,
                               ['--by', 'account'],
                               css_class='holdings detail-table sortable', center=True)
    return render_view(
        pagetitle="Holdings by Account",
        contents=html_table,
        scripts='&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;')
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_bycommodity">
<code class="highlight language-python">
beancount.web.web.holdings_bycommodity
()

        </code>
<a class="headerlink" href="#beancount.web.web.holdings_bycommodity" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of holdings by commodity.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/equity/holdings_bycommodity', name='holdings_bycommodity')
def holdings_bycommodity():
    "Render a table of holdings by commodity."

    html_table = render_report(holdings_reports.HoldingsReport, request.view.entries,
                               ['--by', 'commodity'],
                               css_class='holdings detail-table sortable', center=True)
    return render_view(
        pagetitle="Holdings by Commodity",
        contents=html_table,
        scripts='&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;')
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_bycurrency">
<code class="highlight language-python">
beancount.web.web.holdings_bycurrency
()

        </code>
<a class="headerlink" href="#beancount.web.web.holdings_bycurrency" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of holdings by currency.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/equity/holdings_bycurrency', name='holdings_bycurrency')
def holdings_bycurrency():
    "Render a table of holdings by currency."

    html_table = render_report(holdings_reports.HoldingsReport, request.view.entries,
                               ['--by', 'currency'],
                               css_class='holdings detail-table sortable', center=True)
    return render_view(
        pagetitle="Holdings by Currency",
        contents=html_table,
        scripts='&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;')
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.holdings_byrootaccount">
<code class="highlight language-python">
beancount.web.web.holdings_byrootaccount
()

        </code>
<a class="headerlink" href="#beancount.web.web.holdings_byrootaccount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of holdings by account.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/equity/holdings_byrootaccount', name='holdings_byrootaccount')
def holdings_byrootaccount():
    "Render a table of holdings by account."

    html_table = render_report(holdings_reports.HoldingsReport, request.view.entries,
                               ['--by', 'root-account'],
                               css_class='holdings detail-table sortable', center=True)
    return render_view(
        pagetitle="Holdings by Account",
        contents=html_table,
        scripts='&lt;script src="/third_party/sorttable.js"&gt;&lt;/script&gt;')
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.incognito">
<code class="highlight language-python">
beancount.web.web.incognito
(callback)

        </code>
<a class="headerlink" href="#beancount.web.web.incognito" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A plugin that converts all numbers rendered into X's, in order
to hide the actual values in the ledger. This is used for doing
public demos using my real ledger, where I don't necessarily
want to share the detail of my financial life with the viewers
but when I still want an interesting ledger, with enough
detail that looks realistic.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def incognito(callback):
    """A plugin that converts all numbers rendered into X's, in order
    to hide the actual values in the ledger. This is used for doing
    public demos using my real ledger, where I don't necessarily
    want to share the detail of my financial life with the viewers
    but when I still want an interesting ledger, with enough
    detail that looks realistic."""

    def wrapper(*posargs, **kwargs):
        contents = callback(*posargs, **kwargs)
        # pylint: disable=bad-continuation
        if (response.content_type in ('text/html', '') and
            isinstance(contents, str)):
            contents = text_utils.replace_numbers(contents)
        return contents

    return wrapper
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.income">
<code class="highlight language-python">
beancount.web.web.income
()

        </code>
<a class="headerlink" href="#beancount.web.web.income" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Income statement.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/income', name='income')
def income():
    "Income statement."
    return render_view(pagetitle="Income Statement",
                       contents=render_real_report(balance_reports.IncomeStatementReport,
                                                   request.view.real_accounts,
                                                   app.price_map,
                                                   request.view.price_date,
                                                   leaf_only=True))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.index">
<code class="highlight language-python">
beancount.web.web.index
()

        </code>
<a class="headerlink" href="#beancount.web.web.index" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Index of all pages, so that navigation need not have all links.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/index', name='index')
def index():
    "Index of all pages, so that navigation need not have all links."

    oss = io.StringIO()
    oss.write('&lt;ul&gt;\n')
    for title, page in [
            ("Balances", "trial"),
            ("Balance Sheet", "balsheet"),
            ("Opening Balances", "openbal"),
            ("Income Statement", "income"),
            ("General Journal", "journal_all"),
            ("Conversions", "conversions"),
            ("Documents", "documents"),
            ("Holdings (Full Detail)", "holdings"),
            ("Holdings by Account", "holdings_byaccount"),
            ("Holdings by Root Account", "holdings_byrootaccount"),
            ("Holdings by Commodity", "holdings_bycommodity"),
            ("Holdings by Currency", "holdings_bycurrency"),
            ("Net Worth", "networth"),
            ("Commodities", "commodities"),
            ("Events", "event_index"),
            ("Activity/Update", "activity"),
            ("Statistics (Types)", "stats_types"),
            ("Statistics (Postings)", "stats_postings"),
    ]:
        oss.write('&lt;li&gt;&lt;a href={}&gt;{}&lt;/a&gt;&lt;/li&gt;\n'.format(
            request.app.get_url(page), title))
    oss.write('&lt;/ul&gt;\n')

    return render_view(
        pagetitle="Index",
        contents=oss.getvalue())
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.journal_">
<code class="highlight language-python">
beancount.web.web.journal_
(account_name=None)

        </code>
<a class="headerlink" href="#beancount.web.web.journal_" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A list of all the entries for this account realization.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/journal/&lt;account_name:re:.*&gt;', name='journal')
def journal_(account_name=None):
    "A list of all the entries for this account realization."
    account_name = app.account_xform.parse(account_name)

    # Figure out which account to render this from.
    real_accounts = request.view.real_accounts
    if account_name:
        if account_name and account_types.is_balance_sheet_account(account_name,
                                                                   app.account_types):
            real_accounts = request.view.closing_real_accounts

    # Render the report.
    args = []
    if account_name:
        args.append('--account={}'.format(account_name))

    render_postings = request.params.get('postings', True)
    if isinstance(render_postings, str):
        render_postings = render_postings.lower() in ('1', 'true')
    if render_postings:
        args.append('--verbose')

    try:
        html_journal = render_real_report(journal_reports.JournalReport,
                                          real_accounts,
                                          app.price_map,
                                          request.view.price_date,
                                          args, leaf_only=False)
    except KeyError as e:
        raise bottle.HTTPError(404, '{}'.format(e))

    return render_view(pagetitle='{}'.format(account_name or
                                             'General Ledger (All Accounts)'),
                       contents=html_journal)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.journal_all">
<code class="highlight language-python">
beancount.web.web.journal_all
()

        </code>
<a class="headerlink" href="#beancount.web.web.journal_all" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A list of all the entries in this realization.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/journal/all', name='journal_all')
def journal_all():
    "A list of all the entries in this realization."
    bottle.redirect(request.app.get_url('journal', account_name=''))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.link">
<code class="highlight language-python">
beancount.web.web.link
(link=None)

        </code>
<a class="headerlink" href="#beancount.web.web.link" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Serve journals for links.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@app.route('/link/&lt;link:re:.*&gt;', name='link')
def link(link=None):
    "Serve journals for links."

    linked_entries = basicops.filter_link(link, app.entries)

    oss = io.StringIO()
    formatter = HTMLFormatter(app.options['dcontext'],
                              request.app.get_url, False, app.account_xform,
                              view_links=False)
    journal_html.html_entries_table_with_balance(oss, linked_entries, formatter)
    return render_global(
        pagetitle="Link: {}".format(link),
        contents=oss.getvalue())
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.main">
<code class="highlight language-python">
beancount.web.web.main
()

        </code>
<a class="headerlink" href="#beancount.web.web.main" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Main web service runner. This runs the event loop and blocks indefinitely.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def main():
    """Main web service runner. This runs the event loop and blocks indefinitely."""

    argparser = version.ArgumentParser(description=__doc__.strip())
    add_web_arguments(argparser)
    args = argparser.parse_args()

    run_app(args)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.month_request">
<code class="highlight language-python">
beancount.web.web.month_request
(year, month)

        </code>
<a class="headerlink" href="#beancount.web.web.month_request" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a URL to a particular month of the context's request.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def month_request(year, month):
    """Render a URL to a particular month of the context's request.
    """
    if year &lt; app.active_years[0] or year &gt; app.active_years[-1]:
        return ''
    month = list(calendar.month_abbr).index(month)
    month = "{:0&gt;2d}".format(month)
    return app.router.build('month', year=year, month=month,
            path=request.path[1:])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.networth">
<code class="highlight language-python">
beancount.web.web.networth
()

        </code>
<a class="headerlink" href="#beancount.web.web.networth" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render a table of the net worth for this filter.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/equity/networth', name='networth')
def networth():
    "Render a table of the net worth for this filter."

    html_table = render_report(holdings_reports.NetWorthReport, request.view.entries)
    return render_view(
        pagetitle="Net Worth",
        contents=html_table)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.openbal">
<code class="highlight language-python">
beancount.web.web.openbal
()

        </code>
<a class="headerlink" href="#beancount.web.web.openbal" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Opening balances.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/openbal', name='openbal')
def openbal():
    "Opening balances."
    return render_view(pagetitle="Opening Balances",
                       contents=render_real_report(balance_reports.BalanceSheetReport,
                                                   request.view.opening_real_accounts,
                                                   app.price_map,
                                                   request.view.price_date,
                                                   leaf_only=True))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.populate_view">
<code class="highlight language-python">
beancount.web.web.populate_view
(callback)

        </code>
<a class="headerlink" href="#beancount.web.web.populate_view" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A plugin that will populate the request with the current view instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>callback</code></td>
<td><code></code></td>
<td>
<p>A continuation function to call to handle the request.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A function to call to install view-specific parameters on the request.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def populate_view(callback):
    """A plugin that will populate the request with the current view instance.

    Args:
      callback: A continuation function to call to handle the request.
    Returns:
      A function to call to install view-specific parameters on the request.
    """
    def wrapper(*args, **kwargs):
        request.view = request.environ['VIEW']
        return callback(*args, **kwargs)
    return wrapper
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.prices_values">
<code class="highlight language-python">
beancount.web.web.prices_values
(base=None, quote=None)

        </code>
<a class="headerlink" href="#beancount.web.web.prices_values" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render all the values for a particular price pair.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/prices'
               r'/&lt;base:re:[A-Z][A-Z0-9\'\.\_\-]{0,22}[A-Z0-9]&gt;'
               r'/&lt;quote:re:[A-Z][A-Z0-9\'\.\_\-]{0,22}[A-Z0-9]&gt;', name='prices')
def prices_values(base=None, quote=None):
    "Render all the values for a particular price pair."
    html_table = render_report(price_reports.CommodityPricesReport, request.view.entries,
                               ['--commodity', '{}/{}'.format(base, quote)],
                               css_id='price-index')
    return render_view(
        pagetitle="Price: {} / {}".format(base, quote),
        contents=html_table)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_global">
<code class="highlight language-python">
beancount.web.web.render_global
    (*
args, **
kw)

        </code>
<a class="headerlink" href="#beancount.web.web.render_global" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the title and contents in our standard template for a global page.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*args</code></td>
<td><code></code></td>
<td>
<p>A tuple of values for the HTML template.</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>*kw</code></td>
<td><code></code></td>
<td>
<p>A dict of optional values for the HTML template.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An HTML string of the rendered template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_global(*args, **kw):
    """Render the title and contents in our standard template for a global page.

    Args:
      *args: A tuple of values for the HTML template.
      *kw: A dict of optional values for the HTML template.
    Returns:
      An HTML string of the rendered template.
    """
    response.content_type = 'text/html'
    kw['A'] = A # Application mapper
    kw['V'] = V # View mapper
    kw['title'] = app.options['title']
    kw['view_title'] = ''
    kw['navigation'] = GLOBAL_NAVIGATION
    kw['scripts'] = kw.get('scripts', '')

    kw['overlay'] = (
        render_overlay('&lt;li&gt;&lt;a href="{}"&gt;Errors&lt;/a&gt;&lt;/li&gt;'.format(
            app.router.build('errors')))
        if request.params.pop('render_overlay', True)
        else '')
    return template.render(*args, **kw)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_overlay">
<code class="highlight language-python">
beancount.web.web.render_overlay
(contents)

        </code>
<a class="headerlink" href="#beancount.web.web.render_overlay" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render an overlay of the navigation with the current errors.</p>
<p>This is used to bring up new errors on any page when they occur.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string of HTML for the contents of the errors overlay.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_overlay(contents):
    """Render an overlay of the navigation with the current errors.

    This is used to bring up new errors on any page when they occur.

    Returns:
      A string of HTML for the contents of the errors overlay.
    """
    return '''
      &lt;div class="navigation" id="nav-right"&gt;
        &lt;ul&gt;
          {}
        &lt;/ul&gt;
      &lt;/div&gt;'''.format(contents)

    # It would be nice to have a fancy overlay here, that automatically appears
    # after parsing if there are errors and that automatically smoothly fades
    # out.
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_real_report">
<code class="highlight language-python">
beancount.web.web.render_real_report
(report_class, real_root, price_map, price_date, args=None, leaf_only=False)

        </code>
<a class="headerlink" href="#beancount.web.web.render_real_report" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Instantiate a report and rendering it to a string.</p>
<p>This is intended to be called in the context of a Bottle view app request
(it uses 'request').</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>report_class</code></td>
<td><code></code></td>
<td>
<p>A class, the type of the report to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price map as built by build_price_map().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_date</code></td>
<td><code></code></td>
<td>
<p>The date at which to evaluate the prices.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>args</code></td>
<td><code></code></td>
<td>
<p>A list of strings, the arguments to initialize the report with.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>leaf_only</code></td>
<td><code></code></td>
<td>
<p>A boolean, whether to render the leaf names only.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered report.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_real_report(report_class, real_root, price_map, price_date,
                       args=None, leaf_only=False):
    # pylint: disable=too-many-arguments
    """Instantiate a report and rendering it to a string.

    This is intended to be called in the context of a Bottle view app request
    (it uses 'request').

    Args:
      report_class: A class, the type of the report to render.
      real_root: An instance of RealAccount to render.
      price_map: A price map as built by build_price_map().
      price_date: The date at which to evaluate the prices.
      args: A list of strings, the arguments to initialize the report with.
      leaf_only: A boolean, whether to render the leaf names only.
    Returns:
      A string, the rendered report.
    """
    formatter = HTMLFormatter(app.options['dcontext'],
                              request.app.get_url, leaf_only, app.account_xform)
    oss = io.StringIO()
    report_ = report_class.from_args(args, formatter=formatter)
    report_.render_real_htmldiv(real_root, price_map, price_date, app.options, oss)
    return oss.getvalue()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_report">
<code class="highlight language-python">
beancount.web.web.render_report
(report_class, entries, args=None, css_id=None, css_class=None, center=False, leaf_only=True)

        </code>
<a class="headerlink" href="#beancount.web.web.render_report" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Instantiate a report and rendering it to a string.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>report_class</code></td>
<td><code></code></td>
<td>
<p>A class, the type of the report to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount to render.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>args</code></td>
<td><code></code></td>
<td>
<p>A list of strings, the arguments to initialize the report with.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>css_id</code></td>
<td><code></code></td>
<td>
<p>An optional string, the CSS id for the div to render.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>css_class</code></td>
<td><code></code></td>
<td>
<p>An optional string, the CSS class for the div to render.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>center</code></td>
<td><code></code></td>
<td>
<p>A boolean flag, if true, wrap the results in a &lt;center&gt; tag.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>leaf_only</code></td>
<td><code></code></td>
<td>
<p>A boolean, whether to render the leaf names only.</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered report.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_report(report_class, entries, args=None,
                  css_id=None, css_class=None, center=False, leaf_only=True):
    """Instantiate a report and rendering it to a string.

    Args:
      report_class: A class, the type of the report to render.
      real_root: An instance of RealAccount to render.
      args: A list of strings, the arguments to initialize the report with.
      css_id: An optional string, the CSS id for the div to render.
      css_class: An optional string, the CSS class for the div to render.
      center: A boolean flag, if true, wrap the results in a &lt;center&gt; tag.
      leaf_only: A boolean, whether to render the leaf names only.
    Returns:
      A string, the rendered report.
    """
    formatter = HTMLFormatter(app.options['dcontext'],
                              request.app.get_url, leaf_only, app.account_xform)
    oss = io.StringIO()
    if center:
        oss.write('&lt;center&gt;\n')
    report_ = report_class.from_args(args,
                                     formatter=formatter,
                                     css_id=css_id,
                                     css_class=css_class)
    report_.render_htmldiv(entries, app.errors, app.options, oss)
    if center:
        oss.write('&lt;/center&gt;\n')
    return oss.getvalue()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.render_view">
<code class="highlight language-python">
beancount.web.web.render_view
    (*
args, **
kw)

        </code>
<a class="headerlink" href="#beancount.web.web.render_view" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the title and contents in our standard template for a view page.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*args</code></td>
<td><code></code></td>
<td>
<p>A tuple of values for the HTML template.</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>*kw</code></td>
<td><code></code></td>
<td>
<p>A dict of optional values for the HTML template.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An HTML string of the rendered template.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render_view(*args, **kw):
    """Render the title and contents in our standard template for a view page.

    Args:
      *args: A tuple of values for the HTML template.
      *kw: A dict of optional values for the HTML template.
    Returns:
      An HTML string of the rendered template.
    """
    response.content_type = 'text/html'
    kw['A'] = A # Application mapper
    kw['V'] = V # View mapper
    kw['title'] = app.options['title']
    kw['view_title'] = ' - ' + request.view.title

    overlays = []
    if request.params.pop('render_overlay', False):
        overlays.append(
            '&lt;li&gt;&lt;a href="{}"&gt;Errors&lt;/a&gt;&lt;/li&gt;'.format(app.router.build('errors')))

    # Render navigation, with monthly navigation option.
    oss = io.StringIO()
    oss.write(APP_NAVIGATION.render(A=A, V=V, view_title=request.view.title))
    if request.view.monthly is views.MonthNavigation.COMPACT:
        overlays.append(
            '&lt;li&gt;&lt;a href="{}"&gt;Monthly&lt;/a&gt;&lt;/li&gt;'.format(M.Jan))
    elif request.view.monthly is views.MonthNavigation.FULL:
        annual = app.router.build('year',
                                  path=DEFAULT_VIEW_REDIRECT,
                                  year=request.view.year)
        oss.write(APP_NAVIGATION_MONTHLY_FULL.render(M=M, Mp=Mp, Mn=Mn, V=V, annual=annual))
    kw['navigation'] = oss.getvalue()
    kw['overlay'] = render_overlay(' '.join(overlays))

    kw['scripts'] = kw.get('scripts', '')

    return template.render(*args, **kw)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.root">
<code class="highlight language-python">
beancount.web.web.root
()

        </code>
<a class="headerlink" href="#beancount.web.web.root" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Redirect the root page to the home page.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@app.route('/', name='root')
def root():
    "Redirect the root page to the home page."
    bottle.redirect(app.get_url('toc'))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.scrape_webapp">
<code class="highlight language-python">
beancount.web.web.scrape_webapp
(webargs, callback, ignore_regexp)

        </code>
<a class="headerlink" href="#beancount.web.web.scrape_webapp" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Run a web server on a Beancount file and scrape it.</p>
<p>This is the main entry point of this module.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>webargs</code></td>
<td><code></code></td>
<td>
<p>An argparse.Namespace container of the arguments provided in
web.add_web_arguments().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code></code></td>
<td>
<p>A callback function to invoke on each page to validate it.
The function is called with the response and the url as arguments.
This function should trigger an error on failure (via an exception).</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>ignore_regexp</code></td>
<td><code></code></td>
<td>
<p>A regular expression string, the urls to ignore.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of all the processed URLs and a set of all the skipped URLs.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def scrape_webapp(webargs, callback, ignore_regexp):
    """Run a web server on a Beancount file and scrape it.

    This is the main entry point of this module.

    Args:
      webargs: An argparse.Namespace container of the arguments provided in
        web.add_web_arguments().
      callback: A callback function to invoke on each page to validate it.
        The function is called with the response and the url as arguments.
        This function should trigger an error on failure (via an exception).
      ignore_regexp: A regular expression string, the urls to ignore.
    Returns:
      A set of all the processed URLs and a set of all the skipped URLs.
    """
    url_format = 'http://localhost:{}{{}}'.format(webargs.port)

    thread = thread_server_start(webargs)

    # Skips:
    # - Docs cannot be read for external files.
    #
    # - Components views... well there are just too many, makes the tests
    #   impossibly slow. Just keep the A's so some are covered.
    url_lists = scrape.scrape_urls(url_format, callback, ignore_regexp)

    thread_server_shutdown(thread)

    return url_lists
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.setup_monkey_patch_for_server_shutdown">
<code class="highlight language-python">
beancount.web.web.setup_monkey_patch_for_server_shutdown
()

        </code>
<a class="headerlink" href="#beancount.web.web.setup_monkey_patch_for_server_shutdown" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Setup globals to steal access to the server reference.
This is required to initiate shutdown, unfortunately.
(Bottle could easily remedy that.)</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def setup_monkey_patch_for_server_shutdown():
    """Setup globals to steal access to the server reference.
    This is required to initiate shutdown, unfortunately.
    (Bottle could easily remedy that.)"""

    # Save the original function.
    # pylint: disable=import-outside-toplevel
    from wsgiref.simple_server import make_server

    # Create a decorator that will save the server upon start.
    def stealing_make_server(*args, **kw):
        global server
        server = make_server(*args, **kw)
        return server

    # Patch up wsgiref itself with the decorated function.
    import wsgiref.simple_server
    wsgiref.simple_server.make_server = stealing_make_server
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.shutdown">
<code class="highlight language-python">
beancount.web.web.shutdown
()

        </code>
<a class="headerlink" href="#beancount.web.web.shutdown" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Request for the server to shutdown.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def shutdown():
    """Request for the server to shutdown."""
    server.shutdown()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.source">
<code class="highlight language-python">
beancount.web.web.source
()

        </code>
<a class="headerlink" href="#beancount.web.web.source" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the source file, allowing scrolling at a specific line.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@app.route('/source', name='source')
def source():
    "Render the source file, allowing scrolling at a specific line."

    contents = io.StringIO()
    if app.args.no_source:
        contents.write("Source hidden.")
    else:
        contents.write('&lt;div id="source"&gt;')
        for i, line in enumerate(app.source.splitlines()):
            lineno = i+1
            contents.write(
                '&lt;pre id="{lineno}"&gt;{lineno}  {line}&lt;/pre&gt;\n'.format(
                    lineno=lineno, line=line.rstrip()))
        contents.write('&lt;/div&gt;')

    return render_global(
        pagetitle="Source",
        contents=contents.getvalue()
        )
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.stats_postings">
<code class="highlight language-python">
beancount.web.web.stats_postings
()

        </code>
<a class="headerlink" href="#beancount.web.web.stats_postings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute and render statistics about the input file.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/stats_postings', name='stats_postings')
def stats_postings():
    "Compute and render statistics about the input file."
    return render_view(
        pagetitle="Postings Statistics",
        contents=render_report(misc_reports.StatsPostingsReport,
                               request.view.entries))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.stats_types">
<code class="highlight language-python">
beancount.web.web.stats_types
()

        </code>
<a class="headerlink" href="#beancount.web.web.stats_types" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute and render statistics about the input file.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/stats_types', name='stats_types')
def stats_types():
    "Compute and render statistics about the input file."
    return render_view(
        pagetitle="Directives Statistics",
        contents=render_report(misc_reports.StatsDirectivesReport,
                               request.view.entries))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.style">
<code class="highlight language-python">
beancount.web.web.style
()

        </code>
<a class="headerlink" href="#beancount.web.web.style" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Stylesheet for the entire document.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@app.route('/resources/web.css', name='style')
def style():
    "Stylesheet for the entire document."
    response.content_type = 'text/css'
    if app.args.debug:
        with open(path.join(path.dirname(__file__), 'web.css')) as f:
            global STYLE; STYLE = f.read()
    return STYLE
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.thread_server_shutdown">
<code class="highlight language-python">
beancount.web.web.thread_server_shutdown
(thread)

        </code>
<a class="headerlink" href="#beancount.web.web.thread_server_shutdown" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Shutdown the server running in the given thread.</p>
<p>Unfortunately, in the meantime this has a side-effect on all servers.
This returns after waiting that the thread has stopped.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>thread</code></td>
<td><code></code></td>
<td>
<p>A threading.Thread instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def thread_server_shutdown(thread):
    """Shutdown the server running in the given thread.

    Unfortunately, in the meantime this has a side-effect on all servers.
    This returns after waiting that the thread has stopped.

    Args:
      thread: A threading.Thread instance.
    """
    # Clean shutdown: request to stop, then join the thread.
    # Note that because we daemonize, we could forego this elegant detail.
    shutdown()
    thread.join()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.thread_server_start">
<code class="highlight language-python">
beancount.web.web.thread_server_start
    (web_args, **
kwargs)

        </code>
<a class="headerlink" href="#beancount.web.web.thread_server_start" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Start a server in a new thread.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>argparse_args</code></td>
<td><code></code></td>
<td>
<p>An argparse parsed options object, with all the options
from add_web_arguments().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new Thread instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def thread_server_start(web_args, **kwargs):
    """Start a server in a new thread.

    Args:
      argparse_args: An argparse parsed options object, with all the options
        from add_web_arguments().
    Returns:
      A new Thread instance.

    """
    thread = threading.Thread(
        target=run_app,
        args=(web_args,),
        kwargs=kwargs)
    thread.daemon = True # Automatically exit if the process comes dwn.
    thread.start()

    # Ensure the server has at least started before running the scraper.
    wait_ready()
    time.sleep(0.1)

    return thread
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.trial">
<code class="highlight language-python">
beancount.web.web.trial
()

        </code>
<a class="headerlink" href="#beancount.web.web.trial" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Trial balance / Chart of Accounts.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@viewapp.route('/trial', name='trial')
def trial():
    "Trial balance / Chart of Accounts."
    return render_view(
        pagetitle="Trial Balance",
        contents=render_real_report(balance_reports.BalancesReport,
                                    request.view.real_accounts,
                                    app.price_map,
                                    request.view.price_date,
                                    leaf_only=True))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.url_restrict_generator">
<code class="highlight language-python">
beancount.web.web.url_restrict_generator
(url_prefix)

        </code>
<a class="headerlink" href="#beancount.web.web.url_restrict_generator" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Restrict to only a single prefix.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>url_prefix</code></td>
<td><code></code></td>
<td>
<p>A string, a URL prefix to restrict to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code></code></td>
<td>
<p>The function to wrap.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A handler decorator.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def url_restrict_generator(url_prefix):
    """Restrict to only a single prefix.

    Args:
      url_prefix: A string, a URL prefix to restrict to.
      callback: The function to wrap.
    Returns:
      A handler decorator.
    """
    # A list of URLs that should always be accepted, even when restricted.
    allowed_regexps = [re.compile(regexp).match
                       for regexp in ['/resources',
                                      '/favicon.ico',
                                      '/index',
                                      '/errors',
                                      '/source',
                                      '/context',
                                      '/third_party']]

    def url_restrict_handler(callback):
        def wrapper(*args, **kwargs):
            if (any(match(request.path) for match in allowed_regexps) or
                request.path.startswith(url_prefix)):
                return callback(*args, **kwargs)
            if request.path == '/':
                bottle.redirect(url_prefix)

            # Note: we issue a "202 Accepted" status in order to satisfy bean-bake,
            # we want to distinguish between an actual 404 error and this case.
            raise bottle.HTTPError(202, "URLs restricted to '{}'".format(url_prefix))

        return wrapper
    return url_restrict_handler
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.web.web.wait_ready">
<code class="highlight language-python">
beancount.web.web.wait_ready
()

        </code>
<a class="headerlink" href="#beancount.web.web.wait_ready" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Wait until the 'server' global has been set.
This tells us the server is running.</p>
<details class="quote">
<summary>Source code in <code>beancount/web/web.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def wait_ready():
    """Wait until the 'server' global has been set.
    This tells us the server is running.
    """
    while server is None:
        time.sleep(0.05)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral" href="beancount.utils.html" title="beancount.utils"><span class="icon icon-circle-arrow-left"></span> Previous</a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<a class="fa fa-github" href="https://github.com/beancount/docs/" style="float: left; color: #fcfcfc"> GitHub</a>
<span><a href="beancount.utils.html" style="color: #fcfcfc;">« Previous</a></span>
</span>
</div>
<script>var base_url = '..';</script>
<script defer="" src="../js/theme.js"></script>
<script defer="" src="../js/extra.js"></script>
<script defer="" src="../search/main.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
</body>
</html>
